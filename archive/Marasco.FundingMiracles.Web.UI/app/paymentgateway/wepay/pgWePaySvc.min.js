"use strict";fundoloApp.factory("pgWePaySvc",["$resource","$q","$log","$window","seAuthSvc","wePayConst","appUrl",function(n,t,i,r,u,f,e){function c(n){var t="";return angular.forEach(n,function(n){switch(n){case"kyc":t=t+" [User verification]";break;case"bank_account":t=t+" [Bank account setup]"}}),t}var o={},s=n(e.api+"/api/wepay/:action",{},{authorize:{method:"POST",headers:{authorization:u.getBearerToken},params:{action:"authorize"}},verify:{method:"POST",headers:{authorization:u.getBearerToken},params:{action:"verify"}},resendConfirmation:{method:"POST",headers:{authorization:u.getBearerToken},params:{action:"resendConfirmation"}},getAccount:{method:"GET",headers:{authorization:u.getBearerToken},params:{action:"account"},isArray:!1},withdraw:{method:"POST",headers:{authorization:u.getBearerToken},params:{action:"withdraw"}}}),h;return o.authenticate=function(){var n=$.param({user_email:u.user.userName,client_id:f.client_id,redirect_uri:f.redirect_uri,scope:f.scope});r.location.href=f.authUrl+"?"+n},o.verify=function(){var n=t.defer();return s.verify({},function(t){n.resolve(t)},function(t){n.reject(t)}),n.promise},o.authorize=function(n){var i=t.defer();return angular.isUndefined(n.code)?i.reject({error:"We Pay Authorize",error_description:"Invalid or missing code from Wepay"}):(n.redirect_uri=f.redirect_uri,n.callback_uri=f.callback_uri,s.authorize(n,function(n){i.resolve(n)},function(n){i.reject(n.data)})),i.promise},o.resendConfirmation=function(){var n=t.defer();return s.resendConfirmation({},function(t){n.resolve(t)},function(t){n.reject(t)}),n.promise},o.getAccount=function(){var n=t.defer();return s.getAccount({},function(t){n.resolve(t)},function(t){n.reject(t)}),n.promise},o.withdraw=function(){var n=t.defer();return s.withdraw({},function(t){n.resolve(t)},function(t){n.reject(t)}),n.promise},o.analyzeAccount=function(n){var t={showAlert:!0};if(n.userState!=="registered")switch(n.userState){case"pending":t.alertType="danger";t.wePayStatus="Pending";t.title="Account Setup Incomplete!";t.message="In order to receive funds, you must complete the WePay Account Setup.  Click on the button below to complete this step.";break;case"deleted":t.title="Account Deleted";t.alertType="danger";t.wePayStatus="Deleted";t.message="";break;case"not registered":t.callback=o.authenticate();t.title="Connect with WePay!";t.alertType="danger";t.wePayStatus="Not Registered";t.message="Connect your WePay account with us and get withdrawals instantly!";t.authorizeButtonTitle="Connect your WePay Account";break;default:t.alertType="success";t.wePayStatus="Registered";t.title="Successful registration";t.message="You have successfully registered with WePay"}else switch(n.accountState){case"pending":t.wePayStatus="Pending";t.alertType="warning";t.title="WePay Account Pending!";t.message="Your WePay account is awaiting Activation.  Please log in to WePay to confirm your account.";break;case"action_required":t.callback=h;t.alertType="warning";t.wePayStatus="Action Required";t.title="Action Required";t.message="WePay has indicated that you'll need to complete some small steps in order for you to withdraw funds from your account. Please log into WePay and complete the following: "+c(n.actionReasons);t.authorizeButtonTitle="Complete account Setup";break;case"disabled":t.alertType="danger";t.wePayStatus="Disabled";t.title="Account Disabled";t.message="Your WePay account has been disabled and you can no longer accept payments";break;case"deleted":t.alertType="danger";t.wePayStatus="Deleted";t.title="Account Deleted";t.message="Your WePay account has been deleted.  Please contact WePay Administrator for support.";break;default:t.alertType="success";t.wePayStatus="Active";t.title="Account Active";t.message="";t.showAlert=!1}return t},h=function(){r.location.href=f.webUrl},o}]);
//# sourceMappingURL=pgWePaySvc.min.js.map
