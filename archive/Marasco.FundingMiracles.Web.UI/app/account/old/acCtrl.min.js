"use strict";fundoloApp.controller("acProfileCtrl",["$scope","$log","mdCoreDataSvc","userSvc",function(n,t,i,r){function u(t){var i=$.grep(n.stateOptions,function(n){return n.identification===t});return i[0].identification}n.isLoading=!0;n.maskingAgent="(999) 999-9999";i.getAllStates().then(function(t){n.stateOptions=t},function(n){toastr.error("Error getting states.  Please try again");t.error(n)});r.get().then(function(t){n.profile=angular.isArray(t)?t[0]:t;n.isLoading=!1},function(i){toastr.error("There was an error retrieving profile information.  Please try again");t.error(i);n.isLoading=!1});n.$watch("stateOptions",function(t){angular.isDefined(t)&&angular.isArray(t)&&(n.selectedState=n.stateOptions[0].identification)});n.$watch("profile",function(t){angular.isDefined(t)&&angular.isDefined(n.profile.address)&&(n.selectedState=u(n.profile.address.state))});n.save=function(){n.isSaving=!0;n.profileForm.$valid?(n.profile.address.state=n.selectedState,r.update(n.profile).then(function(){toastr.success("Profile saved successfully");n.isSaving=!1},function(i){toastr.error("There was an error saving this profile.  Please try again");t.error(i);n.isSaving=!1})):(n.showValidationMessages=!0,n.isSaving=!1)}}]);fundoloApp.controller("acWithdrawCtrl",["$scope","$log","$window","$location","pgWePaySvc",function(n,t,i,r,u){function e(){u.verify().then(function(t){n.account=t;f(t);n.isLoading=!1},function(t){f(t.data);n.isLoading=!1})}function f(t){var i=u.analyzeAccount(t);n.showAlert=i.showAlert;n.alertType=i.alertType;n.title=i.title;n.message=i.message;i.authorizeButtonTitle&&(n.showBlock=!0,n.buttonTitle=i.authorizeButtonTitle);n.isPending=i.wePayStatus==="Pending";n.isActive=i.wePayStatus==="Active"&&t.balances[0].balance>0}n.isLoading=!0;n.isPending=!1;n.isActive=!1;n.isReadyForWithdrawal=!1;e();n.resendWePayRegistration=function(){n.isSending=!0;u.resendConfirmation().then(function(){toastr.success("You have mail!  Please confirm your WePay account");n.isSending=!1},function(i){toastr.error("Uh Oh.  For some reason our digital elves weren't able to resend the email.  Can you try again?");t.error(i);n.isSending=!1})};n.withdraw=function(){n.isWithdrawing=!0;u.withdraw().then(function(t){toastr.success("Mo' Money! Your account is now ready for withdrawal");n.isReadyForWithdrawal=!0;n.isWithdrawing=!1;n.withdrawal=t;n.isActive=!1},function(){toastr.error("Looks like WePay withdrawals are MIA.  Please try again later.");n.isWithdrawing=!1})};n.confirmWithdrawal=function(){i.location.href=n.withdrawal.withdrawal_uri};n.gotoBasics=function(){r.path("/account/basics")}}]);fundoloApp.controller("acPasswordCtrl",["$scope","$log","seAuthSvc","userSvc",function(n,t,i,r){n.isSaving=!1;n.showValidationMessages=!1;n.password={};n.user=i.user;n.isSetPassword=angular.isUndefined(n.user.statusId)||n.user.statusId==="Pending";n.save=function(){n.isSaving=!0;n.passwordForm.$valid?n.isSetPassword?n.setPassword(function(){n.saveUserStatus("Active")}):n.changePassword():(n.showValidationMessages=!0,n.isSaving=!1)};n.saveUserStatus=function(u){r.updateStatus(u).then(function(){n.user.statusId=u;i.extendUser(n.user);toastr.success("Password saved successfully");n.isSetPassword=!1;n.isSaving=!1},function(i){t.error(i);toastr.error("There was an error saving password.  Please try again.");n.isSaving=!1})};n.setPassword=function(r){n.isSaving=!0;i.setPassword(n.password).then(function(){angular.isFunction(r)?r():(toastr.success("Password saved successfully"),n.isSaving=!1)},function(i){t.error(i);toastr.error("Oops! We could not save your password.  Please try again.");n.isSaving=!1})};n.changePassword=function(){i.changePassword(n.password).then(function(){toastr.success("Password saved successfully");n.isSaving=!1},function(i){t.error(i);toastr.error("Oops! We could not save your password."+i.error_description);n.isSaving=!1})}}]);fundoloApp.controller("acDonationsCtrl",["$scope","$log","userSvc",function(n,t,i){n.isLoading=!0;n.title="Error";n.alertType="danger";n.message="";n.showAlert=!1;i.getDonations().then(function(t){n.donations=t;n.isLoading=!1},function(i){toastr.error("There was a problem loading donations.  Please try again.");t.error(i);n.isLoading=!1})}]);fundoloApp.controller("acBasicsCtrl",["$scope","$log","userSvc","seAuthSvc","pgWePaySvc",function(n,t,i,r,u){function f(t){var i=u.analyzeAccount(t);switch(t.userState){case"pending":n.alertType="danger";n.title="You're Almost Done";n.message="You will be receiving an email from us to set up you WePay account.  Once you've set up WePay, you'll be able to receive donations.";n.wePayStatus=i.wePayStatus;break;default:n.alertType=i.alertType;n.title=i.title;n.message=i.message;n.wePayStatus=i.wePayStatus;n.authorizeButtonTitle="Authorize your WePay Account"}n.showAlert=i.showAlert;n.isPending=i.wePayStatus==="Pending"}n.isLoading=!0;n.isSaving=!1;n.user=i.user;n.isLoading=!1;n.showValidationMessages=!1;n.isVerifying=!0;n.isAuthorized=!1;n.isPending=!1;n.isSending=!1;u.verify().then(function(t){f(t);n.verification=t;n.isVerifying=!1;n.isAuthorized=!0},function(t){n.verification={email:t.data.email};switch(t.status){case 500:n.alertType="warning";n.message="Our records show that you have not authorized us on your WePay Account.  Please see below for instructions";n.verification.userState="not authorized";n.authorizeButtonTitle="Authorize your WePay Account";break;case 404:n.alertType="danger";n.message="Click 'Connect your WePay Account' below and get withdrawals instantly!";n.verification.userState="not connected";n.authorizeButtonTitle="Connect your WePay Account"}n.title="WePay Authorization";n.showAlert=!0;n.isVerifying=!1});n.saveUser=function(){n.isSaving=!0;n.accountBasicsForm.$valid?i.updateBasics(n.user).then(function(){toastr.success("Successfully saved this user.");r.extendUser(n.user);n.isSaving=!1},function(i){t.error(i);toastr.error("There was an error saving this user.  Please try again.");n.isSaving=!1}):(n.showValidationMessages=!0,n.isSaving=!1)};n.wePay=function(){u.authenticate()};n.resendWePayRegistration=function(){n.isSending=!0;u.resendConfirmation().then(function(){toastr.success("You have mail!  Please confirm your WePay account");n.isSending=!1},function(i){toastr.error("Uh Oh.  For some reason our digital elves weren't able to resend the email.  Can you try again?");t.error(i);n.isSending=!1})}}]);fundoloApp.controller("acSocialCtrl",["$scope","$log","seAuthSvc",function(n,t,i){n.isLoading=!0;n.isRemoving=!1;i.manageInfo().then(function(t){n.manageList=t;n.isLoading=!1},function(i){toastr.error("There was a problem getting your connections."+i.error_description);t.error(i);n.isLoading=!1});n.removeConnection=function(r,u){n.isRemoving=!0;i.removeLogin({loginProvider:r,providerKey:u}).then(function(){toastr.success("Successfully removed "+connection+" connection");n.isRemoving=!1},function(i){toastr.error("There was an error removing the connection: "+i.error_description);t.error(i);n.isRemovig=!1})}}]);fundoloApp.controller("acNotificationsCtrl",["$scope","$log",function(){}]);fundoloApp.controller("acStatusCtrl",["$scope","$location","seAuthSvc","pgWePaySvc",function(n,t,i,r){function u(){r.verify().then(function(t){f(t);n.isLoadingWePay=!1},function(){toastr.error("Oops!  Account information went out to lunch.  Please check again soon!");n.isLoading=!1})}function f(t){var i=r.analyzeAccount(t);n.wePayStatus=i.wePayStatus;n.message=i.message}n.isLoadingWePay=!0;n.facebookStatus="Active";n.user=i.user;n.status=angular.isUndefined(n.user.statusId)?"Pending":n.user.statusId;n.gotoChangePassword=function(){t.path("/account/password")};u();n.resendWePayRegistration=function(){n.isSending=!0;r.resendConfirmation().then(function(){toastr.success("You have mail!  Please confirm your WePay account");n.isSending=!1},function(t){toastr.error("Uh Oh.  For some reason our digital elves weren't able to resend the email.  Can you try again?");$log.error(t);n.isSending=!1})}}]);fundoloApp.controller("acCloseCtrl",["$scope","$log",function(){}]);
/*
//# sourceMappingURL=acCtrl.min.js.map
*/