function utcToLocalTimeUnFormatted(n){var t=moment.utc(n).toDate();return moment(t)}var fundoloApp,loginModal,fdControlPanelTeamsMdl,donationAddMdlCtrl,donationThankYouMdlCtrl,fdControlPanelWidgetsUpdatesMdl,fdControlpanelWidgetsNotificationsMdl,contactFundModal,supportFundModal,joinTeamModal;(function(n){function i(n){var r="01",u={},t,i;for(t in n)i=parseInt(r,2),u[n[t]]={bitMask:i,title:n[t]},r=(i<<1).toString(2);return u}function r(n,t){var f={},i,r,u;for(i in n)if(typeof n[i]=="string")if(n[i]=="*"){r="";for(u in t)r+="1";f[i]={bitMask:parseInt(r,2),title:n[i]}}else window.console&&console.log("Access Control Error: Could not parse '"+n[i]+"' as access definition for level '"+i+"'");else{r=0;for(u in n[i])t.hasOwnProperty(n[i][u])?r=r|t[n[i][u]].bitMask:window.console&&console.log("Access Control Error: Could not find role '"+n[i][u]+"' in registered roles while building access for '"+i+"'");f[i]={bitMask:r,title:n[i][u]}}return f}var t={roles:["public","user","admin"],accessLevels:{public:"*",anon:["public"],user:["user","admin"],admin:["admin"]}};n.userRoles=i(t.roles);n.accessLevels=r(t.accessLevels,n.userRoles)})(typeof exports=="undefined"?this.routingConfig={}:exports);fundoloApp=angular.module("fundoloApp",["ngResource","ui.router","ngRoute","ngCookies","ui.validate","ngSanitize","ui.bootstrap","ngGrid","ui.mask","facebook","angular.css.injector","md.mallDub.twitter","ngFileUpload","ui.sortable","angulartics.google.analytics",function(){}]).config(["$stateProvider","$urlRouterProvider","$locationProvider","$httpProvider","FacebookProvider","cssInjectorProvider","mdMallDubTwitterProvider","appUrl",function(n,t,i,r,u,f,e,o){var s=routingConfig.accessLevels,h;i.html5Mode(!0).hashPrefix("!");t.otherwise("/p/404");t.when("","");t.when("/","");n.state("home",{url:"/",abstract:!0,templateUrl:"/app/home/hmHomeContainer.min.html",controller:"hmHomeContainer",access:s.user}).state("home.index",{url:"",templateUrl:"/app/home/hmHomeCtrl.min.html",controller:"hmHomeCtrl",access:s.public}).state("home.login",{url:"login",templateUrl:"/app/security/seLoginCtrl.min.html",controller:"seLoginCtrl",access:s.anon}).state("home.register",{url:"register",templateUrl:"/app/security/seRegisterCtrl.min.html",controller:"seRegisterCtrl",access:s.anon}).state("home.resePassword",{url:"resetPassword",templateUrl:"/app/security/seResetPasswordCtrl.min.html",controller:"seResetPasswordCtrl",access:s.anon}).state("home.registerExtrenal",{url:"registerExternal?email&firstName&lastName",templateUrl:"/app/security/seRegisterExternalCtrl.min.html",controller:"seRegisterExternalCtrl",access:s.public}).state("home.authenticate",{url:"authenticate?z",templateUrl:"/app/security/seAuthenticateCtrl.min.html",controller:"seAuthenticateCtrl",access:s.anon}).state("home.connectExternal",{url:"connectExternal?email",templateUrl:"/app/security/seConnectExternalCtrl.min.html",controller:"seConnectExternalCtrl",access:s.anon}).state("home.permalink",{url:":permalink",templateUrl:"/app/fund/fdCtrl.min.html",controller:"fdCtrl",access:s.public,color:!0}).state("home.aboutus",{url:"p/aboutus",templateUrl:"/app/pages/pgAboutUsCtrl.min.html",controller:"pgAboutUsCtrl",access:s.public}).state("home.learn",{url:"p/learn",templateUrl:"/app/pages/pgLearnCtrl.min.html",controller:"pgLearnCtrl",access:s.public}).state("home.terms",{url:"p/terms",templateUrl:"/app/pages/pgTermsCtrl.min.html",controller:"pgTermsCtrl",access:s.public}).state("home.privacy",{url:"p/privacy",templateUrl:"/app/pages/pgPrivacyCtrl.min.html",controller:"pgPrivacyCtrl",access:s.public}).state("home.howitworks",{url:"p/howitworks",templateUrl:"/app/pages/pgHowItWorksCtrl.min.html",controller:"pgHowItWorksCtrl",access:s.public}).state("home.fees",{url:"p/fees",templateUrl:"/app/pages/pgFeesCtrl.min.html",controller:"pgFeesCtrl",access:s.public}).state("home.faq",{url:"p/faq",templateUrl:"/app/pages/pgFaqCtrl.min.html",controller:"pgFaqCtrl",access:s.public}).state("home.whymiracles",{url:"p/whymiracles",templateUrl:"/app/pages/pgWhyMiraclesCtrl.min.html",controller:"pgWhyMiraclesCtrl",access:s.public}).state("home.features",{url:"p/features",templateUrl:"/app/pages/pgFeaturesCtrl.min.html",controller:"pgFeaturesCtrl",access:s.public}).state("home.cancerinfo",{url:"p/cancerinfo",templateUrl:"/app/pages/pgCancerInfo.min.html",controller:"pgCancerInfoCtrl",access:s.public}).state("home.crowd-funding",{url:"p/crowd-funding",templateUrl:"/app/pages/pgCrowdFundCtrl.min.html",controller:"pgCrowdFundCtrl",access:s.public}).state("home.tips",{url:"p/tips",templateUrl:"/app/pages/pgTipsCtrl.min.html",controller:"pgTipsCtrl",access:s.public}).state("home.account",{url:"account",templateUrl:"/app/account/foAccountCtrl.min.html",controller:"foAccountCtrl",access:s.user}).state("home.account.overview",{url:"/overview",templateUrl:"/app/account/foAccountOverviewCtrl.min.html",controller:"foAccountOverviewCtrl",access:s.user}).state("home.account.profile",{url:"/profile",templateUrl:"/app/account/foAccountProfileCtrl.min.html",controller:"foAccountProfileCtrl",access:s.user}).state("home.account.withdraw",{url:"/withdraw",templateUrl:"/app/account/foAccountWithdrawCtrl.min.html",controller:"foAccountWithdrawCtrl",access:s.user}).state("home.account.password",{url:"/password",templateUrl:"/app/account/foAccountPasswordCtrl.min.html",controller:"foAccountPasswordCtrl",access:s.user}).state("home.account.donations",{url:"/donations",templateUrl:"/app/account/foAccountDonationsCtrl.min.html",controller:"foAccountDonationsCtrl",access:s.user}).state("home.account.notifications",{url:"/notifications",templateUrl:"/app/account/foAccountNotificationsCtrl.min.html",controller:"foAccountNotificationsCtrl",access:s.user}).state("home.account.status",{url:"/status",templateUrl:"/app/account/foAccountStatusCtrl.min.html",controller:"foAccountStatusCtrl",access:s.user}).state("home.wepayauthenticate",{url:"wepay/authenticate?code",templateUrl:"/app/paymentgateway/wepay/pgWePayAuthenticateCtrl.min.html",controller:"pgWePayAuthenticateCtrl",access:s.user}).state("home.search",{url:"fund/search",templateUrl:"/app/fund/search/fdSearchCtrl.min.html",controller:"fdSearchCtrl",access:s.public}).state("home.searchAdvanced",{url:"fund/search/:category/:searchText",templateUrl:"/app/fund/search/fdSearchCtrl.min.html",controller:"fdSearchCtrl",access:s.public}).state("home.controlpanel",{url:"fund/controlpanel/:fundId",templateUrl:"/app/fund/controlpanel/fdControlPanelCtrl.min.html",controller:"fdControlPanelCtrl",access:s.user,color:!0}).state("home.controlPanelList",{url:"controlpanel/fund/list",templateUrl:"/app/fund/controlpanel/fdControlPanelListCtrl.min.html",controller:"fdControlPanelListCtrl",access:s.user}).state("home.controlpanel.overview",{url:"/overview",templateUrl:"/app/fund/controlpanel/fdControlPanelOverviewCtrl.min.html",controller:"fdControlPanelOverviewCtrl",access:s.user,color:!0}).state("home.controlpanel.profile",{url:"/profile",templateUrl:"/app/fund/controlpanel/fdControlPanelProfileCtrl.min.html",controller:"fdControlPanelProfileCtrl",access:s.user,color:!0}).state("home.controlpanel.supporters",{url:"/supporters",templateUrl:"/app/fund/controlpanel/fdControlPanelSupportersCtrl.min.html",controller:"fdControlPanelSupportersCtrl",access:s.user,color:!0}).state("home.controlpanel.teams",{url:"/teams",templateUrl:"/app/fund/controlpanel/fdControlPanelTeamsCtrl.min.html",controller:"fdControlPanelTeamsCtrl",access:s.user,color:!0}).state("home.controlpanel.teammember",{url:"/teammember",templateUrl:"/app/fund/controlpanel/fdControlPanelTeamMemberCtrl.min.html",controller:"fdControlPanelTeamMemberCtrl",access:s.user,color:!0}).state("home.controlpanel.comments",{url:"/comments",templateUrl:"/app/fund/controlpanel/fdControlPanelCommentsCtrl.min.html",controller:"fdControlPanelCommentsCtrl",access:s.user,color:!0}).state("home.controlpanel.history",{url:"/history",templateUrl:"/app/fund/controlpanel/fdControlPanelHistoryCtrl.min.html",controller:"fdControlPanelHistoryCtrl",access:s.user,color:!0}).state("home.controlpanel.settings",{url:"/settings",templateUrl:"/app/fund/controlpanel/fdControlPanelSettingsCtrl.min.html",controller:"fdControlPanelSettingsCtrl",access:s.user,color:!0}).state("home.controlpanel.tools",{url:"/tools",templateUrl:"/app/fund/controlpanel/fdControlPanelToolsCtrl.min.html",controller:"fdControlPanelToolsCtrl",access:s.user,color:!0}).state("home.controlpanel.donations",{url:"/donations",templateUrl:"/app/fund/controlpanel/fdControlPanelDonationsCtrl.min.html",controller:"fdControlPanelDonationsCtrl",access:s.user,color:!0}).state("home.controlpanel.notifications",{url:"/notifications",templateUrl:"/app/fund/controlpanel/fdControlPanelNotificationsCtrl.min.html",controller:"fdControlPanelNotificationsCtrl",access:s.user,color:!0}).state("home.controlpanel.edit",{url:"/edit",templateUrl:"/app/fund/controlpanel/fdControlPanelEditCtrl.min.html",controller:"fdControlPanelEditCtrl",access:s.user,color:!0}).state("home.funddditWizard",{url:"fund/edit/wizard",templateUrl:"/app/fund/dashboard/edit/fdDashboardEditWizardCtrl.min.html",controller:"fdDashboardEditCtrl",access:s.user}).state("home.fundCreate",{url:"fund/edit",templateUrl:"/app/fund/dashboard/edit/fdDashboardEditCtrl.min.html",controller:"fdDashboardEditCtrl",access:s.user,color:!0}).state("home.fundEdit",{url:"fund/edit/:fundId",templateUrl:"/app/fund/dashboard/edit/fdDashboardEditCtrl.min.html",controller:"fdDashboardEditCtrl",access:s.user}).state("home.fundSection",{url:"fund/edit/:fundId/:section",templateUrl:"/app/fund/dashboard/edit/fdDashboardEditCtrl.min.html",controller:"fdDashboardEditCtrl",access:s.user}).state("home.fundDonate",{url:"fund/donate/:fundId?a",templateUrl:"/app/fund/donate/fdDonateCtrl.min.html",controller:"fdDonateCtrl",access:s.public,color:!0}).state("home.fundThankYou",{url:"fund/donate/thankyou/:fundId",templateUrl:"/app/fund/donate/fdDonateThankyouCtrl.min.html",controller:"fdDonateThankYouCtrl",access:s.public,color:!0}).state("home.404",{url:"p/404",templateUrl:"/app/common/hp404Ctrl.min.html",controller:"hp404Ctrl",access:s.public}).state("fundCard",{url:"/fund/card/:permalink",templateUrl:"/app/embed/emFundCardCtrl.min.html",controller:"emFundCardCtrl",access:s.public}).state("fundButton",{url:"/fund/button/:permalink",templateUrl:"/app/embed/emFundButtonCtrl.min.html",controller:"emFundButtonCtrl",access:s.public}).state("fundWidget",{url:"/fund/widget/:permalink",templateUrl:"/app/embed/emFundWidgetCtrl.min.html",controller:"emFundWidgetCtrl",access:s.public});h=["$location","$q",function(n,t){var i={};return i.response=function(n){return n},i.responseError=function(i){return i.status===401?(n.path("/login"),t.reject(i)):t.reject(i)},i}];r.interceptors.push(h);u.init("140316459192");f.setSinglePageMode(!1);e.init({apiUrl:o.api})}]).run(["$rootScope","$location","$window","seAuthSvc",function(n,t,i,r){n.$on("$stateChangeStart",function(u,f){n.error=null;r.authorize(f.access)||(r.isLoggedIn()?t.path("/"):t.path("/login"));angular.isUndefined(f.color)&&i.App.mallDub.setDomainColor("blue","light")})}]).controller("fdMainCtrl",["$scope",function(n){n.pageTitle="Free online Fund Raising made easy";n.pageDescription="FREE online fund raising San Diego, cancer fundraising, arthritis fundraising";n.pageMetaKeywords="FundingMiracles, free online fundraising, donation website, accept free donations, raise money for cancer patients, arthritis donations, raise money for arthritis, help with medical bills, personal fundraising site, free fundraising, heart transplant fundraising, miracle fundraising, cancer fundraising, arthritis fundraising";n.seo={pageTitle:"",pageDescription:""};n.og={title:"",description:"",url:"",image:"",video:"",videoWidth:"",videoHeight:"",videoType:"",card:"",type:"website"}}]).controller("fdSearchMiniCtrl",["$scope","$location","$window",function(n,t,i){n.searchText="";n.goToSearch=function(){this.searchForm.$invalid||(i.App.mallDub.manualClickSearch(),t.path("/fund/search/all/"+n.searchText),n.searchText="")}}]).directive("fundSearch",[function(){var n={};return n.restrict="E",n.transclude=!0,n.replace=!0,n.template='<li class="hidden-sm"><a class="search"><i class="fa fa-search search-btn"><\/i><\/a><div class="search-open"><div ng-form="searchForm" class="input-group"><input type="text" class="form-control" placeholder="By title or user" ng-model="searchText" required /><span class="input-group-btn"><button type="submit" class="btn-u" ng-click="goToSearch()">Go<\/button><\/span><\/div><\/li>',n.controller=function(n,t){n.searchText="";n.goToSearch=function(){this.searchForm.$invalid||t.path("/fund/search/all/"+n.searchText)}},n.scope={},n}]).controller("fundSnippetController",["$scope","$timeout",function(n){n.defaultSortOrder="id";n.myInterval=3e3}]);fundoloApp.constant("appUrl",{fundPrint:"https://print.fundingmiracles.com",shorty:"www.fundingmiracles.com",base:"https://www.fundingmiracles.com",api:"https://api.fundingmiracles.com",facebook:{signInUrl:"https://api.fundingmiracles.com/facebookauth.aspx?u="},defaultFundImage:"9406317528.png"}).constant("twitterConfiguration",{signInUrl:"https://api.fundingmiracles.com/twitterauth.aspx?f=",tweetUrl:"https://twitter.com/intent/tweet",countUrl:"http://cdn.api.twitter.com/1/urls/count.json"}).constant("wePayConst",{webUrl:"https://www.wepay.com",authUrl:"https://www.wepay.com/v2/oauth2/authorize",tokenUrl:"https://wwww.wepayapi.com/v2/oauth2/token",client_id:"135196",redirect_uri:"https://www.fundingmiracles.com/wepay/authenticate",scope:"manage_accounts,collect_payments,view_balance,view_user,send_money,refund_payments,preapprove_payments,manage_subscriptions",callback_uri:"https://www.fundingmiracles.com/wepay/ipn",endpoint:"production"});angular.module("angular.css.injector",[]).provider("cssInjector",function(){"use strict";function t(t,i){var u=angular.element(document.getElementsByTagName("head")[0]),r;i.$on("$locationChangeStart",function(){n===!0&&e()});var f=function(){if(r===undefined&&(r=u.scope())===undefined)throw"angular.css.injector error : Please initialize your app in the HTML tag and be sure your page has a HEAD tag.";},o=function(n,i){if(f(),r.injectedStylesheets===undefined)r.injectedStylesheets=[],i===!0?u.prepend(t("<link data-ng-repeat='stylesheet in injectedStylesheets' data-ng-href='{{stylesheet.href}}' rel='stylesheet' />")(r)):u.append(t("<link data-ng-repeat='stylesheet in injectedStylesheets' data-ng-href='{{stylesheet.href}}' rel='stylesheet' />")(r));else for(var e in r.injectedStylesheets)if(r.injectedStylesheets[e].href==n)return;r.injectedStylesheets.push({href:n})},s=function(n){if(f(),r.injectedStylesheets)for(var t=0;t<r.injectedStylesheets.length;t++)if(r.injectedStylesheets[t].href===n){r.injectedStylesheets.splice(t,1);return}},e=function(){f();r.injectedStylesheets!==undefined&&(r.injectedStylesheets=[])};return{add:o,remove:s,removeAll:e}}var n=!1;this.$get=["$compile","$rootScope",function(n,i){return new t(n,i)}];this.setSinglePageMode=function(t){return n=t,this}}),function(n,t){"use strict";var i={};t.module("md.mallDub.twitter",[]).value("settings",i).provider("mdMallDubTwitter",function(){function r(r,u){var f={},e=function(){if(i.accessToken===null,i.tokenSecret===null,i.apiUrl===null)throw"md.Twitter error: Please initialize the api to your twitter service";};return f.userTimeline=function(n){e();var t=r.defer();return u.userTimeline(n).then(function(n){t.resolve(n)},function(n){t.reject(n)}),t.promise},f.mentionsTimeline=function(){e();var n=r.defer();return u.mentionsTimeline().then(function(t){n.resolve(t)},function(t){n.reject(t)}),n.promise},f.reply=function(i){if(t.isDefined){var r="https://twitter.com/intent/tweet?in_reply_to="+i;n.open(r,"ReTweet this on Twitter","width=650,height=400,toolbar=0,menubar=0,location=1,status=1,scrollbars=1,resizable=1,left=0,top=0")}},f.retweet=function(i){if(t.isDefined){var r="https://twitter.com/intent/retweet?tweet_id="+i;n.open(r,"ReTweet this on Twitter","width=650,height=400,toolbar=0,menubar=0,location=1,status=1,scrollbars=1,resizable=1,left=0,top=0")}},f.favorite=function(i){if(t.isDefined){var r="https://twitter.com/intent/favorite?tweet_id="+i;n.open(r,"ReTweet this on Twitter","width=650,height=400,toolbar=0,menubar=0,location=1,status=1,scrollbars=1,resizable=1,left=0,top=0")}},f}i.accessToken=null;this.setAccessToken=function(n){i.accessToken=n};this.getAccessToken=function(){return i.accessToken};i.tokenSecret=null;this.setTokenSecret=function(n){i.tokenSecret=n};this.getTokenSecret=function(){return i.tokenSecret};i.apiUrl=null;this.setApiUrl=function(n){i.apiUrl=n};this.getApiUrl=function(){return i.apiUrl};this.$get=["$q","mdTwitterSvc",function(n,t){return new r(n,t)}];this.init=function(n){return t.isObject(n)&&t.extend(i,n),this}}).factory("mdTwitterSvc",["$resource","$q",function(n,r){var u={},f=n(i.apiUrl+"/api/twitter/:action/:id/:screenName",{id:"@id",action:"@action",screenName:"@screenName"},{userTimeline:{method:"GET",params:{action:"user_timeline"},isArray:!0},mentionsTimeline:{method:"GET",params:{action:"mentions_timeline"},isArray:!0}});return u.userTimeline=function(n){var i=r.defer();return t.isUndefined(n)?i.reject({error:"Missing screen Name",error_description:"Cannot retrieve results with missing or invalid screen name"}):f.userTimeline({screenName:n},function(n){i.resolve(n)},function(n){i.reject(n)}),i.promise},u.mentionsTimeline=function(){var n=r.defer();return f.mentionsTimeline({},function(t){n.resolve(t)},function(t){n.reject(t)}),n.promise},u}])}(window,angular);fundoloApp.factory("mdGoogleSvc",["$resource","$q","$filter","$compile","seAuthSvc","appUrl",function(n,t,i,r,u,f){"use strict";var e={},o=n(f.api+"/api/google/:app/:action/:pageId/:startDate/:endDate",{id:"@id",app:"@app",action:"@action",startDate:"@startDate",itemsPerPageendDate:"@endDate"},{query:{method:"GET",params:{app:"fundolo",action:"page"},headers:{authorization:u.getBearerToken},isArray:!0}});return e.pageView=function(n,i,r){var u=t.defer();return angular.isUndefined(n)||n.length===0?u.reject({error:"Permalink is invalid",error_description:"Invalid permalink"}):o.query({pageId:n,startDate:i,endDate:r},function(n){u.resolve(n)},function(n){u.reject(n)}),u.promise},e}]);fundoloApp.controller("pgAboutUsCtrl",["$scope","$timeout",function(n,t){n.$parent.pageTitle="About Funding Miracles - Free Online Fundraising";n.$parent.pageDescription="FREE Online Fundraising";t(function(){window.prerenderReady=!0},5e3)}]).controller("pgHowItWorksCtrl",[,function(){}]).controller("pgLearnCtrl",["$scope","mdCoreDataSvc",function(n,t){n.sendQuestion=function(){this.sendQuestionForm.$valid?t.sendQuestion({name:n.name,email:n.email,message:n.message,applicationId:"Fundolo",noteTypeId:"Question",title:"Funding Miracles Question"}).then(function(){toastr.success("Thank you! We have received your message and are eager to get back to you.");n.name="";n.email="";n.message=""},function(n){toastr.error(n.error_description)}):toastr.error("Please be sure to fill out name, valid email and your message")}}]).controller("pgHelpCtrl",["$scope",function(){}]).controller("pgFeesCtrl",["$scope",function(){}]).controller("pgTermsCtrl",["$scope",function(){}]).controller("pgHowItWorksCtrl",["$scope",function(){}]).controller("pgFeesCtrl",["$scope",function(){}]).controller("pgFeaturesCtrl",["$scope",function(){}]).controller("pgFaqCtrl",["$scope",function(){}]).controller("pgCrowdFundCtrl",["$scope",function(){}]).controller("pgFundraisingIdeas",["$scope",function(){}]).controller("pgTipsCtrl",["$scope",function(){}]).controller("pgCancerInfoCtrl",["$scope","$location",function(n,t){n.createFundraiser=function(){t.path("/controlpanel/fund/list")}}]);fundoloApp.controller("hmHomeContainer",["$scope","$log",function(n){"use strict";n.getCurrentYear=function(){return moment().format("YYYY")}}]);fundoloApp.controller("hmHomeCtrl",["$scope","$log","fdSvc",function(){"use strict"}]);fundoloApp.directive("hmHeaderDrctv",["$window","seAuthSvc","pgWePaySvc",function(n,t){"use strict";var i={};return i.transclude=!0,i.replace=!0,i.restrict="E",i.templateUrl="/app/home/hm-header-drctv.min.html",i.link=function(i){n.App.init();n.StyleSwitcher.initStyleSwitcher();n.App.mallDub.initToastr();i.hasWithdrawal=!1;i.hasConditionalWithdrawal=!1;i.user=t.user;i.userRoles=t.userRoles;i.accessLevels=t.accessLevels;i.logout=function(){t.logout().then(function(){toastr.success("You have been successfully logged out");location.reload()},function(){toastr.error("Unable to logout")})}},i}]);fundoloApp.directive("hmHeader5Drctv",[function(){"use strict";var n={};return n.transclude=!0,n.replace=!0,n.restrict="E",n.templateUrl="/app/home/hm-header5-drctv.min.html",n.controller=["$scope","seAuthSvc",function(n,t){n.user=t.user;n.userRoles=t.userRoles;n.accessLevels=t.accessLevels;n.logout=function(){t.logout().then(function(){toastr.success("You have been successfully logged out");location.reload()},function(){toastr.error("Unable to logout")})}}],n}]);fundoloApp.directive("hmSliderLayerDrctv",[function(){"use strict";var n={};return n.transclude=!0,n.restrict="E",n.templateUrl="/app/home/hm-slider-layer-drctv.min.html",n.replace=!0,n.link=function(){},n}]);fundoloApp.directive("hmSliderV2Drctv",[function(){"use strict";var n={};return n.restrict="E",n.transclude=!0,n.replace=!0,n.templateUrl="/app/home/hm-slider-v2-drctv.min.html",n.link=function(){},n.controller=["$scope","$location",function(n,t){RevolutionSlider.initRSfullWidth();n.goToEdit=function(){t.path("/controlpanel/fund/list")};n.search=function(){t.path("/fund/search")};n.learn=function(){t.path("/p/learn")};n.join=function(){t.path("/controlpanel/fund/list")}}],n}]);fundoloApp.controller("seLoginCtrl",["$scope","$location","$log","seAuthSvc",function(n,t,i,r){"use strict";n.showValidationMessages=!1;n.role=r.userRoles.user;n.userRoles=r.userRoles;n.isLoggingIn=!1;n.user={statusId:"Active",role:n.role,userName:""};n.persistent=!1;n.login=function(i,u){n.isLoggingIn=!0;r.login(i,u).then(function(){t.path("/controlpanel/fund/list")},function(){toastr.error("Error authenticating user.  Please try again.");n.isLoggingIn=!1})}}]);fundoloApp.controller("seNavigationCtrl",["$scope","$location","seAuthSvc",function(n,t,i){"use strict";n.user=i.user;n.userRoles=i.userRoles;n.accessLevels=i.accessLevels;n.logout=function(){i.logout().then(function(){toastr.success("You have been successfully logged out");location.reload()},function(){toastr.error("Unable to logout")})}}]);fundoloApp.controller("seRegisterCtrl",["$scope","$location","$log","seAuthSvc","mdCoreDataSvc",function(n,t,i,r,u){"use strict";n.showValidationMessages=!1;n.role=r.userRoles.user;n.userRoles=r.userRoles;n.isSaving=!1;n.readTerms=!0;n.isLoadingGeo=!0;n.user={statusId:"Active",role:n.role,userName:""};u.getGeoData2().then(function(t){n.user.geo=t;n.isLoadingGeo=!1},function(t){i.error(t);n.isLoadingGeo=!1});n.register=function(t){n.isSaving=!0;n.registerForm.$valid?(n.showValidationMessages=!1,n.user.userName=n.user.email,r.register(t).then(function(){n.login(t)},function(t){toastr.error(t.error_description);i.error(t);n.isSaving=!1})):(n.showValidationMessages=!0,n.isSaving=!1,toastr.error("Oops!  Looks like there are some issues"))};n.login=function(i){r.login(i).then(function(){t.path("/controlpanel/fund/list")},function(){toastr.error("Error authenticating user.  Please try again.");n.isSaving=!1})}}]);fundoloApp.controller("seConnectExternalCtrl",["$scope","$location","$stateParams","$log","seAuthSvc",function(n,t,i,r,u){"use strict";function f(){u.addExternalLogin().then(function(){t.path("/controlpanel/fund/list").hash(null)},function(t){toastr.error(t.error_description);r.error(t);n.isLoggingIn=!1})}n.showValidationMessages=!1;n.role=u.userRoles.user;n.userRoles=u.userRoles;n.isLoggingIn=!1;n.user={statusId:"Active",role:n.role,userName:i.email};n.persistent=!1;n.login=function(t,i){n.isLoggingIn=!0;u.login(t,i).then(function(){f()},function(){toastr.error("Error authenticating user.  Please try again.");n.isLoggingIn=!1})}}]);fundoloApp.controller("seResetPasswordCtrl",["$scope","$location","$log","seAuthSvc",function(n,t,i,r){"use strict";n.showValidationMessages=!1;n.isResetting=!1;n.resetPassword=function(){n.resetPasswordForm.$valid?(n.isResetting=!0,r.resetPassword({email:n.emailAddress}).then(function(){toastr.success("Found you!  We sent an email to you with what to do next");n.emailAddress="";t.path("login");n.isResetting=!1},function(t){i.error(t);toastr.error("Whoa! We tried but couldn't find you in our system.  Try it again!");n.isResetting=!1}),n.isResetting=!1):(n.showValidationMessages=!0,n.isResetting=!1,toastr.error("Oops!  Looks like some things are missing"))}}]);fundoloApp.controller("seRegisterExternalCtrl",["$scope","$location","$stateParams","$log","seAuthSvc","mdCoreDataSvc",function(n,t,i,r,u,f){"use strict";n.user={email:i.email,firstName:i.firstName,lastName:i.lastName,confirmEmail:i.email,token:i.token,statusId:"Active"};n.showValidationMessages=!1;n.role=u.userRoles.user;n.userRoles=u.userRoles;n.isSaving=!1;f.getGeoData2().then(function(t){n.user.geo=t;n.isLoadingGeo=!1},function(t){toastr.error("Unable to get Geo data.  Please see administrator");r.error(t);n.isLoadingGeo=!1});n.register=function(t){n.isSaving=!0;n.registerForm.$valid?(n.showValidationMessages=!1,n.user.userName=n.user.email,u.registerExternal(t).then(function(){n.login(n.user);n.isSaving=!1},function(t){toastr.error(t.error_description);r.error(t);n.isSaving=!1})):(n.showValidationMessages=!0,n.isSaving=!1,toastr.error("Oops!  Looks like there are some issues"))};n.login=function(i){u.login(i).then(function(){t.path("/controlpanel/fund/list").hash(null)},function(){toastr.error("Error authenticating user.  Please try again.");n.isSaving=!1})}}]);fundoloApp.controller("seAuthenticateCtrl",["$scope","$location","$stateParams","$window","seAuthSvc",function(n,t,i,r,u){"use strict";n.popup=!1;n.isAuthenticating=!0;n.role=u.userRoles.user;n.user={statusId:"Active",role:n.role,userName:""};t.$$hash.length>0?u.handleAccessTokenRedirect("Facebook",t.$$hash).then(function(r){n.popup=angular.isDefined(i.z)&&i.z==="1";n.popup&&(window.opener.$davidScope.says=r,window.opener.$davidScope.connect=!1,window.opener.$davidScope.register=!1);u.getUserInfo().then(function(i){i.hasRegisteredExternal?n.popup?(window.opener.$davidScope.user=i,window.value=!0):(u.setUserExternal(i,r,"Facebook"),t.path("/controlpanel/fund/list").hash(null)):i.hasRegistered?n.popup?(window.opener.$davidScope.user=i,window.opener.$davidScope.connect=!0,window.value=!0):t.path("/connectExternal").search({email:i.email}).hash(null):n.popup?(window.opener.$davidScope.user=i,window.opener.$davidScope.register=!0,window.value=!0):t.path("/registerExternal").search({email:i.email,firstName:i.firstName,lastName:i.lastName,token:r.access_token}).hash(null)},function(){})},function(t){toastr.error("Provider response: "+t.error);n.error=t.error;n.isAuthenticating=!1}):t.path("/register");n.goToRegistration=function(){t.path("/register")};n.goToLogin=function(){t.path("/login")}}]);fundoloApp.directive("seExternalLoginsDrctv",["$stateParams","appUrl","seAuthSvc",function(n,t,i){"use strict";var r={};return r.restrict="E",r.replace=!0,r.transclude=!0,r.templateUrl="/app/security/se-external-logins-drctv.min.html",r.link=function(){},r.controller=["$scope","$log","$location",function(n,r){n.isLoading=!0;n.isAuthenticating=!1;n.returnUrl=t.base+"/authenticate";i.externalLogins(n.returnUrl,!0).then(function(t){angular.forEach(t,function(n){n.title=n.name;n.icon=n.name;n.sortOrder=1e3;switch(n.name){case"Facebook":n.sortOrder=1;break;case"Google":n.name="GooglePlus";n.icon="Google-Plus";break;case"Microsoft":n.icon="Windows"}});n.externalLogins=t;n.isLoading=!1},function(t){r.error(t);toastr.error(t.error_description);n.isLoading=!1});n.externalLogin=function(i,r){n.isAuthenticating=!0;window.location=t.api+r}}],r.scope={title:"@"},r}]);fundoloApp.directive("seLoginPopupDrctv",["seAuthSvc",function(n){"use strict";var t={};return t.restrict="E",t.replace=!0,t.transclude=!0,t.templateUrl="/app/security/se-login-popup-drctv.min.html",t.link=function(){},t.controller=["$scope","$location","$uibModal","fdSvc",function(t,i,r){function u(i){n.setUser(t.user,i,!0)}t.user=n.user;t.login=function(){var n=r.open({templateUrl:"/app/security/se-login-popup-mdl.min.html",controller:loginModal,size:"sm-med",resolve:{}});n.result.then(function(n){t.user.token=n;u(n);t.loginCallback()},function(n){switch(n){case"resetPassword":t.registerCallback();i.path("/resetPassword");break;case"register":t.registerCallback();i.path("/register")}})}}],t.scope={linkTitle:"@",registerCallback:"&",loginCallback:"&"},t}]);loginModal=["$scope","$uibModalInstance","$location","$window","$interval","Facebook","appUrl","seAuthSvc","mdCoreDataSvc",function(n,t,i,r,u,f,e,o,s){function h(n,t){o.addExternalLogin(t).then(function(){n(t)},function(n){toastr.error(n.error_description)})}n.viewModal=1;n.isExternalRegister=!1;n.isLoggingIn=!1;n.isFacebookLoggingIn=!1;n.facebookLoading=!0;n.returnUrl=e.base+"/authenticate?z=1";n.facebookUrl="NA";r.$davidScope={};n.token={};n.showValidationMessages=!1;n.isExternalLogin=!1;n.showConnectMessage=!1;n.user={statusId:"Active",role:o.userRoles.user,userName:"",confirmEmail:"",token:{},isAuthenticated:!1},function(){o.singleExternalLogin("Facebook",n.returnUrl,!0).then(function(t){n.facebookUrl=encodeURIComponent(t[0].url+"&display=popup");n.facebookLoading=!1},function(){toastr.error("Unable to get Facebook login url.  Please refresh and try again")});s.getGeoData2().then(function(t){n.user.geo=t;n.isLoadingGeo=!1},function(t){toastr.error("Unable to get Geo data.  Please see administrator");$log.error(t);n.isLoadingGeo=!1})}();n.login=function(i,r){n.isLoggingIn=!0;this.popupLoginForm.$valid?o.login(i,r).then(function(i){var r={access_token:i.access_token,expires_in:i.expires_in,state:i.state,token_type:i.token_type};n.isExternalLogin?h(n.close,r):t.close(r)},function(){toastr.error("Error authenticating user.  Please try again.");n.isLoggingIn=!1}):(n.showValidationMessages=!0,n.isLoggingIn=!1)};n.loginExternal=function(t){o.login(t).then(function(t){n.close({access_token:t.access_token,expires_in:t.expires_in,state:t.state,token_type:t.token_type})},function(){toastr.error("Error authenticating user.  Please try again.")})};n.registerExternal=function(){n.showValidationMessages=!1;n.user.userName=n.user.email;o.registerExternal(n.user).then(function(){n.loginExternal(n.user);n.isExternalRegister=!1},function(t){toastr.error(t.error_description);n.isExternalRegister=!1})};n.facebookLogin=function(){n.isFacebookLoggingIn=!0;var s=screen.width/2-200,h=screen.height/2-250,i=r.open(e.facebook.signInUrl+n.facebookUrl,"","top="+h+",left="+s+",width=650,height=400,toolbar=0,menubar=0,location=1,status=1,scrollbars=1,resizable=1,left=0,top=0"),f=1e3,c=u(function(){f+=250;try{i.value&&(angular.extend(n.user,$davidScope.user),$davidScope.connect?(n.isExternalLogin=!0,n.showConnectMessage=!0):$davidScope.register?(n.viewModal=3,n.showValidationMessages=!1,n.user.confirmEmail=n.user.email,n.user.token=$davidScope.says.access_token,n.user.password="fundingmiracles",n.user.disableWePay=!0,o.setUserExternalToken({access_token:$davidScope.says.access_token,expires_in:$davidScope.says.expires_in,state:$davidScope.says.state,token_type:$davidScope.says.token_type}),n.registerExternal()):(n.token={access_token:$davidScope.says.access_token,expires_in:$davidScope.says.expires_in,state:$davidScope.says.state,token_type:$davidScope.says.token_type},t.close(n.token)),u.cancel(c),i.close())}catch(r){console.error(r)}},f);n.isFacebookLoggingIn=!1};n.close=function(n){t.close(n)};n.dismiss=function(n){t.dismiss(n)}}];fundoloApp.directive("seLoginPopupFacebookDrctv",[function(){"use strict";var n={};return n.restrict="A",n.replace=!1,n.transclude=!1,n.link=function(n,t){t.bind("click",function(){n.bindFacebookClick()})},n.controller=["$scope","$window","$interval","cssInjector","appUrl","fdSvc","seAuthSvc",function(n,t,i,r,u,f,e){function o(t){e.singleExternalLogin("Facebook",n.returnUrl,!0).then(function(i){n.facebookUrl=encodeURIComponent(i[0].url+"&display=popup");n.facebookLoading=!1;t()},function(){toastr.error("Unable to get Facebook login url.  Please refresh and try again")})}function s(){e.facebookLogin(n.user,n.facebookUrl).then(function(){n.facebookCallback()},function(){toastr.error("This is embarassing.  Please refresh and try again");n.isSupporting=!1})}t.$davidScope={};n.user=e.user;n.returnUrl=u.base+"/authenticate?z=1";n.user={statusId:"Active",role:e.userRoles.user,userName:"",confirmEmail:"",token:{},isAuthenticated:!1};n.bindFacebookClick=function(){o(s)}}],n.scope={facebookCallback:"&"},n}]);fundoloApp.factory("fdSvc",["$resource","$q","$filter","$compile","appUrl",function(n,t,i,r,u){"use strict";var f={},e=n(u.api+"/api/funddetails/:action/:id",{id:"@id",action:"@action"},{featured:{method:"GET",params:{action:"featured"},isArray:!0},completed:{method:"GET",params:{action:"completed"},isArray:!0},byPermalink:{method:"GET",params:{action:"permalink"},isArray:!0},basic:{method:"GET",params:{action:"basic"},isArray:!0},share:{method:"POST",params:{action:"share"},isArray:!0}}),h=n(u.api+"/api/fund/search/:category/:pageNumber/:itemsPerPage/:searchText/:sortCriteria",{category:"@category",searchText:"@searchText",pageNumber:"@pageNumber",itemsPerPage:"@itemsPerPage",sortCriteria:"@sortCriteria"}),c=n(u.api+"/api/fund/:fundId/notes/:section/:id/:action/:pageNumber/:itemsPerPage",{fundId:"@fundId",section:"@section",id:"@id",action:"@action",pageNumber:"@pageNumber",itemsPerPage:"@itemsPerPage"},{save:{method:"POST"}}),l=n(u.api+"/api/fund/:fundId/teams/:section/:id/:action/:pageNumber/:itemsPerPage",{fundId:"@fundId",section:"@section",id:"@id",action:"@action",pageNumber:"@pageNumber",itemsPerPage:"@itemsPerPage"},{byFundId:{method:"GET",isArray:!0}}),o=n(u.api+"/api/fund/:fundId/comments/:section/:id/:action/:pageNumber/:itemsPerPage",{fundId:"@fundId",id:"@id",action:"@action",pageNumber:"@pageNumber",itemsPerPage:"@itemsPerPage",section:"@section"},{byFundId:{method:"GET",isArray:!1},like:{method:"POST",params:{action:"like"}}}),a=n(u.api+"/api/fund/:fundId/donations/:section/:id/:action/:pageNumber/:itemsPerPage",{fundId:"@fundId",section:"@section",id:"@id",pageNumber:"@pageNumber",itemsPerPage:"@itemsPerPage",action:"@action"},{query:{method:"GET",isArray:!1}}),s;return f.search=function(n,i,r,u,f){var e=t.defer();return angular.isUndefined(n)||angular.isUndefined(i)?e.reject({error:"Missing search variables",error_description:"Oops! Looks like we can't find your search criteria.  Lets try again"}):h.get({category:n,searchText:i,pageNumber:r,itemsPerPage:u,sortCriteria:f},function(n){e.resolve(n)},function(n){e.reject(n)}),e.promise},f.copy=function(i,r){var e=n(u.api+"/api/funddetails/:action/:id",{id:"@id",action:"@action"},{copy:{method:"POST",params:{action:"copy"},headers:{authorization:r}}}),f=t.defer();return e.copy({id:i},function(n){f.resolve(n)},function(n){f.reject(n)}),f.promise},f.copy2=function(i,r){var e=n(u.api+"/api/funddetails/:action/:id",{id:"@id",action:"@action"},{copy2:{method:"POST",params:{action:"copy2"},headers:{authorization:r}}}),f=t.defer();return e.copy2({id:i},function(n){f.resolve(n)},function(n){f.reject(n)}),f.promise},f.featured=function(n){var i=t.defer();return angular.isNumber(n)?e.featured({numberToTake:n},function(n){i.resolve(n)},function(n){i.reject(n)}):i.reject({error_description:"Invalid number for featured query"}),i.promise},f.completed=function(n){var i=t.defer();return angular.isNumber(n)?e.completed({numberToTake:n},function(n){i.resolve(n)},function(n){i.reject(n)}):i.reject({error_description:"Invalid number for completed query"}),i.promise},f.basic=function(n){var i=t.defer();return angular.isUndefined(n)?i.reject({error:"Fund Id",error_description:"Invalid fund Id"}):e.basic({id:n},function(n){i.resolve(n)},function(n){i.reject(n)}),i.promise},f.byPermalink=function(n){var i=t.defer();return angular.isUndefined(n)||n.length===0?i.resolve(s):e.byPermalink({id:n},function(n){i.resolve(n)},function(n){i.reject(n)}),i.promise},f.share=function(n){var i=t.defer();return angular.isUndefined(n)?i.resolve({error:"Missing or invalid share model",error_description:"The model for sharing is invalid."}):e.share(n,function(n){i.resolve(n)},function(n){i.reject(n)}),i.promise},f.support=function(i,r){var e=n(u.api+"/api/funddetails/:action/:id",{id:"@id",action:"@action"},{support:{method:"POST",params:{action:"support"},headers:{authorization:r}}}),f=t.defer();return e.support(i,function(n){f.resolve(n)},function(n){f.reject(n)}),f.promise},f.supportByUser=function(i,r){var e=n(u.api+"/api/funddetails/:action/:id",{id:"@id",action:"@action"},{support:{method:"GET",params:{action:"support"},headers:{authorization:r}}}),f=t.defer();return e.support({id:i},function(n){f.resolve(n)},function(n){f.reject(n)}),f.promise},f.supportsByUser=function(i,r){var e=n(u.api+"/api/funddetails/:action/:id",{id:"@id",action:"@action"},{supports:{method:"GET",params:{action:"supports"},headers:{authorization:r},isArray:!0}}),f=t.defer();return e.supports({id:i},function(n){f.resolve(n)},function(n){f.reject(n)}),f.promise},f.getTotalDonation=function(n,t){var r,i;if(angular.isUndefined(n)||n===null)return 0;if(angular.isArray(n)){for(r=0,i=0;i<n.length;i++)r+=t?n[i].beneficiaryAmount:n[i].amount;return r.toFixed(2)}return 0},f.getTotalDonationDateFrom=function(n,t,i){var u,f,r;if(angular.isUndefined(n)||n===null)return 0;if(angular.isArray(n)){for(u=0,f=moment().subtract(t,"days").format(),r=0;r<n.length;r++)moment(n[r].dateEntered).isAfter(f)&&(u+=i?n[r].beneficiaryAmount:n[r].amount);return u.toFixed(2)}return 0},f.getTotalDonationMonthToMonth=function(n,t,i){var r,s,h;if(angular.isUndefined(n)||n===null)return 0;if(angular.isArray(n)){var e=0,f=0,u=0,o=moment().subtract(30,"days").format(),c=moment().subtract(60,"days").format();for(r=0;r<n.length;r++)moment(n[r].dateEntered).isAfter(o)&&(e+=t?n[r].beneficiaryAmount:n[r].amount),moment(n[r].dateEntered).isBetween(c,o)&&(f+=t?n[r].beneficiaryAmount:n[r].amount),u+=t?n[r].beneficiaryAmount:n[r].amount;return u=u===0?i:u,s=f===0?u:f,h=(e-f)/s*100,h}return 0},f.isMyFund=function(i,r){var f=t.defer(),e;return angular.isUndefined(i)?f.resolve("false"):(e=n(u.api+"/api/funddetails/:action/:id",{id:"@id",action:"@action"},{isMyFund:{method:"GET",params:{action:"myfund"},headers:{authorization:r}}}),e.isMyFund({id:i},function(){f.resolve("true")},function(){f.reject("false")})),f.promise},f.getProgressPercentageWidth=function(n){if(angular.isUndefined(n.goalAmount)||!angular.isNumber(n.goalAmount))return 0;var t=this.getProgressPercentage(n);return{width:i("number")(t,0)+"%"}},f.getProgressPercentage=function(n,t){if(angular.isUndefined(n))return 0;return this.getTotalDonation(n.donationList,t)/n.goalAmount*100},f.checkExpiration=function(n){var t=moment(n),i=moment();return i.diff(t)>0},f.saveFundNote=function(n){var i=t.defer();return angular.isUndefined(n)?i.reject({error:"Invalid note",error_description:"The object [fundNote] is invalid or missing"}):(angular.isUndefined(n.identification)||n.identification<0)&&f.createFundNote(n).then(function(n){i.resolve(n)},function(n){i.reject(n)}),i.promise},f.createFundNote=function(n){var i=t.defer();return c.save({fundId:n.fundNote.fundId},n,function(n){i.resolve(n)},function(n){i.reject(n)}),i.promise},f.fundTeams=function(n){var i=t.defer();return angular.isUndefined(n)&&i.reject({error_description:"Invalid fund id",error:"Fund Id missing or invalid"}),l.byFundId({fundId:n},function(n){i.resolve(n)},function(n){i.reject(n)}),i.promise},f.fundTeamJoin=function(i,r,f){var o=n(u.api+"/api/fund/:fundId/teams/:id/:action",{id:"@id",action:"@action",fundId:"@fundId"},{join:{method:"POST",params:{action:"join"},headers:{authorization:f}}}),e=t.defer();return o.join({fundId:i,id:r},function(n){e.resolve(n)},function(n){e.reject(n)}),e.promise},f.comment=function(n,i,r){var u=t.defer();return angular.isUndefined(n)?u.reject({error:"Missing variables",error_description:"Oops! Looks like we can't find fund comments.  Lets try again"}):o.byFundId({fundId:n,pageNumber:i,itemsPerPage:r},function(n){u.resolve(n)},function(n){u.reject(n)}),u.promise},f.commentLike=function(n,i){var r=t.defer();return o.like({fundId:n},i,function(n){r.resolve(n)},function(n){r.reject(n)}),r.promise},f.commentSave=function(i,r,f){var o=n(u.api+"/api/fund/:fundId/comments",{fundId:"@fundId"},{save:{method:"POST",headers:{authorization:f}}}),e=t.defer();return o.save({fundId:i},r,function(n){e.resolve(n)},function(n){e.reject(n)}),e.promise},f.donations=function(n,i,r){var u=t.defer();return angular.isUndefined(n)?u.reject({error:"Missing variables",error_description:"Oops! Looks like we can't find fund donations.  Lets try again"}):a.query({fundId:n,pageNumber:i,itemsPerPage:r},function(n){u.resolve(n)},function(n){u.reject(n)}),u.promise},f.getMainImage=function(n,t,i){var f=0,r="/azure/img/"+u.defaultFundImage+"?height="+i+"&width="+t+"&mode=crop&scale=both";return t=t||262,i=i||197,n.length>0&&(r=n[0].upload.locationHttp+"?height="+i+"&width="+t+"&mode=crop&scale=both",angular.forEach(n,function(n){if(n.isDefault||f===0)switch(n.upload.typeId){case"web.Video.Vimeo":case"web.Video.YouTube":r=n.upload.name;break;default:r=n.upload.locationHttp+"?height="+i+"&width="+t+"&mode=crop&scale=both"}f++})),r},s={goalAmount:0,pageColor:"default",item:{typeId:"FundoloFund",transactionTypeId:"Donation",title:"Customize your Campaign",shortSummary:"",description:"",endDate:"",userId:"",itemUploadList:[]},fundUserList:[{userId:"",userTypeId:"Originator"}]},f}]);fundoloApp.factory("pgWePaySvc",["$resource","$q","$log","$window","seAuthSvc","wePayConst","appUrl",function(n,t,i,r,u,f,e){function c(n){var t="";return angular.forEach(n,function(n){switch(n){case"kyc":t=t+" [User verification]";break;case"bank_account":t=t+" [Bank account setup]"}}),t}var o={},s=n(e.api+"/api/wepay/:action",{},{authorize:{method:"POST",headers:{authorization:u.getBearerToken},params:{action:"authorize"}},verify:{method:"POST",headers:{authorization:u.getBearerToken},params:{action:"verify"}},resendConfirmation:{method:"POST",headers:{authorization:u.getBearerToken},params:{action:"resendConfirmation"}},getAccount:{method:"GET",headers:{authorization:u.getBearerToken},params:{action:"account"},isArray:!1},withdraw:{method:"POST",headers:{authorization:u.getBearerToken},params:{action:"withdraw"}}}),h;return o.authenticate=function(){var n=$.param({user_email:u.user.userName,client_id:f.client_id,redirect_uri:f.redirect_uri,scope:f.scope});r.location.href=f.authUrl+"?"+n},o.verify=function(){var n=t.defer();return s.verify({},function(t){n.resolve(t)},function(t){n.reject(t)}),n.promise},o.authorize=function(n){var i=t.defer();return angular.isUndefined(n.code)?i.reject({error:"We Pay Authorize",error_description:"Invalid or missing code from Wepay"}):(n.redirect_uri=f.redirect_uri,n.callback_uri=f.callback_uri,s.authorize(n,function(n){i.resolve(n)},function(n){i.reject(n.data)})),i.promise},o.resendConfirmation=function(){var n=t.defer();return s.resendConfirmation({},function(t){n.resolve(t)},function(t){n.reject(t)}),n.promise},o.getAccount=function(){var n=t.defer();return s.getAccount({},function(t){n.resolve(t)},function(t){n.reject(t)}),n.promise},o.withdraw=function(){var n=t.defer();return s.withdraw({},function(t){n.resolve(t)},function(t){n.reject(t)}),n.promise},o.analyzeAccount=function(n){var t={showAlert:!0};if(n.userState!=="registered")switch(n.userState){case"pending":t.alertType="danger";t.wePayStatus="Pending";t.title="Account Setup Incomplete!";t.message="In order to receive funds, you must complete the WePay Account Setup.  Click on the button below to complete this step.";break;case"deleted":t.title="Account Deleted";t.alertType="danger";t.wePayStatus="Deleted";t.message="";break;case"not registered":t.callback=o.authenticate();t.title="Connect with WePay!";t.alertType="danger";t.wePayStatus="Not Registered";t.message="Connect your WePay account with us and get withdrawals instantly!";t.authorizeButtonTitle="Connect your WePay Account";break;default:t.alertType="success";t.wePayStatus="Registered";t.title="Successful registration";t.message="You have successfully registered with WePay"}else switch(n.accountState){case"pending":t.wePayStatus="Pending";t.alertType="warning";t.title="WePay Account Pending!";t.message="Your WePay account is awaiting Activation.  Please log in to WePay to confirm your account.";break;case"action_required":t.callback=h;t.alertType="warning";t.wePayStatus="Action Required";t.title="Action Required";t.message="WePay has indicated that you'll need to complete some small steps in order for you to withdraw funds from your account. Please log into WePay and complete the following: "+c(n.actionReasons);t.authorizeButtonTitle="Complete account Setup";break;case"disabled":t.alertType="danger";t.wePayStatus="Disabled";t.title="Account Disabled";t.message="Your WePay account has been disabled and you can no longer accept payments";break;case"deleted":t.alertType="danger";t.wePayStatus="Deleted";t.title="Account Deleted";t.message="Your WePay account has been deleted.  Please contact WePay Administrator for support.";break;default:t.alertType="success";t.wePayStatus="Active";t.title="Account Active";t.message="";t.showAlert=!1}return t},h=function(){r.location.href=f.webUrl},o}]);fundoloApp.controller("pgWePayAuthenticateCtrl",["$scope","$stateParams","$log","$location","pgWePaySvc",function(n,t,i,r,u){n.title="Connecting and Authorizing WePay...";n.subTitle="Please wait a moment as we connect with WePay";n.requestToken={code:t.code};n.authorize=function(){angular.isUndefined(n.requestToken.code)?(n.title="WePay Authorization",n.subTitle="Allow WePay to connect with Us!",n.error="missing Wepay code.  This usually indicates that you are already registered with WePay.  Please contact us @ support@fundingmiracles.com",n.isAuthorizing=!1,toastr.error("The request has responded with "+response.error_description+".  Please try again")):(n.isAuthorizing=!0,u.authorize(n.requestToken).then(function(){r.path("/account/overview");n.isAuthorizing=!1},function(t){n.title="WePay Authorization";n.subTitle="Allow WePay to connect with Us!";n.error=t.error_description;n.isAuthorizing=!1;toastr.error("The request has responded with "+t.error_description+".  Please try again");i.error(t)}))};n.authorize()}]);fundoloApp.directive("acDashboardWidgetsHeaderDrctv",function(){"use strict";var n={};return n.restrict="E",n.replace=!0,n.templateUrl="/app/account/widgets/ac-dashboard-widgets-header-drctv.min.html",n.transclude=!0,n.controller=["$scope",function(n){n.moreTab=function(n){var t=!1;switch(n){case"Social":case"Notifications":case"Status":case"Close":t=!0}return t}}],n.scope={headline:"@",activeTab:"@"},n});fundoloApp.directive("acDashboardWidgetsManageDrctv",[function(){"use strict";var n={};return n.restrict="E",n.replace=!0,n.templateUrl="/app/account/widgets/ac-dashboard-widgets-manage-drctv.min.html",n.transclude=!0,n.scope={},n}]);fundoloApp.controller("foAccountCtrl",["$scope","$stateParams","$location","$filter","$log","cssInjector",function(n,t,i,r,u,f){"use strict";f.add("/assets/css/pages/profile.css",!0);n.pageResolve="overview";n.mainImage="";n.text=""}]);fundoloApp.controller("foAccountOverviewCtrl",["$scope","$log","userSvc","pgWePaySvc","seAuthSvc",function(n,t,i,r,u){"use strict";function f(t){var i=r.analyzeAccount(t);switch(t.userState){case"pending":n.alertType="danger";n.title="You're Almost Done";n.message="You will be receiving an email from us to set up you WePay account.  Once you've set up WePay, you'll be able to receive donations.";n.wePayStatus=i.wePayStatus;break;default:n.alertType=i.alertType;n.title=i.title;n.message=i.message;n.wePayStatus=i.wePayStatus;n.authorizeButtonTitle="Authorize your WePay Account"}n.showAlert=i.showAlert;n.isPending=i.wePayStatus==="Pending"}n.$parent.pageResolve="overview";n.isLoading=!0;n.isSaving=!1;n.user=i.user;n.isLoading=!1;n.showValidationMessages=!1;n.isVerifying=!0;n.isAuthorized=!1;n.isPending=!1;n.isSending=!1;n.showAlert=!1;r.verify().then(function(t){f(t);n.verification=t;n.isVerifying=!1;n.isAuthorized=!0},function(t){n.verification={email:t.data.email};switch(t.status){case 500:n.alertType="warning";n.message="Our records show that you have not authorized us on your WePay Account.  Please see below for instructions";n.verification.userState="not authorized";n.authorizeButtonTitle="Authorize your WePay Account";break;case 404:n.alertType="danger";n.message="Click 'Connect your WePay Account' below and get withdrawals instantly!";n.verification.userState="not connected";n.authorizeButtonTitle="Connect your WePay Account"}n.title="WePay Authorization";n.showAlert=!0;n.isVerifying=!1});n.saveUser=function(){n.isSaving=!0;n.accountBasicsForm.$valid?i.updateBasics(n.user).then(function(){toastr.success("Successfully saved this user.");u.extendUser(n.user);n.isSaving=!1},function(i){t.error(i);toastr.error("There was an error saving this user.  Please try again.");n.isSaving=!1}):(n.showValidationMessages=!0,n.isSaving=!1)};n.wePay=function(){r.authenticate()};n.resendWePayRegistration=function(){n.isSending=!0;r.resendConfirmation().then(function(){toastr.success("You have mail!  Please confirm your WePay account");n.isSending=!1},function(i){toastr.error("Uh Oh.  For some reason our digital elves weren't able to resend the email.  Can you try again?");t.error(i);n.isSending=!1})}}]);fundoloApp.controller("foAccountProfileCtrl",["$scope","$log","mdCoreDataSvc","userSvc",function(n,t,i,r){"use strict";function u(t){var i=$.grep(n.stateOptions,function(n){return n.identification===t});return i[0].identification}n.$parent.pageResolve="profile";n.isLoading=!0;n.maskingAgent="(999) 999-9999";i.getAllStates().then(function(t){n.stateOptions=t},function(n){toastr.error("Error getting states.  Please try again");t.error(n)});r.get().then(function(t){n.profile=angular.isArray(t)?t[0]:t;n.isLoading=!1},function(i){toastr.error("There was an error retrieving profile information.  Please try again");t.error(i);n.isLoading=!1});n.$watch("stateOptions",function(t){angular.isDefined(t)&&angular.isArray(t)&&(n.selectedState=n.stateOptions[0].identification)});n.$watch("profile",function(t){angular.isDefined(t)&&angular.isDefined(n.profile.address)&&(n.selectedState=u(n.profile.address.state))});n.save=function(){n.isSaving=!0;n.profileForm.$valid?(n.profile.address.state=n.selectedState,r.update(n.profile).then(function(){toastr.success("Profile saved successfully");n.isSaving=!1},function(i){toastr.error("There was an error saving this profile.  Please try again");t.error(i);n.isSaving=!1})):(n.showValidationMessages=!0,n.isSaving=!1)}}]);fundoloApp.controller("foAccountWithdrawCtrl",["$scope","$log","$window","$location","pgWePaySvc",function(n,t,i,r,u){"use strict";function e(){u.verify().then(function(t){n.account=t;f(t);n.isLoading=!1},function(t){f(t.data);n.isLoading=!1})}function f(t){var i=u.analyzeAccount(t);n.showAlert=i.showAlert;n.alertType=i.alertType;n.title=i.title;n.message=i.message;i.authorizeButtonTitle&&(n.showBlock=!0,n.buttonTitle=i.authorizeButtonTitle);n.isPending=i.wePayStatus==="Pending";n.isActive=i.wePayStatus==="Active"&&t.balances[0].balance>0;n.wePayAction=i.callback}n.$parent.pageResolve="withdraw";n.isLoading=!0;n.isPending=!1;n.isActive=!1;n.isReadyForWithdrawal=!1;e();n.confirmWithdrawal=function(){i.location.href=n.withdrawal.withdrawal_uri};n.gotoBasics=function(){r.path("/account/basics")};n.resendWePayRegistration=function(){n.isSending=!0;u.resendConfirmation().then(function(){toastr.success("You have mail!  Please confirm your WePay account");n.isSending=!1},function(i){toastr.error("Uh Oh.  For some reason our digital elves weren't able to resend the email.  Can you try again?");t.error(i);n.isSending=!1})};n.withdraw=function(){n.isWithdrawing=!0;u.withdraw().then(function(t){toastr.success("Mo' Money! Your account is now ready for withdrawal");n.isReadyForWithdrawal=!0;n.isWithdrawing=!1;n.withdrawal=t;n.isActive=!1},function(){toastr.error("Looks like WePay withdrawals are MIA.  Please try again later.");n.isWithdrawing=!1})}}]);fundoloApp.controller("foAccountPasswordCtrl",["$scope","$log","seAuthSvc","userSvc",function(n,t,i,r){"use strict";n.$parent.pageResolve="password";n.isSaving=!1;n.showValidationMessages=!1;n.password={};n.user=i.user;n.isSetPassword=angular.isUndefined(n.user.statusId)||n.user.statusId==="Pending";n.save=function(){n.isSaving=!0;n.passwordForm.$valid?n.isSetPassword?n.setPassword(function(){n.saveUserStatus("Active")}):n.changePassword():(n.showValidationMessages=!0,n.isSaving=!1)};n.saveUserStatus=function(u){r.updateStatus(u).then(function(){n.user.statusId=u;i.extendUser(n.user);toastr.success("Password saved successfully");n.isSetPassword=!1;n.isSaving=!1},function(i){t.error(i);toastr.error("There was an error saving password.  Please try again.");n.isSaving=!1})};n.setPassword=function(r){n.isSaving=!0;i.setPassword(n.password).then(function(){angular.isFunction(r)?r():(toastr.success("Password saved successfully"),n.isSaving=!1)},function(i){t.error(i);toastr.error("Oops! We could not save your password.  Please try again.");n.isSaving=!1})};n.changePassword=function(){i.changePassword(n.password).then(function(){toastr.success("Password saved successfully");n.isSaving=!1},function(i){t.error(i);toastr.error("Oops! We could not save your password."+i.error_description);n.isSaving=!1})}}]);fundoloApp.controller("foAccountDonationsCtrl",["$scope","$log","userSvc","fdSvc",function(n,t,i,r){"use strict";n.$parent.pageResolve="donations";n.isLoading=!0;i.getDonations().then(function(t){n.donations=t;n.isLoading=!1},function(i){toastr.error("There was a problem loading donations.  Please try again.");t.error(i);n.isLoading=!1});n.getImageFile=function(n){return r.getMainImage(n,263,148)}}]);fundoloApp.controller("foAccountNotificationsCtrl",["$scope",function(n){"use strict";n.$parent.pageResolve="notifications"}]);fundoloApp.controller("foAccountStatusCtrl",["$scope","$location","seAuthSvc","pgWePaySvc",function(n,t,i,r){"use strict";function u(){r.verify().then(function(t){f(t);n.isLoadingWePay=!1},function(){toastr.error("Oops!  Account information went out to lunch.  Please check again soon!");n.isLoading=!1})}function f(t){var i=r.analyzeAccount(t);n.wePayStatus=i.wePayStatus;n.message=i.message}n.$parent.pageResolve="status";n.isLoadingWePay=!0;n.facebookStatus="Active";n.user=i.user;n.status=angular.isUndefined(n.user.statusId)?"Pending":n.user.statusId;n.gotoChangePassword=function(){t.path("/account/password")};u();n.resendWePayRegistration=function(){n.isSending=!0;r.resendConfirmation().then(function(){toastr.success("You have mail!  Please confirm your WePay account");n.isSending=!1},function(t){toastr.error("Uh Oh.  For some reason our digital elves weren't able to resend the email.  Can you try again?");$log.error(t);n.isSending=!1})}}]);fundoloApp.factory("fdDashboardSvc",["$resource","$q","$filter","$compile","seAuthSvc","appUrl",function(n,t,i,r,u,f){var e={},o=n(f.api+"/api/funddetails/:action/:id/:pageNumber/:itemsPerPage",{id:"@id",action:"@action",pageNumber:"@pageNumber",itemsPerPage:"@itemsPerPage"},{save:{method:"POST",headers:{authorization:u.getBearerToken}},query:{method:"GET",headers:{authorization:u.getBearerToken},isArray:!0},summary:{method:"GET",params:{action:"summary"},headers:{authorization:u.getBearerToken},isArray:!0},isMyFund:{method:"GET",params:{action:"myfund"},headers:{authorization:u.getBearerToken}},update:{method:"PUT",params:{action:"update"},headers:{authorization:u.getBearerToken}},saveFundImage:{method:"POST",params:{action:"fundImage"},headers:{authorization:u.getBearerToken},isArray:!0},support:{method:"POST",params:{action:"support"},headers:{authorization:u.getBearerToken}},supporting:{method:"GET",params:{action:"supporting"},headers:{authorization:u.getBearerToken},isArray:!0},subscribe:{method:"POST",params:{action:"subscribe"},headers:{authorization:u.getBearerToken}},copy:{method:"POST",params:{action:"copy"},headers:{authorization:u.getBearerToken}},copy2:{method:"POST",params:{action:"copy2"},headers:{authorization:u.getBearerToken}},supporters:{method:"GET",params:{action:"supporters"}},teamedUp:{method:"GET",params:{action:"teamedUp"},headers:{authorization:u.getBearerToken},isArray:!0},teamMembers:{method:"GET",params:{action:"teamMembers"},headers:{authorization:u.getBearerToken}},status:{method:"POST",params:{action:"status"},headers:{authorization:u.getBearerToken}},history:{method:"GET",params:{action:"history"},headers:{authorization:u.getBearerToken}}}),c=n(f.api+"/api/fund/:fundId/user/:section/:id/:action/:pageNumber/:itemsPerPage",{fundId:"@fundId",section:"@section",id:"@id",action:"@action",pageNumber:"@pageNumber",itemsPerPage:"@itemsPerPage"},{save:{method:"POST",headers:{authorization:u.getBearerToken}},query:{method:"GET",headers:{authorization:u.getBearerToken},isArray:!0},getBeneficiary:{method:"GET",headers:{authorization:u.getBearerToken},params:{section:"beneficiary"},isArray:!0},update:{method:"PUT",headers:{authorization:u.getBearerToken}},fundraisers:{method:"GET",params:{section:"fundraisers"}}}),s=n(f.api+"/api/fund/:fundId/notes/:section/:id/:action/:pageNumber/:itemsPerPage",{fundId:"@fundId",section:"@section",id:"@id",action:"@action",pageNumber:"@pageNumber",itemsPerPage:"@itemsPerPage"},{save:{method:"POST"},byFundId:{method:"GET",headers:{authorization:u.getBearerToken}},updateView:{method:"PUT",headers:{authorization:u.getBearerToken},params:{action:"viewed"}},respond:{method:"POST",headers:{authorization:u.getBearerToken},params:{action:"respond"}}}),p=n(f.api+"/api/fundsettings/:action/:id",{id:"@id",action:"@action"},{update:{method:"PUT",headers:{authorization:u.getBearerToken},params:{action:"update"}}}),l=n(f.api+"/api/fund/:fundId/teams/:id/:section/:action/:pageNumber/:itemsPerPage",{fundId:"@fundId",section:"@section",id:"@id",action:"@action",pageNumber:"@pageNumber",itemsPerPage:"@itemsPerPage"},{save:{method:"POST",headers:{authorization:u.getBearerToken}},update:{method:"PUT",headers:{authorization:u.getBearerToken}},join:{method:"POST",headers:{authorization:u.getBearerToken},params:{action:"join"}}}),a=n(f.api+"/api/fund/:fundId/updates/:section/:id/:pageNumber/:itemsPerPage",{fundId:"@fundId",section:"@section",id:"@id",pageNumber:"@pageNumber",itemsPerPage:"@itemsPerPage"},{save:{method:"POST",headers:{authorization:u.getBearerToken}},query:{method:"GET",headers:{authorization:u.getBearerToken},isArray:!0},update:{method:"PUT",headers:{authorization:u.getBearerToken}},byStatusId:{method:"GET",headers:{authorization:u.getBearerToken},params:{section:"status"},isArray:!0}}),h=n(f.api+"/api/fund/:fundId/donations/:section/:id/:action/:pageNumber/:itemsPerPage",{fundId:"@fundId",section:"@section",id:"@id",action:"@action",pageNumber:"@pageNumber",itemsPerPage:"@itemsPerPage"},{save:{method:"POST",headers:{authorization:u.getBearerToken}},saveoffline:{method:"POST",headers:{authorization:u.getBearerToken},params:{section:"offline"}},update:{method:"PUT",headers:{authorization:u.getBearerToken}},xlite:{method:"PUT",headers:{authorization:u.getBearerToken},params:{section:"xlite"}},sendnote:{method:"POST",headers:{authorization:u.getBearerToken},params:{action:"sendnote"}}}),y=n(f.api+"/api/fund/:fundId/uploads/:section/:id/:action/:pageNumber/:itemsPerPage",{fundId:"@fundId",pageNumber:"@pageNumber",itemsPerPage:"@itemsPerPage",action:"@action",id:"@id",section:"@section"},{save:{method:"POST",headers:{authorization:u.getBearerToken}},update:{method:"PUT",headers:{authorization:u.getBearerToken}},"delete":{method:"DELETE",headers:{authorization:u.getBearerToken}}}),w,v;return e.removeFile=function(i){var r=t.defer(),e=n(f.api+"/api/itemuploader/remove",{},{save:{method:"POST",headers:{authorization:u.getBearerToken}}});return e.save(i,function(n){r.resolve(n)},function(n){r.reject(n)}),r.promise},e.isMyFund=function(n){var i=t.defer();return angular.isUndefined(n)?i.resolve("false"):o.isMyFund({id:n},function(){i.resolve("true")},function(){i.reject("false")}),i.promise},e.copy=function(){var n=t.defer();return o.copy({},function(t){n.resolve(t)},function(t){n.reject(t)}),n.promise},e.copy2=function(){var n=t.defer();return o.copy2({},function(t){n.resolve(t)},function(t){n.reject(t)}),n.promise},e.summary=function(n){var i=t.defer();return angular.isUndefined(n)||n<1?i.reject():o.summary({id:n},function(n){i.resolve(n)},function(n){i.reject(n)}),i.promise},e.allByUser=function(){var n=t.defer();return o.query({typeId:"Campaign"},function(t){n.resolve(t)},function(t){n.reject(t)}),n.promise},e.supporters=function(n,i,r){var u=t.defer();return o.supporters({id:n,pageNumber:i,itemsPerPage:r},function(n){u.resolve(n)},function(n){u.reject(n)}),u.promise},e.teamMembers=function(n){var i=t.defer();return o.teamMembers({id:n},function(n){i.resolve(n)},function(n){i.reject(n)}),i.promise},e.teamedUp=function(){var n=t.defer();return o.teamedUp({},function(t){n.resolve(t)},function(t){n.reject(t)}),n.promise},e.supporting=function(){var n=t.defer();return o.supporting({},function(t){n.resolve(t)},function(t){n.reject(t)}),n.promise},e.save=function(n){var i=t.defer();return angular.isUndefined(n)?i.reject():angular.isUndefined(n.identification)||n.identification<0?e.create(n).then(function(n){i.resolve(n)},function(n){i.reject(n)}):e.update(n).then(function(n){i.resolve(n)},function(n){i.reject(n)}),i.promise},e.create=function(n){var i=t.defer();return o.save(n,function(n){i.resolve(n)},function(n){i.reject(n)}),i.promise},e.update=function(n){var i=t.defer();return o.update(n,function(n){i.resolve(n)},function(n){i.reject(n)}),i.promise},e.saveFundImage=function(n){var i=t.defer();return o.saveFundImage(n,function(n){i.resolve(n)},function(n){i.reject(n)}),i.promise},e.support=function(n){var i=t.defer();return o.support(n,function(n){i.resolve(n)},function(n){i.reject(n)}),i.promise},e.status=function(n,i){var r=t.defer();return o.status({fundId:n,statusId:i},function(n){r.resolve(n)},function(n){r.reject(n)}),r.promise},e.subscribe=function(n,i,r){var u=t.defer();return o.subscribe({fundId:n,email:i,geo:r},function(n){u.resolve(n)},function(n){u.reject(n)}),u.promise},e.fundNoteByFundId=function(n,i,r){var u=t.defer();return angular.isUndefined(n)&&u.reject({error_description:"Invalid fund id",error:"Fund Id missing or invalid"}),s.byFundId({fundId:n,pageNumber:i,itemsPerPage:r},function(n){u.resolve(n)},function(n){u.reject(n)}),u.promise},e.saveFundNote=function(n){var i=t.defer();return angular.isUndefined(n)?i.reject({error:"Invalid note",error_description:"The object [fundNote] is invalid or missing"}):angular.isUndefined(n.identification)||n.identification<0?e.createFundNote(n).then(function(n){i.resolve(n)},function(n){i.reject(n)}):e.updateFundNote(n).then(function(n){i.resolve(n)},function(n){i.reject(n)}),i.promise},e.createFundNote=function(n){var i=t.defer();return s.save({fundId:n.fundId},n,function(n){i.resolve(n)},function(n){i.reject(n)}),i.promise},e.updateFundNote=function(n){var i=t.defer();return s.update({fundId:n.fundId,id:n.identification},n,function(n){i.resolve(n)},function(n){i.reject(n)}),i.promise},e.updateFundNoteView=function(n,i){var r=t.defer();return s.updateView({fundId:n,id:i},function(n){r.resolve(n)},function(n){r.reject(n)}),r.promise},e.respondFundNote=function(n){var i=t.defer();return s.respond({fundId:n.fundNote.fundId,id:n.fundNote.respondNoteId},n,function(n){i.resolve(n)},function(n){i.reject(n)}),i.promise},e.getListClass=function(n){if(angular.isUndefined(n))return"icon-custom icon-sm rounded-x icon-line icon-bg-red icon-ghost";var t="icon-custom icon-sm rounded-x icon-line ";switch(n.typeId){case"Support":t+="icon-bg-dark-blue icon-trophy";break;case"Donation":t+="icon-bg-red icon-heart";break;case"Joined":t+="icon-bg-light-grey fa fa-child";break;case"Notification":t+="icon-bg-orange icon-envelope";break;case"Share":t+="icon-bg-green icon-share";break;case"Comment":t+="icon-bg-blue fa fa-comments";break;case"Subscribe":t+="icon-bg-sea fa fa-pencil-square-o"}return t},e.saveFundSettings=function(n){var i=t.defer();return angular.isUndefined(n)?i.reject({error:"Invalid settings",error_description:"The object [fundSettings] is invalid or missing"}):angular.isUndefined(n.fundId)||n.fundId<0?e.createfundSettings(n).then(function(n){i.resolve(n)},function(n){i.reject(n)}):e.updatefundSettings(n).then(function(n){i.resolve(n)},function(n){i.reject(n)}),i.promise},e.createfundSettings=function(n){var i=t.defer();return p.save(n,function(n){i.resolve(n)},function(n){i.reject(n)}),i.promise},e.updatefundSettings=function(n){var i=t.defer();return p.update(n,function(n){i.resolve(n)},function(n){i.reject(n)}),i.promise},e.getFundUser=function(n){var i=t.defer();return angular.isUndefined(n)||n<0?i.resolve(v):c.getBeneficiary({id:n},function(n){i.resolve(n)},function(n){n.data=v;i.reject(n)}),i.promise},e.allUpdatesByUserId=function(n){var i=t.defer();return a.query({userId:n},function(n){i.resolve(n)},function(n){i.reject(n)}),i.promise},e.saveFundUser=function(n){var i=t.defer();return angular.isUndefined(n)?i.reject():angular.isUndefined(n.userId)||n.userId.length===0?e.createFundUser(n).then(function(n){i.resolve(n)},function(n){i.reject(n)}):e.updateFundUser(n).then(function(n){i.resolve(n)},function(n){i.reject(n)}),i.promise},e.createFundUser=function(n){var i=t.defer();return c.save(n,function(n){i.resolve(n)},function(n){i.reject(n)}),i.promise},e.updateFundUser=function(n){var i=t.defer();return c.update(n,function(n){i.resolve(n)},function(n){i.reject(n)}),i.promise},e.getFundraisers=function(n,i,r){var u=t.defer();return angular.isUndefined(n)||n<0?u.reject({error_description:"The fund id is either invalid or is missing",error:"Invalid Fund Id"}):c.fundraisers({fundId:n,pageNumber:i,itemsPerPage:r},function(n){u.resolve(n)},function(n){n.data=v;u.reject(n)}),u.promise},e.saveDonation=function(n){var i=t.defer();return angular.isUndefined(n)?i.reject():angular.isUndefined(n.identification)||n.identification<0?n.offlineDonation?e.createOfflineDonation(n).then(function(n){i.resolve(n)},function(n){i.reject(n)}):e.createDonation(n).then(function(n){i.resolve(n)},function(n){i.reject(n)}):e.updateDonation(n).then(function(n){i.resolve(n)},function(n){i.reject(n)}),i.promise},e.saveDonationxLite=function(n){var i=t.defer();return angular.isUndefined(n)?i.reject():h.xlite({fundId:n.fundId,id:n.identification},n,function(n){i.resolve(n)},function(n){i.reject(n)}),i.promise},e.createDonation=function(n){var i=t.defer();return h.save({fundId:n.fundId},n,function(n){i.resolve(n)},function(n){i.reject(n)}),i.promise},e.createOfflineDonation=function(n){var i=t.defer();return h.saveoffline({fundId:n.fundId},n,function(n){i.resolve(n)},function(n){i.reject(n)}),i.promise},e.updateDonation=function(n){var i=t.defer();return h.update({fundId:n.fundId},n,function(n){i.resolve(n)},function(n){i.reject(n)}),i.promise},e.createDonationNote=function(n){var i=t.defer();return h.sendnote({fundId:n.fundId,id:n.donationId},n,function(n){i.resolve(n)},function(n){i.reject(n)}),i.promise},e.allUpdatesByFundIdStatusId=function(n){var i=t.defer();return angular.isUndefined(n)||n<0?i.reject("Invalid Fund Id ["+n+"]"):a.byStatusId({fundId:n,id:"Active"},function(n){i.resolve(n)},function(n){i.reject(n)}),i.promise},e.saveUpdate=function(n){var i=t.defer();return angular.isUndefined(n)?i.reject():angular.isUndefined(n.identification)||n.identification<0?e.createUpdate(n).then(function(n){i.resolve(n)},function(n){i.reject(n)}):e.updateUpdate(n).then(function(n){i.resolve(n)},function(n){i.reject(n)}),i.promise},e.createUpdate=function(n){var i=t.defer();return a.save({fundId:n.fundId},n,function(n){i.resolve(n)},function(n){i.reject(n)}),i.promise},e.updateUpdate=function(n){var i=t.defer();return a.update({fundId:n.fundId,id:n.identification},n,function(n){i.resolve(n)},function(n){i.reject(n)}),i.promise},e.saveFundTeam=function(n){var i=t.defer();return angular.isUndefined(n)?i.reject({error:"Invalid fund team",error_description:"The object [FundTeam] is invalid or missing"}):angular.isUndefined(n.identification)||n.identification<0?e.createFundTeam(n).then(function(n){i.resolve(n)},function(n){i.reject(n)}):e.updateFundTeam(n).then(function(n){i.resolve(n)},function(n){i.reject(n)}),i.promise},e.createFundTeam=function(n){var i=t.defer();return l.save({fundId:n.fundId},n,function(n){i.resolve(n)},function(n){i.reject(n)}),i.promise},e.updateFundTeam=function(n){var i=t.defer();return l.update({id:n.identification,fundId:n.fundId},n,function(n){i.resolve(n)},function(n){i.reject(n)}),i.promise},e.joinFundTeam=function(n){var i=t.defer();return l.join({fundId:n.fundId,id:n.identification},function(n){i.resolve(n)},function(n){i.reject(n)}),i.promise},e.fundTeamByFundId=function(){var n=t.defer();return angular.isUndefined(fundId)&&n.reject({error_description:"Invalid fund id",error:"Fund Id missing or invalid"}),l.byFundId({fundId:fundId},function(t){n.resolve(t)},function(t){n.reject(t)}),n.promise},e.history=function(n,i,r){var u=t.defer();return angular.isUndefined(n)||n<1?u.reject():o.history({id:n,pageNumber:i,itemsPerPage:r},function(n){u.resolve(n)},function(n){u.reject(n)}),u.promise},e.updateFundUploads=function(n,i){var r=t.defer();return y.update({fundId:n},i,function(n){r.resolve(n)},function(n){r.reject(n)}),r.promise},e.deleteFundUploads=function(n,i){var r=t.defer();return y.delete({fundId:n,id:i},function(n){r.resolve(n)},function(n){r.reject(n)}),r.promise},e.saveFundUpload=function(n,i){var r=t.defer();return y.save({fundId:n},i,function(n){r.resolve(n)},function(n){r.reject(n)}),r.promise},w=n(f.api+"/api/fund/:fundId/fundraiser/:section/:id/:action/:pageNumber/:itemsPerPage",{fundId:"@fundId",section:"@section",id:"@id",action:"@action",pageNumber:"@pageNumber",itemsPerPage:"@itemsPerPage"},{query:{method:"GET",isArray:!0}}),e.fundraiserByFundId=function(n,i,r){var u=t.defer();return angular.isUndefined(n)&&u.reject({error_description:"Invalid fund id",error:"Fund Id missing or invalid"}),w.query({fundId:n,pageNumber:i,itemsPerPage:r},function(n){u.resolve(n)},function(n){u.reject(n)}),u.promise},v={fundId:0,userId:"",userTypeId:"",aspNetUser:{firstName:"",lastName:"",name:"",userAddressList:[{isDefault:!0,address:{}}],userPhoneList:[{isDefault:!0,phone:{typeId:"Mobile"}}],userEmailList:[{isDefault:!0,email:{}}]}},e}]);fundoloApp.controller("fdControlPanelCtrl",["$scope","$stateParams","$location","$filter","$log","$window","appUrl","fdSvc","fdDashboardSvc","pgWePaySvc","cssInjector",function(n,t,i,r,u,f,e,o,s,h,c){"use strict";function l(){o.donations(n.fund.identification,0,0).then(function(t){n.donationCount=t.count;n.fund.donationList=t.data},function(n){toastr.error(n.error_description)})}function a(){s.fundNoteByFundId(n.fund.identification,1,0).then(function(t){n.fund.fundNoteList=t},function(){toastr.error("The notifications have gone missing.  Please refresh and try again")})}function v(t){var i=e.base+"/"+t.item.permalink,r=e.base+n.mainFundImage;n.socialData={fund:t,facebookData:{method:"feed",link:i,picture:r,name:t.item.title,caption:"www.fundingmiracles.com",description:t.item.description},twitterData:{hashtags:"",via:"fundingmiracles",related:"//www.fundingmiracles.com",text:t.item.title,url:i}};n.$parent.pageTitle=t.item.title;n.$parent.pageDescription=t.item.description;n.$parent.og.title=t.item.title;n.$parent.og.description=t.item.description;n.$parent.og.url=i;n.$parent.og.image=r}function y(){n.fund.item.itemUploadList=r("orderBy")(n.fund.item.itemUploadList,"sortOrder");var t=0;angular.forEach(n.fund.item.itemUploadList,function(i){var r=i.upload.location,u=i.upload.location;if(i.upload.typeId=="web.Image"&&(r=i.upload.location+"?height=560&width=550&mode=crop&scale=both",u=i.upload.location+"?height=180&width=180&mode=crop&scale=both"),i.isDefault||t===0)switch(i.upload.typeId){case"web.Video.Vimeo":case"web.Video.YouTube":n.fund.defaultImage=i.upload.name;n.fund.defaultImageThumb=i.upload.name;break;default:n.fund.defaultImage="/azure/"+i.upload.containerName+"/"+i.upload.name+"?height=200&width=310&mode=crop&scale=both";n.fund.defaultImageThumb="/azure/"+i.upload.containerName+"/"+i.upload.name+"?height=75&width=75&mode=crop&scale=both"}i.imgUrl=r;i.thumbUrl=u;t++})}n.notifications=!0;n.isLoading=!0;n.pageResolve="overview";n.isVerifying=!0;n.socials=["facebook","twitter","mail"];n.fund={identification:t.fundId};c.add("/assets/css/pages/profile.css",!0);s.summary(t.fundId).then(function(t){n.fund=angular.isArray(t)?t[0]:t;n.files=n.fund.item.itemUploadList;n.mainFundImage=o.getMainImage(n.files,263,148);f.App.mallDub.setDomainColor(n.fund.pageColor,n.fund.pageSkin,n.fund.pageLayout);v(n.fund);n.isLoading=!1;l();a();y()},function(t){n.isLoading=!1;t.status===404&&(toastr.error("Either this fund does not exist or access to it has been restricted"),i.path("/controlpanel/fund/list"))});n.goToEdit=function(){i.path("/"+n.fund.item.permalink)};n.getTotalDonation=function(){return angular.isUndefined(n.fund)?0:o.getTotalDonation(n.fund.donationList,!0)};n.getTotalDonationsFromDate=function(t){return angular.isUndefined(n.fund)?0:o.getTotalDonationDateFrom(n.fund.donationList,t,!0)};n.getTotalDonationMonthToMonth=function(){if(angular.isUndefined(n.fund))return 0;var t=o.getTotalDonationMonthToMonth(n.fund.donationList,!0,n.fund.goalAmount),i=t>0,r=Math.abs(Math.floor(t))+"%";return r+(i?" more ":" less")};n.getProgressBarPercentage=function(){if(angular.isUndefined(n.fund))return{width:"0%"};var t=n.getProgressPercentage();return{width:t+"%"}};n.getProgressPercentage=function(){if(angular.isUndefined(n.fund))return 0;var t=this.getTotalDonation()/n.fund.goalAmount*100;return r("number")(t,0)}}]);fundoloApp.controller("fdControlPanelOverviewCtrl",["$scope","$stateParams","$location","$filter","$log","appUrl","fdSvc","fdDashboardSvc","pgWePaySvc",function(n){"use strict";n.$parent.pageResolve="overview"}]);fundoloApp.controller("fdControlPanelProfileCtrl",["$scope",function(n){"use strict";n.$parent.pageResolve="profile"}]);fundoloApp.controller("fdControlPanelSupportersCtrl",["$scope","$stateParams","fdDashboardSvc",function(n,t,i){"use strict";function r(){var i,r,t;for(n.items=[],i=(n.currentPage-1)*n.itemsPerPage,r=i+n.itemsPerPage,t=i;t<r;t++)angular.isDefined(n.itemList[t])&&n.items.push(n.itemList[t]);n.itemRows=[];n.itemRows.length=Math.ceil(n.items.length/n.numberColumns)}n.$parent.pageResolve="supporters";n.items=[];n.itemList=[];n.showWarning=!1;n.isLoading=!0;n.maxSize=7;n.totalItems=0;n.currentPage=1;n.itemsPerPage=4;n.numberColumns=2;n.itemRows=[];n.itemRows.length=Math.ceil(n.items.length/n.numberColumns);n.itemColumns=[];n.itemColumns.length=n.numberColumns;i.supporters(t.fundId,1,0).then(function(t){n.fund=angular.isArray(t)?t[0]:t;n.isLoading=!1;n.itemList=t.data;n.totalItems=t.count;r()},function(){toastr.error("Problem getting supporters","There was a problem accessing your fundraiser.  Please try again");n.isLoading=!1});n.hide=function(t){return t===n.items.length||t>n.items.length};n.onSelectPage=function(){r()}}]);fundoloApp.controller("fdControlPanelTeamsCtrl",["$scope",function(n){"use strict";n.$parent.pageResolve="teams"}]);fundoloApp.controller("fdControlPanelCommentsCtrl",["$scope","$stateParams","fdSvc",function(n,t,i){"use strict";n.$parent.pageResolve="comments";n.isLoading=!0;n.maxSize=7;n.totalItems=0;n.currentPage=1;n.itemsPerPage=10;n.getFundComments=function(r){n.isLoading=!0;(angular.isUndefined(r)||r===0)&&(r=1);i.comment(t.fundId,r,n.itemsPerPage).then(function(t){n.comments=t.data;n.totalItems=t.count;n.isLoading=!1},function(t){toastr.error(t.error_description);n.isLoading=!1})};n.onSelectPage=function(){n.getFundComments(n.currentPage)};n.getFundComments(1)}]);fundoloApp.controller("fdControlPanelHistoryCtrl",["$scope","$stateParams","cssInjector","fdDashboardSvc","mdScrollScrollSvc",function(n,t,i,r,u){"use strict";n.$parent.pageResolve="history";n.timeLine=[];n.isLoading=!0;n.moreToLoad=!0;i.add("/assets/css/pages/feature_timeline2.css");n.maxSize=7;n.totalItems=0;n.currentPage=1;n.itemsPerPage=10;n.getFundHistory=function(i){n.isLoading=!0;(angular.isUndefined(i)||i===0)&&(i=1);r.history(t.fundId,i,n.itemsPerPage).then(function(t){n.timeline=t.data;n.totalItems=t.count;n.isLoading=!1;u.scrollTo("topofPage",20)},function(t){toastr.error(t.error_description);n.isLoading=!1})};n.onSelectPage=function(){n.getFundHistory(n.currentPage)};n.getActivityIcon=function(n){var t="";switch(n.fundActivityType.identification){case"25PercentFundRaised":t="icon-custom icon-xs rounded-x icon-line icon-bg-dark-blue icon-trophy";break;case"50PercentFundRaised":t="icon-custom icon-xs  rounded-x icon-line icon-bg-orange icon-trophy";break;case"75PercentFundRaised":t="icon-custom icon-xs rounded-x icon-line icon-bg-grey icon-trophy";break;case"100PercentFundRaised":t="icon-custom icon-xs rounded-x icon-line icon-bg-brown icon-trophy"}return t};n.getFundHistory(1)}]);fundoloApp.controller("fdControlPanelSettingsCtrl",["$scope",function(n){"use strict";n.$parent.pageResolve="settings"}]);fundoloApp.controller("fdControlPanelToolsCtrl",["$scope","$stateParams","fdDashboardSvc",function(n,t,i){"use strict";n.$parent.pageResolve="tools";i.summary(t.fundId).then(function(t){n.fund=angular.isArray(t)?t[0]:t},function(t){n.isLoading=!1;t.status===404&&(toastr.error("Either this fund does not exist or access to it has been restricted"),$location.path("/controlpanel/fund/list"))})}]);fundoloApp.controller("fdControlPanelListCtrl",["$scope","$state","fdSvc","fdDashboardSvc","pgWePaySvc","mdCoreDataSvc",function(n,t,i,r,u,f){"use strict";function e(){f.getAllFundCategories().then(function(t){n.fundCategoryOptions=t},function(){})}function o(){u.verify().then(function(t){s(t);n.verification=t},function(t){n.verification={email:t.data.email};switch(t.status){case 500:n.alertType="warning";n.message="Our records show that you have not authorized us on your WePay Account.  See below for instructions.";n.verification.userState="not authorized";n.authorizeButtonTitle="Authorize your WePay Account";break;case 404:n.alertType="danger";n.message="Connect your WePay account with us and get withdrawals instantly! See below for instructions";n.verification.userState="not connected";n.authorizeButtonTitle="Connect your WePay Account"}n.title="WePay Authorization";n.showAlert=!0;n.isLoading=!1})}function s(t){var i=u.analyzeAccount(t);n.showAlert=i.showAlert;n.alertType=i.alertType;n.title=i.title;n.message=i.message;i.authorizeButtonTitle&&(n.showBlock=!0,n.buttonTitle=i.authorizeButtonTitle);n.isPending=i.wePayStatus==="Pending";n.isActive=i.wePayStatus==="Active"&&t.balances[0].balance>0;n.$parent.hasWithdrawal=n.isActive;n.$parent.hasConditionalWithdrawal=i.wePayStatus!=="Active"&&t.balances[0].balance>0}n.showMessage=!1;n.isContinuing=!1;n.showValidationMessages=!1;n.fund={};n.items=[];n.numberColumns=4;n.itemRows=[];n.itemRows.length=Math.ceil(n.items.length/n.numberColumns);n.itemColumns=[];n.itemColumns.length=n.numberColumns;n.isLoading=!0;n.items2=[];n.numberColumns2=4;n.itemRows2=[];n.itemRows2.length=Math.ceil(n.items2.length/n.numberColumns2);n.itemColumns2=[];n.itemColumns2.length=n.numberColumns2;n.isLoading2=!0;n.items3=[];n.numberColumns3=4;n.itemRows3=[];n.itemRows3.length=Math.ceil(n.items3.length/n.numberColumns3);n.itemColumns3=[];n.itemColumns3.length=n.numberColumns3;n.isLoading3=!0,function(){e()}();r.allByUser().then(function(t){t.length==0?n.isLoading=!1:(n.isLoading=!1,n.items=t,n.itemRows.length=Math.ceil(n.items.length/n.numberColumns),o())},function(){n.isLoading=!1});r.supporting().then(function(t){t.length==0?(n.supportedFunds=[],n.isLoading2=!1):(n.isLoading2=!1,n.items2=t,n.itemRows2.length=Math.ceil(n.items2.length/n.numberColumns2))},function(){});r.teamedUp().then(function(t){t.length==0?(n.teamed=[],n.isLoading3=!1):(n.isLoading3=!1,n.items3=t,n.itemRows3.length=Math.ceil(n.items3.length/n.numberColumns3))},function(){});n.continue=function(){n.isContinuing=!0;this.createNewFundForm.$valid?r.save(n.fund).then(function(i){toastr.success("Fund saved successfully");f.reCache(i.item.permalink).then(function(){},function(){});n.isContinuing=!1;t.go("home.permalink",{permalink:i.item.permalink})},function(){n.isContinuing=!1;n.showValidationMessages=!0;toastr.error("There was an error saving this fund.  Please try again")}):(n.showValidationMessages=!0,n.isContinuing=!1)};n.hide=function(n,t){return n===t.length||n>t.length};n.gotoBasics=function(){t.go("home.account.withdraw")}}]);fdControlPanelTeamsMdl=["$scope","$uibModalInstance","$filter","fdDashboardSvc","fundId","team",function(n,t,i,r,u,f){"use strict";n.isSaving=!1;n.fundId=u||undefined;n.fundTeam=angular.isUndefined(f)?{fundId:n.fundId,team:{}}:f;n.isEdit=angular.isDefined(n.fundTeam.teamId&&n.fundTeam.teamId>0);n.team=angular.copy(f);n.showValidationMessages=!1;n.save=function(){this.createTeamForm.$valid?(n.isSaving=!0,r.saveFundTeam(n.fundTeam).then(function(i){var r=n.isEdit?"updated":"created";toastr.success("Team "+r+" successfully");i.isEdit=n.isEdit;t.close(i);n.isSaving=!1},function(){toastr.error("Oops!  Problem saving team","There were some problems saving the new team.  Please try again");n.isSaving=!1})):(n.showValidationMessages=!0,n.isSaving=!1)};n.close=function(i){n.isEdit&&(n.fundTeam.team.name=n.team.team.name,n.fundTeam.captainEmail=n.team.captainEmail,n.fundTeam.goalAmount=n.team.goalAmount);t.dismiss(i)}}];fundoloApp.controller("fdControlPanelDonationsCtrl",["$scope",function(n){"use strict";n.$parent.pageResolve="donations"}]);fundoloApp.controller("fdControlPanelNotificationsCtrl",["$scope",function(n){"use strict";n.$parent.pageResolve="notifications"}]);fundoloApp.controller("fdControlPanelTeamMemberCtrl",["$scope",function(n){"use strict";n.$parent.pageResolve="teammember"}]);fundoloApp.controller("fdControlPanelEditCtrl",["$scope",function(n){"use strict";n.$parent.pageResolve="edit";n.newUploads=[]}]);fundoloApp.directive("fdControlpanelWidgetsNotificationsDrctv",["$timeout","$filter","fdDashboardSvc",function(n,t,i){"use strict";var r={};return r.restrict="E",r.transclude=!0,r.replace=!0,r.templateUrl="/app/fund/controlpanel/widgets/fd-controlpanel-widgets-notifications-drctv.min.html",r.link=function(r){r.$watch("notifications",function(n){angular.isDefined(n)&&angular.isArray(n.data)&&r.init()});r.isLoading=!0;r.init=function(){var i=t("filter")(r.notifications.data,{typeId:"Notification",note:{viewed:!1}});r.$parent.newNotifications=i.length;r.isLoading=!1;n(function(){$("#notificationScrollbar").perfectScrollbar()},1e3)};r.getListClass=function(n){return i.getListClass(n)}},r.scope={notifications:"="},r}]);fundoloApp.directive("fdControlpanelWidgetsActivityDrctv",["$timeout","$state","fdDashboardSvc",function(n,t,i){"use strict";var r={};return r.restrict="E",r.replace=!0,r.transclude=!0,r.templateUrl="/app/fund/controlpanel/widgets/fd-controlpanel-widgets-activity-drctv.min.html",r.link=function(r,u,f){f.$observe("fundId",function(n){angular.element.isNumeric(n)&&n>0&&r.init(n)});r.isLoading=!0;r.init=function(t){i.history(t,1,10).then(function(t){r.activities=t.data;r.isLoading=!1;n(function(){$("#activityScrollbar").perfectScrollbar()},1e3)},function(n){toastr.error(n.error_description);r.isLoading=!1})};r.getActivityIcon=function(n){var t="";switch(n.typeId){case"25PercentFundRaised":t="icon-custom icon-xs rounded-x icon-line icon-bg-dark-blue icon-trophy";break;case"50PercentFundRaised":t="icon-custom icon-xs  rounded-x icon-line icon-bg-orange icon-trophy";break;case"75PercentFundRaised":t="icon-custom icon-xs rounded-x icon-line icon-bg-grey icon-trophy";break;case"100PercentFundRaised":t="icon-custom icon-xs rounded-x icon-line icon-bg-brown icon-trophy"}return t};r.gotoActivity=function(){t.go("^.history")}},r.scope={},r}]);fundoloApp.directive("fdControlpanelWidgetsDonationsDrctv",["$timeout","$uibModal","$state",function(n,t,i){"use strict";var r={};return r.restrict="E",r.transclude=!0,r.replace=!0,r.templateUrl="/app/fund/controlpanel/widgets/fd-controlpanel-widgets-donations-drctv.min.html",r.link=function(r){r.$watch("donations",function(n){angular.isDefined(n)&&r.init()});r.init=function(){n(function(){$("#donationScrollbar").perfectScrollbar()},1e3)};r.gotoDonations=function(){i.go("^.donations")};r.addDonation=function(){var n=t.open({templateUrl:"/app/fund/controlpanel/widgets/fd-controlpanel-widgets-donations-drctv-mdl.min.html",controller:donationAddMdlCtrl,backdrop:"static",size:"sm-med",resolve:{fundId:function(){return r.fundId}}});n.result.then(function(n){r.donations.splice(0,0,n);r.donations.join()},function(){})}},r.scope={donations:"=",fundId:"="},r}]);donationAddMdlCtrl=["$scope","$uibModalInstance","$filter","$location","fundId","fdDashboardSvc",function(n,t,i,r,u,f){n.isSaving=!1;n.thankYouMessage="";n.showValidationMessages=!1;n.donation={processingFee:0,beneficiaryAmount:0,systemAmount:0,amount:0,offlineDonation:!0,statusId:"Active",feeTypeId:"Level0",fundId:u};n.ok=function(){this.offlineDonationFormWidget.$valid?(n.isSaving=!0,n.donation.amount=n.donation.beneficiaryAmount,f.saveDonation(n.donation).then(function(i){toastr.success("Offline donation completed successfully");t.close(i);n.isSaving=!1},function(){toastr.error("Oops!  Problem saving offline donation","There were some problems saving the offline donation.  Please try again");n.isSaving=!1})):(n.showValidationMessages=!0,n.isSaving=!1)};n.cancel=function(){t.dismiss("cancel")}}];donationThankYouMdlCtrl=["$scope","$uibModalInstance","fdDashboardSvc","donation",function(n,t,i,r){n.isSaving=!1;n.donation=r;n.donationNote={typeId:"ThankYou",donationId:r.identification,fundId:r.fundId};n.ok=function(){this.donationThankYouForm.$valid&&(n.isSaving=!0,i.createDonationNote(n.donationNote).then(function(i){r.thankYouNoteSent=!0;toastr.success("Thank you note sent successfully");t.close(i);n.isSaving=!1},function(){toastr.error("Oops!  Problem sending Thank you note","There were some problems sending a Thank you note.  Please try again");n.isSaving=!1}));t.close(r)};n.cancel=function(){t.dismiss("cancel")}}];fundoloApp.directive("fdControlpanelWidgetsUpdatesDrctv",["$timeout","fdDashboardSvc","$uibModal",function(n,t,i){"use strict";var r={};return r.restrict="E",r.transclude=!0,r.replace=!0,r.templateUrl="/app/fund/controlpanel/widgets/fd-controlpanel-widgets-updates-drctv.min.html",r.link=function(r,u,f){function o(){r.isLoading=!1;r.itemList=r.updates;r.totalItems=r.itemList.length;e()}function e(){var t,i,n;for(r.items=[],t=(r.currentPage-1)*r.itemsPerPage,i=t+r.itemsPerPage,n=t;n<i;n++)angular.isDefined(r.itemList[n])&&r.items.push(r.itemList[n])}f.$observe("fundId",function(n){angular.element.isNumeric(n)&&n>0&&r.init(n)});r.isLoading=!0;r.maxSize=5;r.totalItems=0;r.currentPage=1;r.itemsPerPage=5;r.init=function(n){r.fundId=n;r.getFundUpdates()};r.getFundUpdates=function(){r.isLoading=!0;t.allUpdatesByFundIdStatusId(r.fundId).then(function(t){r.updates=t;n(function(){$("#updateScrollbar").perfectScrollbar()},1e3);o()},function(){toastr.error("Unable to get updates.  Please try again");r.isLoading=!1})};r.updateFundUpdate=function(n){n.isUpdating=!0;n.statusId="Deleted";t.saveUpdate(n).then(function(){r.updates.splice(r.updates.indexOf(n),1);toastr.success("Post updated successfully")},function(){toastr.error("Oops!  Problem removing update","There were some problems remove the update.  Please try again");n.isUpdating=!1})};r.verifyDelete=function(n,t){n.isDeleting=t};r.postUpdate=function(){var n=i.open({templateUrl:"/app/fund/controlpanel/widgets/fd-controlpanel-widgets-updates-drctv-mdl.min.html",controller:fdControlPanelWidgetsUpdatesMdl,backdrop:"static",size:"med",resolve:{fundId:function(){return r.fundId}}});n.result.then(function(n){r.updates.splice(0,0,n);r.updates.join()},function(){})};r.onSelectPage=function(){e()}},r.scope={},r}]);fdControlPanelWidgetsUpdatesMdl=["$scope","$uibModalInstance","$timeout","$window","fdDashboardSvc","seAuthSvc","Facebook","twitterConfiguration","fundId",function(n,t,i,r,u,f,e,o,s){function c(){n.fundUpdate.content="";n.isDeleting=!1;n.facebookIt=!1;n.tweetIt=!1;n.mailIt=!1}function h(t){n.user.facebookToken=t.authResponse;f.extendUser(n.user);f.postClaim("Facebook",t.authResponse.accessToken).then(function(){n.isSaving=!1},function(){toastr.error("Facebook gnomes are on the prowl.  Refresh your page and try again.")})}n.isLoading=!0;n.isSaving=!1;n.facebookIt=!1;n.tweetIt=!1;n.mailIt=!1;n.twittered=!1;n.user=f.user;n.$watch(function(){return e.isReady()},function(){n.facebookReady=!0});n.facebookMark=function(){n.facebookIt=!n.facebookIt};n.intentLogin=function(t,i){var r=t.target;if(r.checked)switch(i){case"Facebook":if(n.user.isExternal&&n.user.externalProvider==="Facebook")return;if(angular.isDefined(n.user.facebookToken))return;n.facebookGetLoginStatus();break;case"Twitter":n.twitterGetLoginStatus()}};n.intentLoginButton=function(t){switch(t){case"Email":n.mailIt=!n.mailIt;break;case"Facebook":if(n.facebookIt=!n.facebookIt,!n.facebookIt)return;if(n.user.isExternal&&n.user.externalProvider==="Facebook")return;if(angular.isDefined(n.user.facebookToken))return;n.facebookGetLoginStatus();break;case"Twitter":if(n.tweetIt=!n.tweetIt,!n.tweetIt)return;n.twitterGetLoginStatus()}};n.facebookLogin=function(){n.isSaving=!0;e.login(function(t){t.status=="connected"?(n.isSaving=!0,h(t)):(toastr.error("There was a problem connecting to Facebook.  Please refresh and try again"),n.facebookIt=!1,n.tweetIt=!1,n.isSaving=!1)})};n.me=function(){e.api("/me",function(t){n.$apply(function(){n.user=t})})};n.facebookGetLoginStatus=function(){e.getLoginStatus(function(t){t.status=="connected"?h(t):n.facebookLogin()})};n.twitterGetLoginStatus=function(){return n.twittered||r.open(o.signInUrl+n.fundId,"Funding Miracles Authorization","width=650,height=400,toolbar=0,menubar=0,location=1,status=1,scrollbars=1,resizable=1,left=0,top=0"),n.twittered=!0,!1};n.mailMark=function(){n.mailIt=!n.mailIt};n.saveFundUpdate=function(i){n.isSaving=!0;this.controlPanelUpdateMdlForm.$valid?(i.fundId=s,i.postedToFacebook=n.facebookIt,i.postedToTwitter=n.tweetIt,i.postedToEmail=n.mailIt,u.saveUpdate(i).then(function(i){c();n.isSaving=!1;toastr.success("Update posted successfully");t.close(i)},function(){toastr.error("Oops!  Problem creating update","There were some problems creating the update.  Please try again");n.isSaving=!1})):(toastr.info("Oops!  Description is required","Description is required.  Please fill it in."),n.isSaving=!1)};n.verifyDelete=function(n,t){n.isDeleting=t};n.updateFundUpdate=function(t){t.isUpdating=!0;t.statusId="Deleted";u.saveUpdate(t).then(function(){n.fundUpdates.splice(n.fundUpdates.indexOf(t),1);toastr.success("Connection updated successfully")},function(){toastr.error("Oops!  Problem removing update","There were some problems remove the update.  Please try again");t.isUpdating=!1})};n.$on("Facebook:statusChange",function(t,r){console.log("Status: ",r);r.status=="connected"?n.$apply(function(){n.salutation=!0;n.byebye=!1}):n.$apply(function(){n.salutation=!1;n.byebye=!0;i(function(){n.byebye=!1},2e3)})});n.close=function(n){t.dismiss(n)};n.cancel=function(){t.dismiss("cancel")}}];fundoloApp.directive("fdControlpanelWidgetsSupportersDrctv",["$timeout","$state",function(n,t){"use strict";var i={};return i.restrict="E",i.transclude=!0,i.replace=!0,i.templateUrl="/app/fund/controlpanel/widgets/fd-controlpanel-widgets-supporters-drctv.min.html",i.link=function(i){i.$watch("supporters",function(n){angular.isDefined(n)&&i.init()});i.init=function(){n(function(){$("#supporterScrollbar").perfectScrollbar()},1e3)};i.viewAll=function(){t.go("^.supporters")}},i.scope={supporters:"="},i}]);fundoloApp.directive("fdControlpanelWidgetsTeamsDrctv",["$location","$timeout","$uibModal","$state","fdSvc",function(n,t,i,r,u){"use strict";var f={};return f.restrict="E",f.replace=!0,f.templateUrl="/app/fund/controlpanel/widgets/fd-controlpanel-widgets-teams-drctv.min.html",f.link=function(f,e,o){o.$observe("fundId",function(n){angular.element.isNumeric(n)&&n>0&&f.init(n)});f.isLoading=!0;f.init=function(n){f.fundId=n;u.fundTeams(n).then(function(n){f.teams=n;t(function(){$("#teamScrollbar").perfectScrollbar()},1e3);f.isLoading=!1},function(){toastr.error("We seemed to have misplaced your teams.  Please refresh and try again");f.isLoading=!1})};f.openTeam=function(n){var t=i.open({templateUrl:"/app/fund/controlpanel/fdControlPanelTeamsMdl.min.html",controller:fdControlPanelTeamsMdl,size:"sm-med",backdrop:"true",resolve:{fundId:function(){return f.fundId},team:function(){return n}}});t.result.then(function(n){n.isEdit||(f.teams.splice(0,0,n),f.teams.join())},function(){})};f.openTeamFund=function(t){n.path("/fund/controlpanel/"+t.teamFundId+"/overview")};f.viewAll=function(){r.go("^.teams")};f.getProgressPercentage=function(n){if(angular.isUndefined(n))return{width:"0%"};var t=u.getProgressPercentage(n,!0);return{width:$filter("number")(t,0)+"%"}}},f.scope={},f}]);fundoloApp.directive("fdControlpanelWidgetsTeamsLgDrctv",["$timeout","$location","$uibModal","$filter","fdSvc",function(n,t,i,r,u){"use strict";var f={};return f.restrict="E",f.replace=!0,f.templateUrl="/app/fund/controlpanel/widgets/fd-controlpanel-widgets-teams-lg-drctv.min.html",f.link=function(f){function o(n){n.photoUrl=angular.isDefined(n.facebook)?"https://graph.facebook.com/"+n.facebook.providerKey+"/picture?width=54&height=54":n.avatarUploadTempLocation}function e(){var t,i,n;for(f.items=[],t=(f.currentPage-1)*f.itemsPerPage,i=t+f.itemsPerPage,n=t;n<i;n++)angular.isDefined(f.itemList[n])&&f.items.push(f.itemList[n]);f.itemRows=[];f.itemRows.length=Math.ceil(f.items.length/f.numberColumns)}n(function(){$("li").tooltip()},1e3);f.items=[];f.itemList=[];f.showWarning=!1;f.isLoading=!0;f.maxSize=7;f.totalItems=0;f.currentPage=1;f.itemsPerPage=4;f.numberColumns=2;f.itemRows=[];f.itemRows.length=Math.ceil(f.items.length/f.numberColumns);f.itemColumns=[];f.itemColumns.length=f.numberColumns;u.fundTeams(f.fundId).then(function(n){f.teams=n;f.init()},function(n){$log.error(n)});f.init=function(){f.setUpImages();f.isLoading=!1;f.itemList=f.teams;f.totalItems=f.itemList.length;e()};f.setUpImages=function(){angular.forEach(f.teams,function(n){n.mainFundImage=u.getMainImage(n.fund.item.itemUploadList,389,246)})};f.findUserByType=function(n,t){var i={},r,u;if(angular.isUndefined(n))return{};switch(t){case"Originator":angular.isDefined(n.originator)&&(i=n.originator,r=!0);break;case"Beneficiary":angular.isDefined(n.beneficiary)&&(i=n.beneficiary,r=!0)}return r?i:(u=n.userList,angular.forEach(u,function(r){switch(t){case"Originator":i=r;o(i);n.originator=i;break;case"Beneficiary":i=r;o(i);n.beneficiary=i}}),i)};f.hide=function(n){return n===f.items.length||n>f.items.length};f.onSelectPage=function(){e()};f.openTeam=function(n){var t=i.open({templateUrl:"/app/fund/controlpanel/fdControlPanelTeamsMdl.min.html",controller:fdControlPanelTeamsMdl,size:"sm-med",backdrop:"true",resolve:{fundId:function(){return f.fundId},team:function(){return n}}});t.result.then(function(n){n.isEdit||(n.name=n.team.name,n.dateEntered=n.team.dateEntered,f.teams.push(n),f.itemList=f.teams,f.totalItems=f.itemList.length,e())},function(){})};f.teamSettings=function(n){t.path("/fund/controlpanel/"+n.teamFundId+"/overview")};f.getTotalDonation=function(n){return angular.isUndefined(n)?0:u.getTotalDonation(n.donationList,!0)};f.getProgressBarPercentage=function(n){if(angular.isUndefined(n))return{width:"0%"};var t=f.getProgressPercentage(n);return{width:t+"%"}};f.getProgressPercentage=function(n){if(angular.isUndefined(n))return 0;var t=this.getTotalDonation(n)/n.goalAmount*100;return r("number")(t,0)}},f.scope={fundId:"="},f}]);fundoloApp.directive("fdControlpanelWidgetsSquadDrctv",[function(){"use strict";var n={};return n.restrict="E",n.transclude=!0,n.replace=!0,n.templateUrl="/app/fund/controlpanel/widgets/fd-controlpanel-widgets-squad-drctv.min.html",n.controller=["$scope","$location",function(n){function i(){angular.forEach(n.supporters,function(t){switch(t.userTypeId){case"Originator":n.originator=t;break;case"Beneficiary":n.beneficiary=t}});angular.isUndefined(n.beneficiary)&&(n.beneficiary=n.originator);t(n.beneficiary);t(n.originator)}function t(n){n.photoUrl=angular.isDefined(n.facebook)?"https://graph.facebook.com/"+n.facebook.providerKey+"/picture?width=54&height=54":n.avatarUploadTempLocation}n.init=function(){i()};n.viewAll=function(){};n.sendEmail=function(){}}],n.link=function(n){n.$watch("supporters",function(t){angular.isDefined(t)&&n.init()})},n.scope={supporters:"="},n}]);fundoloApp.directive("fdControlpanelWidgetsCommentsDrctv",["$timeout","$state","fdSvc",function(n,t,i){"use strict";var r={};return r.tranclude=!0,r.replace=!0,r.restrict="E",r.templateUrl="/app/fund/controlpanel/widgets/fd-controlpanel-widgets-comments-drctv.min.html",r.link=function(r,u,f){f.$observe("fundId",function(n){angular.element.isNumeric(n)&&n>0&&r.init(n)});r.isLoading=!0;r.init=function(t){i.comment(t,1,10).then(function(t){r.comments=t.data;r.isLoading=!1;n(function(){$("#commentScrollbar").perfectScrollbar()},1e3)},function(n){toastr.error(n.error_description);r.isLoading=!1})};r.viewAll=function(){t.go("^.comments")}},r.scope={},r}]);fundoloApp.directive("fdControlpanelWidgetsBadgeDrctv",[function(){"use strict";var n={};return n.restrict="E",n.transclude=!0,n.replace=!0,n.template='<div ng-class="badgeClass">{{badgeContent}}<\/div>',n.link=function(n){n.$watch("fund",function(t){angular.isDefined(t)&&n.init()},!1);n.init=function(){var t;if(angular.isDefined(n.fund)){n.badgeClass=["easy-block-v1-badge","rgba-aqua"];n.badgeContent="In Progress";var i=moment.utc().subtract(30,"days"),r=moment.utc(n.fund.item.startDate),u=moment.utc(n.fund.item.endDate),f=moment.utc();if(r>i){n.badgeContent="New!";n.badgeClass=["easy-bg-v2","rgba-default"];return}if(f>u){n.badgeContent="Ended";n.badgeClass=["easy-block-v1-badge","rgba-red"];return}if(t=0,angular.forEach(n.fund.donationList,function(n){t+=n.beneficiaryAmount}),t>n.fund.goalAmount){n.badgeContent="Goal Reached!";n.badgeClass=["easy-block-v1-badge","rgba-purple"];return}}}},n.scope={fund:"="},n}]);fundoloApp.directive("fdControlpanelWidgetsBadgev2Drctv",[function(){"use strict";var n={};return n.restrict="E",n.transclude=!1,n.replace=!0,n.template='<div ng-class="badgeClass"><i ng-class="iconClass"><\/i> {{badgeContent}}<\/div>',n.link=function(n){n.$watch("fund",function(t){angular.isDefined(t)&&n.init(t)},!1);n.init=function(t){var i;if(angular.isDefined(t)){n.badgeClass=[];n.badgeContent="";n.iconClass=[];n.bannerVersion=n.bannerVersion||"rgba-banner";var u=moment.utc().subtract(10,"days"),f=moment.utc(t.item.startDate),e=moment.utc(t.item.endDate),o=moment.utc(t.item.endDate).subtract(7,"days"),r=moment.utc();if(moment(f).isAfter(u)){n.badgeContent="New!";n.badgeClass=["shop-rgba-red",n.bannerVersion];return}if(moment(r).isAfter(e)){if(i=0,angular.forEach(t.donationList,function(n){i+=n.beneficiaryAmount}),i>=t.goalAmount){n.iconClass=["fa","fa-trophy"];n.badgeContent="Goal Reached!";n.badgeClass=["shop-rgba-purple",n.bannerVersion];return}n.badgeContent="Ended";n.badgeClass=["shop-rgba-dark",n.bannerVersion];return}if(moment(r).isAfter(o)){n.badgeContent="Ending Soon!";n.badgeClass=["shop-rgba-yellow",n.bannerVersion];return}}}},n.scope={fund:"=",bannerVersion:"@"},n}]);fundoloApp.directive("fdControlpanelWidgetsEmbedDrctv",[function(){"use strict";var n={};return n.tranclude=!0,n.replace=!0,n.restrict="E",n.templateUrl="/app/fund/controlpanel/widgets/fd-controlpanel-widgets-embed-drctv.min.html",n.link=function(n){n.$watch("fund",function(t){angular.isDefined(t)&&(n.isLoading=!1,n.init())})},n.controller=["$scope","appUrl",function(n,t){n.showWarning=!1;n.init=function(){n.miraclesLogo=t.base+"/assets/img/logo103.png";n.miraclesHome=t.base+"?fm_src=fundcard";n.cardSrc=t.base+"/fund/card/"+n.fund.item.permalink;n.buttonSrc=t.base+"/fund/button/"+n.fund.item.permalink;n.widgetSrc=t.base+"/fund/widget/"+n.fund.item.permalink}}],n.scope={fund:"="},n}]);fundoloApp.directive("fdControlpanelWidgetsPrintDrctv",[function(){"use strict";var n={};return n.tranclude=!0,n.replace=!0,n.restrict="E",n.templateUrl="/app/fund/controlpanel/widgets/fd-controlpanel-widgets-print-drctv.min.html",n.link=function(n){n.$watch("fund",function(t){angular.isDefined(t)&&n.init(t)})},n.controller=["$scope","$compile","appUrl","mdCoreDataSvc",function(n,t,i,r){n.showWarning=!1;n.isLoading=!0;n.imageUrl=i.fundPrint+"/printfund.aspx?f="+n.fund.item.permalink;n.init=function(){n.imageUrl=i.fundPrint+"/printfund.aspx?f="+n.fund.item.permalink};n.printIt=function(){var u='<img src="'+i.fundPrint+"/printfund.aspx?f="+n.fund.item.permalink+'">',f;r.isIe()>1?r.printPage(u):(f=t(angular.element(document.getElementById("fundPrintImage")))(n),r.printSection(f,u,n.fund.item.title))};n.imageLoaded=function(){n.isLoading=!1;n.$apply("isLoading")}}],n.scope={fund:"="},n}]);fundoloApp.directive("fdControlpanelWidgetsShareDrctv",[function(){"use strict";var n={};return n.tranclude=!0,n.replace=!0,n.restrict="E",n.templateUrl="/app/fund/controlpanel/widgets/fd-controlpanel-widgets-share-drctv.min.html",n.link=function(n){n.$watch("fund",function(t){angular.isDefined(t)&&n.fundToOpenGraph(t)})},n.controller=["$scope","$state","appUrl","fdSvc",function(n,t,i,r){n.showWarning=!1;n.isLoading=!0;n.socials=["facebook","twitter","mail"];n.baseUrl=i.base;var u="",f="";n.fundToOpenGraph=function(t){u=t.item.permalink;f=i.base+"/"+u;n.mainFundImage=r.getMainImage(t.item.itemUploadList,230,150);var e=i.base+n.mainFundImage;n.socialData={fund:t,facebookData:{method:"feed",link:f,picture:e,name:t.item.title,caption:"www.fundingmiracles.com",description:t.item.description},twitterData:{hashtags:"",via:"fundingmiracles",related:"//www.fundingmiracles.com",text:t.item.title,url:f}}};n.viewFund=function(){t.go("home.permalink",{permalink:u})}}],n.scope={fund:"="},n}]);fundoloApp.directive("fdControlpanelWidgetsProfileDrctv",["appUrl","fdSvc",function(n,t){"use strict";var i={};return i.restrict="E",i.transclude=!0,i.replace=!0,i.templateUrl="/app/fund/controlpanel/widgets/fd-controlpanel-widgets-profile-drctv.min.html",i.link=function(i){i.$watch("fund",function(r){angular.isDefined(r)&&angular.isDefined(r.item)&&(i.fundUrl=n.base+"/"+i.fund.item.permalink,i.mainFundImage=t.getMainImage(i.fund.item.itemUploadList,240,200))})},i.scope={fund:"="},i}]);fundoloApp.directive("fdControlpanelWidgetsAnalyticsDrctv",["$timeout","$state","mdGoogleSvc",function(n,t,i){"use strict";var r={};return r.restrict="E",r.replace=!0,r.transclude=!0,r.templateUrl="/app/fund/controlpanel/widgets/fd-controlpanel-widgets-analytics-drctv.min.html",r.link=function(n,t,r){function u(t){var r=moment().subtract(7,"days").format("YYYY-MM-DD"),u=moment().add(1,"days").format("YYYY-MM-DD");i.pageView(t,r,u).then(function(t){n.lastWeekData=t[0];n.lastWeekLoading=!1},function(){n.lastWeekData={pageviews:"N/A"};n.lastWeekLoading=!1})}function f(t){var r=moment().subtract(30,"days").format("YYYY-MM-DD"),u=moment().add(1,"days").format("YYYY-MM-DD");i.pageView(t,r,u).then(function(t){n.lastMonthData=t[0];n.lastMonthLoading=!1},function(){n.lastMonthData={pageviews:"N/A"};n.lastMonthLoading=!1})}function e(t){var r=moment().add(1,"days").format("YYYY-MM-DD");i.pageView(t,"2014-01-01",r).then(function(t){n.allTimeData=t[0];n.allTimeLoading=!1},function(){n.allTimeData={pageviews:"N/A"};n.allTimeLoading=!1})}r.$observe("permalink",function(t){angular.isDefined(t)&&t.length>0&&n.init(t)});n.lastWeekLoading=!0;n.lastMonthLoading=!0;n.allTimeLoading=!0;n.init=function(n){u(n);f(n);e(n)}},r.scope={},r}]);fundoloApp.directive("fdControlpanelWidgetsSettingsDrctv",["$timeout","fdDashboardSvc",function(n,t){"use strict";var i={};return i.transclude=!0,i.restrict="E",i.templateUrl="/app/fund/controlpanel/widgets/fd-controlpanel-widgets-settings-drctv.min.html",i.replace=!0,i.link=function(i){function o(n,t){switch(n){case"email":i.isSavingEmail=t;break;case"facebook":i.isSavingFacebook=t;break;case"config":i.isSavingConfig=t;break;case"donation":i.isSavingDonation=t}}function f(n,t){switch(n){case"email":i.emailButtonTitle=t?r:u;break;case"facebook":i.facebookButtonTitle=t?r:u;break;case"config":i.configButtonTitle=t?r:u;break;case"donation":i.donationButtonTitle=t?r:u}}var r="Turn On All",u="Turn Off All",e;if(i.showWarning=!1,i.isLoading=!0,i.isSavingEmail=!1,i.isSavingFacebook=!1,i.isSavingConfig=!1,i.isSavingStatus=!1,i.isSavingDonation=!1,i.emailTurnOn=!0,i.facebookTurnOn=!0,i.configTurnOn=!0,i.donationTurnOn=!0,i.emailButtonTitle=r,i.facebookButtonTitle=r,i.configButtonTitle=r,i.donationButtonTitle=r,i.tabActives={tab1:!1,tab2:!1,tab3:!1,tab4:!1,tab5:!1},angular.isDefined(i.activeTab))switch(i.activeTab){case"2":i.tabActives.tab2=!0;break;case"3":i.tabActives.tab3=!0;break;case"4":i.tabActives.tab4=!0;break;case"5":i.tabActives.tab5=!0;break;case"1":default:i.tabActives.tab1=!0}else i.tabActives.tab1=!0;i.updateStatus=function(r){i.isSavingStatus=!0;t.status(i.fund.identification,r).then(function(){e=n(function(){toastr.success("Setting updated successfully");i.isSavingStatus=!1},2e3)},function(){toastr.error("Uh oh.  There is a problem changing the status.  Please refresh and try again.");i.isSavingStatus=!1})};i.updateSettings=function(r){o(r,!0);t.saveFundSettings(i.fund.settings).then(function(){toastr.success("Setting updated successfully");e=n(function(){o(r,!1)},2e3)},function(){toastr.error("There was an issue saving the settings.  Please refresh and try again")})};i.updateSettingsGroup=function(n){switch(n){case"email":i.fund.settings.emailReceiveUserDonation=i.emailTurnOn;i.fund.settings.emailSendSupporter25Raised=i.emailTurnOn;i.fund.settings.emailReceiveUserSupport=i.emailTurnOn;i.fund.settings.emailSendSupporter50Raised=i.emailTurnOn;i.fund.settings.emailReceiveUserFundraiser=i.emailTurnOn;i.fund.settings.emailSendSupporter75Raised=i.emailTurnOn;i.fund.settings.emailReceiveUserTeamMember=i.emailTurnOn;i.fund.settings.emailSendSupporterFriendSupport=i.emailTurnOn;i.emailTurnOn=!i.emailTurnOn;f(n,i.emailTurnOn);break;case"facebook":i.fund.settings.facebookPostAddVideo=i.facebookTurnOn;i.fund.settings.facebookPostUserSupport=i.facebookTurnOn;i.fund.settings.facebookPostAddImage=i.facebookTurnOn;i.fund.settings.facebookPostUserDonate=i.facebookTurnOn;i.fund.settings.facebookPostUpdate=i.facebookTurnOn;i.fund.settings.facebookPostUserFundraiser=i.facebookTurnOn;i.facebookTurnOn=!i.facebookTurnOn;f(n,i.facebookTurnOn);break;case"config":i.fund.settings.allowAnonymousDonors=i.configTurnOn;i.fund.settings.allowCommenting=i.configTurnOn;i.fund.settings.allowRecuringPayments=i.configTurnOn;i.fund.settings.usePaymentModal=i.configTurnOn;i.configTurnOn=!i.configTurnOn;f(n,i.configTurnOn);break;case"donation":i.fund.settings.donationHideAmount=i.donationTurnOn;i.fund.settings.donationHideDonorName=i.donationTurnOn;i.donationTurnOn=!i.donationTurnOn;f(n,i.donationTurnOn)}i.updateSettings(n)};i.$on("destroy",function(){n.cancel(e)})},i.scope={fund:"=",activeTab:"@"},i}]);fundoloApp.directive("fdControlpanelWidgetsDonationsLgDrctv",["$timeout","$uibModal","$filter","mdScrollScrollSvc","fdDashboardSvc",function(n,t,i,r,u){"use strict";var f={};return f.restrict="E",f.replace=!0,f.templateUrl="/app/fund/controlpanel/widgets/fd-controlpanel-widgets-donations-lg-drctv.min.html",f.link=function(f){function e(){var t,i,n;for(f.items=[],t=(f.currentPage-1)*f.itemsPerPage,i=t+f.itemsPerPage,n=t;n<i;n++)angular.isDefined(f.itemList[n])&&f.items.push(f.itemList[n]);f.itemRows=[];f.itemRows.length=Math.ceil(f.items.length/f.numberColumns)}n(function(){$("li").tooltip();$("button").tooltip()},1e3);f.$watch("donations",function(n){angular.isDefined(n)&&angular.isArray(n)&&f.init()});f.items=[];f.itemList=[];f.showWarning=!1;f.isLoading=!0;f.maxSize=7;f.totalItems=0;f.currentPage=1;f.itemsPerPage=16;f.numberColumns=2;f.itemRows=[];f.itemRows.length=Math.ceil(f.items.length/f.numberColumns);f.itemColumns=[];f.itemColumns.length=f.numberColumns;f.init=function(){f.isLoading=!1;f.itemList=i("orderBy")(f.donations,"dateEntered",!0);f.totalItems=f.donations.length;e()};f.addDonation=function(){var n=t.open({templateUrl:"/app/fund/controlpanel/widgets/fd-controlpanel-widgets-donations-drctv-mdl.min.html",controller:donationAddMdlCtrl,backdrop:"static",size:"sm-med",resolve:{fundId:function(){return f.fundId}}});n.result.then(function(n){f.donations.splice(0,0,n);f.donations.join();f.init()},function(){})};f.hide=function(n){return n===f.items.length||n>f.items.length};f.onSelectPage=function(){e();r.scrollTo("fundDonationsPage",20)};f.openThankYou=function(n){var i=t.open({templateUrl:"/app/fund/controlpanel/widgets/fd-controlpanel-widgets-donations-thankyou-mdl.min.html",controller:donationThankYouMdlCtrl,backdrop:"static",size:"sm-med",resolve:{donation:function(){return n}}});i.result.then(function(){},function(){})};f.makeAnonymous=function(n){f.saveDonationxLite(n);f.verifyMakeAnonymous(n,!1)};f.saveDonationxLite=function(n){var t={identification:n.identification,isPrivateAmount:n.isPrivateAmount,isPrivateDonorName:n.isPrivateDonorName,message:n.message,fundId:f.fundId};u.saveDonationxLite(t).then(function(){return toastr.success("Operation completed successfully"),n.isUpdating=!1,!0},function(t){return toastr.error("Oops!  Problem removing update","There were some problems remove the update.  Please try again"),$log.error(t),n.isUpdating=!1,!1})};f.save=function(n){n.isUpdating=!0;u.saveDonation(n).then(function(){n.statusId==="Deleted"&&f.fund.donationList.splice(f.fund.donationList.indexOf(n),1);toastr.success("Operation completed successfully");n.isUpdating=!1},function(){toastr.error("Oops!  Problem removing update","There were some problems removing the update.  Please try again");n.isUpdating=!1})};f.deleteDonation=function(n){n.statusId="Deleted";f.save(n);f.verifyDeleteDonation(n,!1)};f.verifyDeleteComment=function(n,t){n.isCommentDeleting=t};f.verifyMakeAnonymous=function(n,t){n.isMakeAnonymous=t};f.verifyDeleteDonation=function(n,t){n.isDonationDeleting=t};f.deleteComment=function(n){var t=n.message;n.message="";f.saveDonationxLite(n)===!1&&(n.message=t);f.verifyDeleteComment(n,!1)};f.showDelete=function(n){return n==="Active"}},f.scope={donations:"=",fundId:"="},f}]);fundoloApp.directive("fdControlpanelWidgetsNotificationsLgDrctv",["$timeout","$uibModal","$filter","mdScrollScrollSvc","fdDashboardSvc",function(n,t,i,r,u){"use strict";var f={};return f.restrict="E",f.replace=!0,f.templateUrl="/app/fund/controlpanel/widgets/fd-controlpanel-widgets-notifications-lg-drctv.min.html",f.link=function(f){function e(n,t){switch(t){case"closeSuccess":n.note.viewed=!0;f.$parent.newNotifications--}}function s(){angular.forEach(f.notifications.data,function(n){switch(n.typeId){case"Donation":n.note.subject="You have a new donation!";break;case"Notification":n.note.subject="Someone is trying to connect with you!";break;case"Support":n.note.subject="A new Supporter has joined your campaign!"}})}function o(){var t,i,n;for(f.items=[],t=(f.currentPage-1)*f.itemsPerPage,i=t+f.itemsPerPage,n=t;n<i;n++)angular.isDefined(f.itemList[n])&&f.items.push(f.itemList[n]);f.itemRows=[];f.itemRows.length=Math.ceil(f.items.length/f.numberColumns)}f.$watch("notifications",function(n){angular.isDefined(n)&&angular.isArray(n.data)&&f.init()});n(function(){$("li").tooltip();$("button").tooltip()},1e3);f.items=[];f.itemList=[];f.showWarning=!1;f.isLoading=!0;f.maxSize=7;f.totalItems=0;f.currentPage=1;f.itemsPerPage=16;f.numberColumns=2;f.itemRows=[];f.itemRows.length=Math.ceil(f.items.length/f.numberColumns);f.itemColumns=[];f.itemColumns.length=f.numberColumns;f.init=function(){s();f.isLoading=!1;var n=i("filter")(f.notifications.data,{typeId:"Notification"});f.itemList=i("orderBy")(n,"note.dateEntered",!0);f.totalItems=f.notifications.count;o()};f.hide=function(n){return n===f.items.length||n>f.items.length};f.onSelectPage=function(){o();r.scrollTo("fundNotificationsPage",20)};f.getListClass=function(n){return u.getListClass(n)};f.respond=function(n){var i=t.open({templateUrl:"/app/fund/controlpanel/widgets/fd-controlpanel-widgets-notifications-mdl.min.html",controller:fdControlpanelWidgetsNotificationsMdl,backdrop:"static",resolve:{rowItem:function(){return n}}});i.result.then(function(t){e(n,t)},function(t){e(n,t)})}},f.scope={notifications:"="},f}]);fdControlpanelWidgetsNotificationsMdl=["$scope","$uibModalInstance","$uibModal","fdDashboardSvc","appUrl","rowItem",function(n,t,i,r,u,f){n.sender={fundNote:{respondNoteId:f.identification,fundId:f.fundId,typeId:"Response"},firstName:f.note.firstName,lastName:f.note.lastName,email:f.note.email,comments:"",isPrivate:"true"};n.showValidationMessages=!1;n.isResponding=!1;n.record=f;n.respond=function(){n.isResponding=!0;this.fundNotificationResponseForm.$valid?r.respondFundNote(n.sender).then(function(){toastr.success("Response sent successfully");t.close(n.sender)},function(){toastr.error("Our gnomes are having trouble delivering this message.  Please refresh and try again")}):n.showValidationMessages=!0;n.isResponding=!1};n.cancel=function(i){n.record.note.viewed===!1?r.updateFundNoteView(n.record.fundId,n.record.note.identification).then(function(){t.dismiss("closeSuccess")},function(){t.dismiss("closeFail")}):t.dismiss(i)}}];fundoloApp.directive("fdControlpanelWidgetsEditDrctv",["$timeout","$window","$filter","Upload","fdDashboardSvc","seAuthSvc","mdCoreDataSvc","appUrl",function(n,t,i,r,u,f,e,o){"use strict";var s={};return s.transclude=!0,s.restrict="E",s.templateUrl="/app/fund/controlpanel/widgets/fd-controlpanel-widgets-edit-drctv.min.html",s.replace=!0,s.link=function(s){function v(n){if(angular.isDefined(n)){var t=$.grep(s.fundCategoryOptions,function(t){return t.identification===n});return t[0].identification}return null}function y(){e.getAllFundCategories().then(function(n){s.fundCategoryOptions=n;s.categoryId=v(s.fund.categoryId)},function(n){$log.error(n)})}function p(t){t!=null&&s.fileReaderSupported&&t.type.indexOf("image")>-1&&n(function(){var i=new FileReader;i.readAsDataURL(t);i.onload=function(i){n(function(){t.dataUrl=i.target.result})}})}function w(n){var t=s.formUpload?{}:{};r.upload({url:o.api+"/api/uploader",method:"POST",fields:t,file:n}).progress(function(t){angular.isUndefined(n.actionVerb)&&(n.actionVerb="Uploading");var i=Math.min(100,parseInt(100*t.loaded/t.total));n.progress=i>80?80:i}).success(function(t){n.progress=85;n.actionVerb="Saving";n.result=t;var i=k(n.result,!0,!1,n);s.saveImage(i,!0)}).error(function(n){n.status>0&&(s.errorMsg=response.status+": "+response.data)})}function b(n,t,i,r,u){for(var s,e=[],o=i||0,f=0;f<n.length;f++)s=r?n[f].upload:n[f],e.push(a(s,t?o:n[f].sortOrder,u)),o++;return e}function k(n,t,i,r){var o=[],c=0,f,u,e;for(angular.forEach(s.uploadList,function(n){n.sortOrder>=c&&(c=n.sortOrder+1)}),f=h(),u=0;u<n.length;u++)e=i?n[u].upload:n[u],e.typeId="web.Image",o.push(a(e,t?f:n[u].sortOrder,r)),f++;return o[0]}function a(n,t,i){var u=n.location,f=n.location,r;return n.typeId=="web.Image"&&(u=n.location+"?height=560&width=550&mode=crop&scale=both",f=n.location+"?height=180&width=180&mode=crop&scale=both"),r={isDefault:!1,sortOrder:t,uploadId:n.identification||0,itemId:s.fund.identification,upload:n,imgUrl:u,thumbUrl:f},angular.isDefined(i)&&(r.file=i),r}function d(n,t,i){var r=n.upload.location,u=n.upload.location;return n.upload.typeId=="web.Image"&&(r=n.upload.location+"?height=560&width=550&mode=crop&scale=both",u=n.upload.location+"?height=180&width=180&mode=crop&scale=both"),n.imgUrl=r,n.thumbUrl=u,angular.isDefined(i)&&(n.file=i),n}function c(n){t.App.mallDub.setDomainColor(s.fund.pageColor,s.fund.pageSkin,s.fund.pageLayout);toastr.success(n)}var l,h;s.$watch("fund",function(n){angular.isDefined(n.item)&&(s.permalink=n.item.permalink,l=n.item.itemUploadList,s.uploadList=n.item.itemUploadList,s.dt=new Date(n.item.endDate),s.fileReaderSupported=window.FileReader!=null&&(window.FileAPI==null||FileAPI.html5!=!1))},!0),function(){if(f.isLoggedIn()){y();n(function(){t.CKEDITOR.replace("funddescription");s.showTextEditor=!0},1e3);return}}();s.$watch("newUploads",function(n){s.formUpload=!1;n!=null&&s.uploads(n)});s.uploads=function(n){for(var t=0;t<n.length;t++)s.errorMsg=null,p(n[t]),w(n[t])};s.saveBasic=function(){s.isSaving=!0;this.editFundBasicForm.$valid?(s.fund.item.description=CKEDITOR.instances.funddescription.getData(),s.fund.item.endDate=i("date")(s.dt,"M/dd/yyyy"),s.save()):(s.showValidationMessages=!0,s.isSaving=!1)};s.savePermalink=function(){s.isSaving=!0;this.editFundPermalinkForm.$valid?(s.fund.item.permalink=this.permalink,s.save()):(s.showValidationMessages=!0,s.isSaving=!1)};s.save=function(n,t){var i={};angular.copy(s.fund,i);i.fundNoteList=[];i.donationList=[];u.save(i).then(function(){angular.isFunction(n)?n(t):(s.isSaving=!1,toastr.success("The fundraiser updated successfully"))},function(){s.isSaving=!1;s.showValidationMessages=!0;toastr.error("There was an error saving this fund.  Please try again")})};s.dateOptions={formatYear:"yy",minDate:new Date,startingDay:1};s.open=function(n){n.preventDefault();n.stopPropagation();s.opened=!0};s.changeColor=function(n){s.fund.pageColor=n;s.save(c,"Nice Color! We went and changed it for you back here.")};s.changeSkin=function(n){s.fund.pageSkin=n;var t="We've changed the style to dark";n==="Light"&&(t="We've changed the style to light");s.save(c,t)};s.changeLayout=function(n){s.fund.pageLayout=n;var t="We've changed the style to wide";n==="Boxed"&&(t="We've changed the layout to boxed");s.save(c,t)};s.saveImage=function(n,t,i){s.isSaving=!0;t&&(n.file.progress=90);angular.isDefined(s.fund.identification)&&s.fund.identification>0?u.saveFundUpload(s.fund.identification,n).then(function(r){t?(n.file.progress=100,n.file.actionVerb=""):i.videoUrl="";var u=d(r,r.sortOrder);n.uploadId=r.uploadId;n.upload.identification=r.uploadId;n.imgUrl=u.imgUrl;n.thumbUrl=u.thumbUrl;u.file&&(n.file=u.file);s.isSaving=!1;toastr.success("Image(s) saved successfully");s.fund.item.itemUploadList.push(n)},function(){toastr.error("We could not upload your file.  Please refresh and try again");s.fund.item.itemUploadList=l;s.isSaving=!1;t&&(n.file.progress=0)}):(s.showValidationMessages=!0,s.isSaving=!1)};s.getThumbnail=function(n){var t=n.thumbUrl;switch(n.upload.typeId){case"web.Video.Vimeo":case"web.Video.YouTube":t=n.upload.name}return t};s.sortableOptions={update:function(){},stop:function(){for(var n=0;n<s.fund.item.itemUploadList.length;n++)s.fund.item.itemUploadList[n].sortOrder=n;u.updateFundUploads(s.fund.identification,s.fund.item.itemUploadList).then(function(){toastr.success("Success!")},function(){toastr.error("There was a problem updating.  Please refresh and try again")})}};s.remove=function(n){var t=n.upload.identification;n.isRemoving=!0;u.deleteFundUploads(s.fund.identification,t).then(function(){s.uploadList=i("orderBy")(b(s.uploadList.filter(function(n){return n.uploadId!==t}),!1,null,!0),"sortOrder");s.fund.item.itemUploadList=s.uploadList;toastr.success("Upload removed successfully")},function(){n.isRemoving=!1;toastr.error("We're having trouble removing this image.  Try refreshing your page and trying again")})};s.addVideoUrl=function(){if(s.isSaving=!0,this.fundEditUploadVideoForm.$valid){var n={isDefault:!1,sortOrder:h(),itemId:s.fund.identification,upload:{contentType:"video/mpeg",locationHttp:this.videoUrl,description:this.videoUrl,location:this.videoUrl,name:this.videoUrl,originalFileName:this.videoUrl,isPrivate:!1,CategoryId:"Multimedia",typeId:"web.Video"},imgUrl:this.videoUrl,thumbUrl:this.videoUrl};s.saveImage(n,!1,this)}else s.showValidationMessages=!0,s.isSaving=!1};s.getThumbnail=function(n){var t=n.thumbUrl;switch(n.upload.typeId){case"web.Video.Vimeo":case"web.Video.YouTube":t=n.upload.name}return t};s.getUploadType=function(n){var t="Image";switch(n.upload.typeId){case"web.Video":case"web.Video.Video":case"web.Video.YouTube":t="Video"}return t};s.getUploadRowIcon=function(n){return{"fa-image":n.upload.typeId==="web.Image","fa-youtube":n.upload.typeId==="web.Video.YouTube","fa-vimeo-square":n.upload.typeId==="web.Video.Vimeo"}};h=function(){var n=0;return angular.forEach(s.uploadList,function(t){t.sortOrder>=n&&(n=t.sortOrder+1)}),n||0};s.$on("destroy",function(){n.cancel(timer)})},s.scope={fund:"=",activeTab:"@"},s}]);fundoloApp.directive("fdWidgetsFeaturedSliderDrctv",["$log","$filter","$timeout","fdSvc",function(n,t,i,r){var u={};return u.templateUrl="/app/fund/widgets/fd-widgets-featured-slider-drctv.min.html",u.transclude=!0,u.replace=!0,u.restrict="E",u.link=function(t){t.isLoading=!0;r.featured(12).then(function(n){t.funds=n;i(function(){},500);t.isLoading=!1},function(t){n.error(t)})},u.controller=["$scope",function(n){n.getProgressPercentage=function(n){return r.getProgressPercentage(n)};n.getProgressPercentageWidth=function(n){return r.getProgressPercentageWidth(n)};n.leftString=function(n,t){return angular.isNumber(t)?n.substring(0,t):n}}],u}]);fundoloApp.directive("fdWidgetsContactDrctv",[function(){"use strict";var n={};return n.templateUrl="/app/fund/widgets/fd-widgets-contact-drctv.min.html",n.transclude=!0,n.replace=!0,n.restrict="E",n.controller=["$scope","$uibModal",function(n,t){n.contact=function(){var i=t.open({templateUrl:"/app/fund/widgets/fd-widgets-contact-mdl.min.html",controller:contactFundModal,resolve:{fund:function(){return n.fund}}});i.result.then(function(){},function(){})}}],n.scope={fund:"="},n}]);contactFundModal=["$scope","$uibModalInstance","fdSvc","fund",function(n,t,i,r){n.fund=r;n.sender={firstName:"",lastName:"",email:"",message:""};n.showValidationMessages=!1;n.isSending=!1;n.sendEmail=function(){this.sendMailContactForm.$valid?(n.isSending=!0,i.createFundNote({fundNote:{fundId:n.fund.identification,fundUserId:n.fund.originator.identification,typeId:"Notification"},email:n.sender.email,firstName:n.sender.firstName,lastName:n.sender.lastName,comments:n.sender.message}).then(function(){toastr.success("Awesome!  You have successfully contacted "+n.fund.originator.firstName);t.close("Success");n.isSending=!1},function(){toastr.error("It seems that we cannot make contact. Please refresh and try again");n.isSending=!1})):(n.showValidationMessages=!0,n.isSending=!1)};n.close=function(n){t.close(n)}}];fundoloApp.directive("fdWidgetsSupportDrctv",["$uibModal","$state","Facebook","appUrl","seAuthSvc","fdSvc",function(n,t,i,r,u,f){var e={};return e.templateUrl="/app/fund/widgets/fd-widgets-support-drctv.min.html",e.transclude=!0,e.replace=!0,e.restrict="E",e.link=function(r){function o(){var t=n.open({templateUrl:"/app/fund/widgets/fd-widgets-support-mdl.min.html",controller:supportFundModal,windowClass:"myclass",size:"sm-med",resolve:{fund:function(){return r.fund}}});t.result.then(function(n){n>0&&(r.level=n,l())},function(n){r.level=n})}function s(){f.copy2(r.fund.item.identification,u.getBearerToken()).then(function(n){t.go("home.permalink",{permalink:n.item.permalink})},function(){toastr.error("Ohh no!  Let's refresh and try again.")})}function h(){i.ui(r.data.facebookData,function(){toastr.success("Thank you for sharing my fundraiser!")})}function c(n){u.isLoggedIn()&&f.supportsByUser(n,u.getBearerToken()).then(function(n){n.length>0&&angular.forEach(n,function(n){switch(n.userTypeId){case"Supporter":r.level=1;break;case"Fundraiser":r.level=r.level<2?2:r.level;break;default:r.level=r.level<3?3:r.level}})},function(){toastr.warning("Unable to find supports for this user.  Please contact the administrator")})}function l(){toastr.info("Thank you so much for your support!")}r.$watch("fund",function(n){angular.isUndefined(n.identification)||e||r.init(n.identification)},!0);r.$watch("level",function(n,t){if(n!==t)switch(n){case 1:r.buttonTitle="Become a Fundraiser";r.title="Make a Difference";r.buttonIcon="fa-code-fork";break;case 2:case 3:r.buttonTitle="Share this";r.title="Make a Difference";r.buttonIcon="fa-share-alt"}});var e=!1;r.buttonTitle="Become a supporter";r.title="Not ready to donate?";r.buttonIcon="fa-users";r.level=0;r.init=function(n){e=!0;c(n)};r.support=function(){switch(r.level){case 0:o();break;case 1:s();case 2:case 3:h()}}},e.scope={fund:"=",data:"="},e}]);supportFundModal=["$scope","$uibModalInstance","appUrl","fdSvc","fund","seAuthSvc",function(n,t,i,r,u,f){var o=i.base+"/authenticate?z=1",e;n.facebookUrl="";n.isLoggedIn=f.isLoggedIn();n.fund=u;n.showValidationMessages=!1;n.isSupporting=!1;n.supported=!1;n.support={message:"",privateMessage:"",postToFacebook:!0,fundId:n.fund.identification};n.user={statusId:"Active",role:f.userRoles.user,userName:"",confirmEmail:"",token:{},isAuthenticated:!1};n.$watch("user",function(t,i){t!==i&&(n.isLoggedIn=f.isLoggedIn())},!0),function(){f.singleExternalLogin("Facebook",o,!0).then(function(t){n.facebookUrl=encodeURIComponent(t[0].url+"&display=popup")},function(){toastr.error("Unable to get Facebook login url.  Please refresh and try again")});f.isLoggedIn()&&r.supportByUser(n.fund.identification,f.getBearerToken()).then(function(t){n.supported=t.isSupporting},function(i){switch(i.status){case 409:n.supported=!0;toastr.warning("You are already a supporter!  Would you like to increase your impact and become a fund raiser?");t.dismiss(1);break;default:n.supported=!1}})}();e=function(i){r.support(n.support,f.getBearerToken()).then(function(){t.close(1)},function(r){var u=0;switch(r.status){case 400:u=3;toastr.error("You are already the originator and cannot become a supporter.");break;case 409:u=1;r.data.userTypeId==="Supporter"?toastr.warning("You are already a supporter!  Would you like to increase your impact and become a fund raiser?"):r.data.userTypeId==="Fundraiser"&&(u=3,toastr.warning("You are already a Fundraiser!  Make a difference by sharing this campaign"));break;default:toastr.error("It seems that support has hit a snag. Please refresh and try again")}n.isSupporting=!1;i&&t.dismiss(u)})};n.supportFund=function(){n.isSupporting=!0;f.isLoggedIn()&&f.user.hasRegisteredExternal?e(!0):f.facebookLogin(n.user,n.facebookUrl).then(function(){e(!0)},function(){toastr.error("This is embarassing.  Please refresh and try again");n.isSupporting=!1})};n.close=function(n){f.isLoggedIn()?e(!0):t.close(n)}}];fundoloApp.directive("fdWidgetsPermalinkDrctv",["$timeout","permalinkData",function(n,t){var i={};return i.restrict="E",i.replace=!0,i.transclude=!0,i.templateUrl="/app/fund/widgets/fd-widgets-permalink-drctv.min.html",i.link=function(i){var r=i;i.$watch("permalink",function(r,u){if(i.showPermalinkAvailable=!1,i.loading===!1){if(angular.isUndefined(r)){i.showSpinner=!1;i.form.permalink.$setValidity("permalinkExists",!0);return}if(r===i.oldPermalink){i.form.permalink.$setValidity("permalinkExists",!0);return}if(i.permalink=i.permalink.toLowerCase().replace(/\s+/g,"-").replace(/[^a-z0-9\-\s]/g,""),i.permalink.substring(i.permalink.length-1)==="-"){i.permalink=i.permalink.substring(0,i.permalink.length-1);return}if(u!==undefined&&u.substring(u.length-1)==="-")return;r!==undefined&&r.substring(0,1)==="-"&&(i.permalink=r.substring(1));i.showSpinner=!0;var f=n(function(){if(r===i.permalink&&i.permalink.length>=3)var n=t.exists(i.permalink).then(function(n){var t=n===!0?!1:!0;i.form.permalink.$setValidity("permalinkExists",t);i.showPermalinkAvailable=t;i.showSpinner=!1},function(n){console.log(n);i.showSpinner=!1});else i.showSpinner=!1},1500)}else i.loading=angular.isUndefined(i.permalink)?!0:!1})},i.controller=["$scope",function(n){n.showSpinner=!1;n.loading=!0;n.showPermalinkAvailable=!1;n.oldPermalink=n.permalink}],i.scope={permalink:"=",form:"="},i}]);fundoloApp.directive("fdWidgetsTeamsDrctv",["$log","$timeout","$filter","$uibModal","fdSvc",function(n,t,i,r,u){var f={};return f.templateUrl="/app/fund/widgets/fd-widgets-teams-drctv.min.html",f.replace=!0,f.transclude=!0,f.restrict="E",f.link=function(t,f,e){e.$observe("fundId",function(n){angular.element.isNumeric(n)&&n>0&&t.init()});t.teamCount=0;t.init=function(){u.fundTeams(t.fundId).then(function(n){t.fundTeams=n;t.teamCount=n.length},function(t){n.error(t)})};t.getProgressPercentage=function(n){if(angular.isUndefined(n))return{width:"0%"};var t=u.getProgressPercentage(n,!0);return{width:i("number")(t,0)+"%"}};t.joinTeam=function(n){var t=r.open({templateUrl:"/app/fund/widgets/fd-widgets-teams-mdl.min.html",controller:joinTeamModal,windowClass:"myclass",size:"sm-med",resolve:{fundTeam:function(){return n}}});t.result.then(function(){toastr.success("You have successfully joined this team!")},function(n){switch(n){case 1:toastr.warning("That's awesome!  You are already a team member!")}})};t.mainFundImage=function(n){return u.getMainImage(n,262,197)}},f}]);joinTeamModal=["$scope","$uibModalInstance","appUrl","fdSvc","fundTeam","seAuthSvc",function(n,t,i,r,u,f){var o=i.base+"/authenticate?z=1",e;n.facebookUrl="";n.isLoggedIn=f.isLoggedIn();n.fundTeam=u;n.showValidationMessages=!1;n.isJoining=!1;n.user={statusId:"Active",role:f.userRoles.user,userName:"",confirmEmail:"",token:{},isAuthenticated:!1};n.$watch("user",function(t,i){t!==i&&(n.isLoggedIn=f.isLoggedIn())},!0);f.singleExternalLogin("Facebook",o,!0).then(function(t){n.facebookUrl=encodeURIComponent(t[0].url+"&display=popup")},function(){toastr.error("Unable to get Facebook login url.  Please refresh and try again")});n.joinTeam=function(){n.isJoining=!0;f.isLoggedIn()&&f.user.hasRegisteredExternal?e(!0):f.facebookLogin(n.user,n.facebookUrl).then(function(){e(!0)},function(){t.dismiss(1)})};n.close=function(n){t.close(n)};n.dismiss=function(n){t.dismiss(n)};e=function(i){r.fundTeamJoin(n.fundTeam.fund.identification,n.fundTeam.identification,f.getBearerToken()).then(function(n){t.close(n)},function(r){var u=0;switch(r.status){case 409:u=1;break;default:u=100}n.isJoining=!1;i&&t.dismiss(u)})}}];fundoloApp.directive("fdWidgetsFeaturedDrctv",["$log","$filter","fdSvc",function(n,t,i){"use strict";var r={};return r.restrict="E",r.templateUrl="/app/fund/widgets/fd-widgets-featured-drctv.min.html",r.transclude=!0,r.replace=!0,r.link=function(t){i.featured(4).then(function(n){t.funds=n},function(t){n.error(t)})},r.controller=function(n){n.leftString=function(n,t){return angular.isNumber(t)?n.substring(0,t):n};n.getTotalDonation=function(n){return angular.isUndefined(n)?0:i.getTotalDonation(n.donationList)};n.getProgressPercentageWidth=function(n){return i.getProgressPercentageWidth(n)};n.getProgressPercentage=function(n){return i.getProgressPercentage(n)}},r}]);fundoloApp.directive("fdWidgetsSliderv2Drctv",["$log","$filter","fdSvc",function(n,t,i){"use strict";var r={};return r.restrict="E",r.templateUrl="/app/fund/widgets/fd-widgets-sliderv2-drctv.min.html",r.transclude=!0,r.replace=!0,r.link=function(n){n.$watch("fundCategory",function(t){angular.isDefined(t)&&n.init()})},r.controller=["$scope","$timeout",function(t,r){function u(n){r(function(){var n=angular.element("#"+t.owlId);n.owlCarousel({items:[4],itemsDesktop:[1e3,3],itemsDesktopSmall:[979,2],itemsTablet:[600,1],slideSpeed:1e3});angular.element("#"+t.owlId+"-next").click(function(){n.trigger("owl.next")});angular.element("#"+t.owlId+"-prev").click(function(){n.trigger("owl.prev")});t.isLoading=!1},n)}function f(){i.featured(8).then(function(n){t.funds=n;u(1e3)},function(t){n.error(t)})}function e(){i.completed(8).then(function(n){t.funds=n;u(1e3)},function(t){n.error(t)})}t.isLoading=!0;t.init=function(){switch(t.fundCategory.toLowerCase()){case"featured":f();break;case"completed":e();break;default:f()}}}],r.scope={fundCategory:"@",title:"@",subTitle:"@",owlId:"@"},r}]);fundoloApp.directive("fdWidgetsTweetsDrctv",[function(){"use strict";var n={};return n.transclude=!0,n.restrict="E",n.replace=!0,n.templateUrl="/app/fund/widgets/fd-widgets-tweets-drctv.min.html",n.controller=["$scope","$log","mdMallDubTwitter",function(n,t,i){function r(t,i){for(var u=t.length,r=0;r<u;r++)n.tweets.length<=i&&(angular.isUndefined(t[r].user.screenName)&&(t[r].user.screenName=t[r].user.screen_name),n.tweets.push(t[r]))}function u(){i.userTimeline("FundingMiracles").then(function(t){n.userTimeline=t;r(n.userTimeline,n.maxLength)},function(n){t.error(n)})}n.tweets=[];n.maxLength=10;n.active=0;n.myInterval=5e3;n.noWrapSlides=!1;i.mentionsTimeline().then(function(t){n.mentions=angular.fromJson(t[0].rawSource);r(n.mentions,n.maxLength);u()},function(n){t.error(n)});n.reply=function(n){i.reply(n)};n.retweet=function(n){i.retweet(n)};n.favorite=function(n){i.favorite(n)}}],n}]);fundoloApp.directive("fdWidgetsProviderDrctv",[function(){"use strict";var n={};return n.transclude=!0,n.restrict="E",n.replace=!0,n.templateUrl="/app/fund/widgets/fd-widgets-provider-drctv.min.html",n.controller=["$scope",function(){}],n}]);fundoloApp.directive("fdWidgetsFundDrctv",["seAuthSvc","fdSvc","appUrl","$state",function(n,t,i,r){var u={};return u.transclude=!0,u.restrict="E",u.replace=!0,u.templateUrl="/app/fund/widgets/fd-widgets-fund-drctv.min.html",u.link=function(i){i.$watch("fund",function(n){angular.isDefined(n)&&i.init(n)},!1);i.beneficiary={};i.fundLocation="";i.subFundLocation="";i.hoverTitle="View Fundraiser";i.subTitle="Donate";i.isLoggedIn=n.isLoggedIn()&&i.secured;i.init=function(n){n.totalDonation=u(n);n.progressPercentage=f(n);i.mainFundImage=t.getMainImage(i.fund.item.itemUploadList,262,197);i.fund=n;i.isLoggedIn?(i.fundLocation=r.href("home.controlpanel.overview",{fundId:i.fund.identification}),i.subFundLocation=r.href("home.permalink",{permalink:i.fund.item.permalink})):(i.fundLocation=r.href("home.permalink",{permalink:i.fund.item.permalink}),i.subFundLocation=r.href("home.fundDonate",{fundId:i.fund.identification}));i.fund.beneficiary==null&&(i.beneficiary=i.fund.originator)};i.leftString=function(n,t){if(angular.isDefined(n)){if(angular.isNumber(t)){var i=n.substring(0,t);return n.length>t&&(i+="..."),i}return n}return""};var u=function(n){return angular.isUndefined(n)?0:t.getTotalDonation(n.donationList)},f=function(n){return t.getProgressPercentageWidth(n)}},u.scope={fund:"=",secured:"="},u}]);fundoloApp.directive("fdWidgetsFundXsDrctv",["seAuthSvc","fdSvc","appUrl","$state",function(n,t,i,r){var u={};return u.transclude=!0,u.restrict="E",u.replace=!0,u.templateUrl="/app/fund/widgets/fd-widgets-fund-xs-drctv.min.html",u.link=function(i,u,f){i.$watch("fund",function(n){angular.isDefined(n)&&i.init(n)},!1);f.$observe("useFundraiserName",function(n){n==="true"&&(i.fundTitle=i.fund.aspNetUser.firstName+" "+i.fund.aspNetUser.lastName)});i.beneficary={};i.fundLocation="";i.subFundLocation="";i.hoverTitle="View Fundraiser";i.subTitle="Donate";i.isLoggedIn=n.isLoggedIn()&&i.secured;i.init=function(n){n.totalDonation=e(n);n.progressPercentage=o(n);i.mainFundImage=t.getMainImage(i.fund.item.itemUploadList,262,197);i.fund=n};i.leftString=function(n,t){return angular.isDefined(n)?angular.isNumber(t)?n.substring(0,t):n:""};i.gotoFund=function(n){r.go("home.permalink",{permalink:n})};var e=function(n){return angular.isUndefined(n)?0:t.getTotalDonation(n.donationList)},o=function(n){return t.getProgressPercentageWidth(n)}},u.scope={fund:"=",secured:"="},u}]);fundoloApp.directive("fdWidgetsFundv2Drctv",["$state","fdSvc","appUrl",function(n,t){var i={};return i.transclude=!0,i.restrict="E",i.replace=!0,i.templateUrl="/app/fund/widgets/fd-widgets-fundv2-drctv.min.html",i.link=function(i){i.$watch("fund",function(n){angular.isDefined(n)&&i.init(n)},!1);i.beneficary={};i.gotoDonate=function(t){n.go("home.permalink",{permalink:t})};i.init=function(n){n.totalDonation=r(n);n.progressPercentage=u(n);i.mainFundImage=t.getMainImage(i.fund.item.itemUploadList,262,197);i.fund=n;i.beneficiary=i.fund.beneficiary==null?i.fund.originator:i.fund.beneficiary};i.leftString=function(n,t){return angular.isDefined(n)?angular.isNumber(t)?n.substring(0,t):n:""};var r=function(n){return angular.isUndefined(n)?0:t.getTotalDonation(n.donationList)},u=function(n){return t.getProgressPercentageWidth(n)}},i.scope={fund:"="},i}]);fundoloApp.directive("fdWidgetsSocialDrctv",[function(){"use strict";var n={};return n.restrict="E",n.replace=!0,n.templateUrl="/app/fund/widgets/fd-widgets-social-drctv.min.html",n.link=function(){},n.compile=function(){},n.controller=["$scope","$uibModal","Facebook","seAuthSvc","twitterConfiguration",function(n,t,i,r,u){function f(){var i=t.open({templateUrl:"/app/fund/widgets/fdWidgetsSocialEmbedMdl.min.html",controller:fdWidgetsSocialEmbedMdl,resolve:{fund:function(){return n.data.fund}}});i.result.then(function(){},function(){})}function e(){i.ui(n.data.facebookData,function(){toastr.success("Thank you for sharing my fundraiser!")})}function o(){var i=t.open({templateUrl:"/app/fund/widgets/fdWidgetsSocialPostMdl.min.html",controller:fdWidgetsSocialPostMdl,resolve:{user:function(){return r.user},fund:function(){return n.data.fund}}});i.result.then(function(){toastr.success("This fundraiser was shared successfully")},function(){})}function s(){var i=t.open({templateUrl:"/app/fund/widgets/fdWidgetsSocialPrintMdl.min.html",controller:fdWidgetsSocialPrintMdl,resolve:{fund:function(){return n.data.fund}}});i.result.then(function(){},function(){})}function h(){var t=encodeURIComponent(n.data.twitterData.url),i=u.tweetUrl+"?hashtags="+encodeURIComponent(n.data.twitterData.hashtags)+"&original_referer="+encodeURIComponent(document.location.href)+"&related="+encodeURIComponent(n.data.twitterData.related)+"&source=tweetbutton&text="+n.data.twitterData.text+"&url="+t+"&via="+n.data.twitterData.via;$.getJSON(u.countUrl+"?callback=?&url="+t,function(t){n.twitterCount=t.count});window.open(i,"Share a link on Twitter","width=650,height=400,toolbar=0,menubar=0,location=1,status=1,scrollbars=1,resizable=1,left=0,top=0")}n.facebookIt=!1;n.tweetId=!1;n.mailIt=!1;n.twitterCount=0;n.socials=[{name:"facebook"},{name:"twitter"},{name:"googleplus"}];n.postData=function(n){switch(n){case"Facebook":e();break;case"Twitter":h();break;case"Mail":o();break;case"Print":s();break;case"Embed":f()}}}],n.scope={data:"="},n}]);fundoloApp.directive("fdWidgetsSliderv3Drctv",["$window","$timeout",function(n){"use strict";var t={};return t.restrict="E",t.templateUrl="/app/fund/widgets/fd-widgets-sliderv3-drctv.min.html",t.replace=!0,t.link=function(t){function r(){var i,r,n;t.slides=[];t.imageList.length>0?(i="",r="",angular.forEach(t.imageList,function(n){i=n.upload.location;r=n.upload.location;n.upload.typeId==="web.Image"&&(i=n.upload.location+"?height=560&width=550&mode=crop&scale=both",r=n.upload.location+"?height=360&width=480&mode=crop&scale=both");t.slides.push({imgUrl:i,thumbUrl:r,title:"",description:"",active:n.isDefault,typeId:n.upload.typeId,name:n.upload.name,location:n.upload.location})})):(n="/img/logo/250b.png",t.slides.push({imgUrl:n,thumbUrl:n,title:"",description:"",active:!0,typeId:"web.Image.System",name:n,location:n}))}function u(){var n="",i=1;angular.forEach(t.slides,function(r){angular.element($("#"+t.sliderContainerId)).html("");n+='<div class="ms-slide" id="slide_'+t.sliderId+"_"+i+'">';switch(r.typeId){case"web.Video.Vimeo":case"web.Video.YouTube":n+='<img src="/assets2/img/blank.gif" data-src="'+r.name+'"/>';n+='<img class="ms-thumb" src="'+r.name+'">';n+='<a data-type="video" data-autoplay="true" href="'+r.location+'"> <\/a>';n+="<\/div>";break;default:n+='<img src="/assets2/img/blank.gif" data-src="'+r.imgUrl+'"/>';n+='<img class="ms-thumb" src="'+r.thumbUrl+'"><\/div>'}i++});angular.element($("#"+t.sliderContainerId)).html(n)}function f(){i=n.App.mallDub.initMasterSliderShowcase2(t.sliderContainerId)}t.$watch("imageList",function(n){angular.isDefined(n)&&angular.isArray(n)&&t.init()},!0);var i={};t.isLoading=!0;t.sliderId=n.App.mallDub.randomator(3);t.sliderContainerId="sliderContainer"+t.sliderId;t.init=function(){r();u();f()}},t.scope={imageList:"="},t}]);fundoloApp.directive("fdWidgetsDonateDrctv",[function(){var n={};return n.restrict="A",n.link=function(n,t){n.$watch("fund",function(i){angular.isDefined(i.identification)&&t.bind("click",function(){n.initDonate()})})},n.controller=["$scope","$uibModal","$location","$analytics","$state",function(n,t,i,r){function u(){var i=t.open({templateUrl:"/app/fund/widgets/fdWidgetsDonateMdl.min.html",controller:fdWidgetsDonateMdl,resolve:{fund:function(){return n.fund},donationAmount:function(){return angular.isUndefined(n.donationAmount)||n.donationAmount===0?35:n.donationAmount}},size:"med",backdrop:!0,keyboard:!0});i.result.then(function(t){n.fund.donationList.push(t);f(t)},function(){})}function f(i){var r=t.open({templateUrl:"/app/fund/widgets/fdWidgetsDonateThankYouMdl.min.html",controller:fdWidgetsDonateThankYouMdl,size:"med",resolve:{fund:function(){return n.fund},order:function(){return i}}});r.result.then(function(){},function(){})}n.initDonate=function(){r.pageTrack("/"+n.fund.item.permalink);r.eventTrack("donateOpen");n.$apply(function(){n.fund.settings.usePaymentModal?u():angular.isDefined(n.donationAmount)&&n.donationAmount>0?i.path("/fund/donate/"+n.fund.identification).search("a",n.donationAmount):i.path("/fund/donate/"+n.fund.identification)})}}],n.scope={fund:"=",donationAmount:"="},n}]);fundoloApp.directive("fdWidgetsUpdatesDrctv",[function(){"use strict";var n={};return n.restrict="E",n.replace=!0,n.templateUrl="/app/fund/widgets/fd-widgets-updates-drctv.min.html",n.link=function(n){n.$watch("updates",function(n){angular.isDefined(n)})},n.compile=function(){},n.controller=["$scope","cssInjector",function(n,t){t.add("/assets/css/pages/profile.css",!0)}],n.scope={updates:"="},n}]);fundoloApp.directive("fdWidgetsCommentsDrctv",["seAuthSvc","cssInjector","fdSvc","mdCoreDataSvc",function(n,t,i,r){"use strict";var u={};return u.restrict="E",u.replace=!0,u.templateUrl="/app/fund/widgets/fd-widgets-comments-drctv.min.html",u.link=function(u,f,e){e.$observe("fundId",function(n){n>0&&u.initComments(n)});e.$observe("allowCommenting",function(n){n.length>0&&(u.allowCommenting=n)});t.add("/assets/css/pages/profile.css",!0);t.add("/assets/css/plugins/brand-buttons/brand-buttons.css",!0);t.add("/assets/css/plugins/brand-buttons/brand-buttons-inversed.css",!0);u.isCommentLoading=!0;u.user=n.user;u.isCommenting=!1;u.showValidationMessages=!1;u.commentMaxSize=7;u.totalComments=0;u.currentPage=1;u.commentsPerPage=10;r.getGeoData2().then(function(n){u.geo=n},function(){});u.$watch("fundcomments",function(n){angular.isDefined(n)&&angular.isArray(n)&&(u.commentsLength=n.length)});u.displayCommentName=function(n){return angular.isDefined(n.donation)&&n.donation.isPrivateDonorName?"Anonymous":n.comment.name};u.displayCommentTitle=function(n){return angular.isDefined(n.donation)&&n.donation.isPrivateAmount?"commented with a donation:":n.comment.title.toLowerCase()};u.sendUser=function(n){return angular.isDefined(n.donation)&&n.donation.isPrivateDonorName?(n.aspNetUser.forceDefault=!0,n.aspNetUser):n.aspNetUser};u.getFundComments=function(n){u.isCommentLoading=!0;(angular.isUndefined(n)||n===0)&&(n=1);i.comment(u.fundId,n,u.commentsPerPage).then(function(n){u.fundcomments=n.data;u.initCommentPagination(n.count);u.isCommentLoading=!1},function(n){toastr.error(n.error_description);u.isCommentLoading=!1})};u.initCommentPagination=function(n){u.totalComments=n};u.onSelectCommentPage=function(){u.getFundComments(u.currentPage)};u.initComments=function(n){u.fundId=n;u.getFundComments(1)};u.initLogin=function(){u.isLoggedIn=n.isLoggedIn()};u.likeThis=function(n){n.comment.totalLikes++;i.commentLike(u.fundId,n).then(function(){toastr.success("You have successfully liked this comment")},function(){n.comment.totalLikes--;toastr.error("Our bad!  Could you refresh the page and try again?")})};u.postComment=function(){if(u.isCommenting=!0,this.donateCommentForm.$valid){var t={fundId:u.fundId,originId:"Fund",comment:{geo:u.geo,post:u.comment,title:"Commented:",postToFacebook:u.postToFacebook}};i.commentSave(u.fundId,t,n.getBearerToken()).then(function(n){u.fundcomments.push(n);toastr.success("Your comments mean alot to us. Thank you!");u.comment="";u.postToFacebook=!1;u.totalComments++;u.isCommenting=!1},function(){toastr.error("Uh oh!  Seems something is up with our system.  Please refresh and try it again");u.isCommenting=!1})}else u.showValidationMessages=!0,u.isCommenting=!1}},u.controller=["$scope",function(n){n.commentsLength=0}],u}]);fundoloApp.directive("fdWidgetsFundraisersDrctv",["$uibModal","fdDashboardSvc",function(n,t){"use strict";var i={};return i.restrict="E",i.transclude=!0,i.replace=!0,i.templateUrl="/app/fund/widgets/fd-widgets-fundraisers-drctv.min.html",i.link=function(i,r,u){u.$observe("fundId",function(n){angular.element.isNumeric(n)&&n>0&&i.init(n)});i.isLoading=!0;i.fundraisers=[];i.init=function(n){i.fundId=n;i.getFundFundraisers(1)};i.getFundFundraisers=function(){i.isLoading=!0;t.getFundraisers(i.fundId,1,3).then(function(n){i.isLoading=!1;i.fundraisers=n.data;angular.forEach(i.fundraisers,function(n){n.fund.aspNetUser=n.aspNetUser})},function(){toastr.error("Problem getting fundraisers","There was a problem accessing your fundraiser.  Please try again");i.isLoading=!1})};i.viewAll=function(){i.tabSelect()};i.becomeFundraiser=function(){var t=n.open({templateUrl:"/app/fund/widgets/fd-widgets-support-mdl.min.html",controller:supportFundModal,windowClass:"myclass",size:"sm-med",resolve:{fund:function(){return i.fund}}});t.result.then(function(n){n>0&&(i.level=n,showThankYou())},function(n){i.level=n})}},i.controller=["$scope",function(){}],i.scope={tabSelect:"&"},i}]);var fdWidgetsSocialPostMdl=["$scope","$uibModalInstance","$uibModal","fdSvc","appUrl","user","fund",function(n,t,i,r,u,f,e){"use strict";n.showValidationMessages=!1;n.fund=e;n.isSending=!1;n.sender={firstName:f.firstName,lastName:f.lastName,email:f.email,recipients:"",emails:[]};n.sendEmail=function(){if(this.sendMailForm.$valid){n.isSending=!0;var e=n.sender.recipients.split(","),i=0,f=[];angular.forEach(e,function(t){App.validateEmail(t.trim())&&(n.sender.emails.push(t.trim()),f.push({email:t.trim(),name:t.trim()}),i++)});i===0?(toastr.warning("Please add at least one email recipient."),n.sender.recipients=n.sender.emails.join(),n.isSending=!1):r.share({firstName:n.sender.firstName,lastName:n.sender.lastName,fundTitle:n.fund.item.title,fundId:n.fund.item.identification,fundDescription:n.fund.item.description,fundDonateUrl:u.base+"/fund/donate/"+n.fund.item.identification,fundUrl:n.fund.url,fundImageUrl:u.base+n.fund.defaultImage,fromEmail:n.sender.email,toEmails:f}).then(function(){t.close(n.sender);n.isSending=!1},function(){toastr.error("Unable to share campaign.  Please refresh and try again");n.isSending=!1})}else n.showValidationMessages=!0};n.preview=function(){var n=i.open({templateUrl:"/app/common/mdPostMailPreviewMdl.min.html",controller:fdWidgetsSocialMailPreviewMdl,size:"sm",resolve:{}});n.result.then(function(){},function(){})};n.cancel=function(n){t.dismiss(n)}}],fdWidgetsSocialMailPreviewMdl=["$scope","$uibModalInstance",function(n,t){n.close=function(n){t.close(n)}}],fdWidgetsSocialPrintMdl=["$scope","$uibModalInstance","$compile","appUrl","mdCoreDataSvc","fund",function(n,t,i,r,u,f){"use strict";n.isLoading=!0;n.fund=f;n.imageUrl=r.fundPrint+"/printfund.aspx?f="+n.fund.item.permalink;var e={};n.imageLoaded=function(){e=i(angular.element(document.getElementById("fundPrintImage")))(n);n.isLoading=!1;n.$apply("isLoading")};n.print=function(){var t='<img src="'+n.imageUrl+'">';u.isIe()>1?u.printPage(t):u.printSection(e,t,n.fund.item.title)};n.close=function(n){t.close(n)}}],fdWidgetsSocialEmbedMdl=["$scope","$uibModalInstance","appUrl","fund",function(n,t,i,r){"use strict";n.fund=r;n.miraclesLogo=i.base+"/assets/img/logo103.png";n.miraclesHome=i.base+"?fm_src=fundcard";n.cardSrc=i.base+"/fund/card/"+n.fund.item.permalink;n.buttonSrc=i.base+"/fund/button/"+n.fund.item.permalink;n.widgetSrc=i.base+"/fund/widget/"+n.fund.item.permalink;n.close=function(n){t.close(n)}}],fdWidgetsDonateMdl=["$scope","$uibModalInstance","$uibModal","$filter","appUrl","mdCoreDataSvc","userSvc","seAuthSvc","orDataSvc","wePayConst","fund","donationAmount",function(n,t,i,r,u,f,e,o,s,h,c,l){"use strict";function v(){var t=a();n.level=t<100?0:t>=100&&t<200?1:2}function p(){n.donation.beneficiary=angular.isDefined(n.fund.beneficiary)?n.fund.beneficiary.fullName:n.fund.originator.fullName;n.donation.beneficiaryAmount=n.selectedFee.beneficiaryAmount;n.donation.systemAmount=n.selectedFee.levels[n.level].amount;n.donation.processingFee=n.selectedFee.chargeFeeAmount;n.donation.donorUserId=angular.isDefined(n.customer)?n.customer.identification:0;n.donation.feeTypeId="Level0";n.donation.fundId=n.fund.identification;n.donation.offlineDonation=!1;n.donation.isPrivate=b;n.donation.statusId="Active";n.donation.thankYouNoteSent=!1;n.donation.costsCovered=n.coverFees;n.donation.donorName=n.order.cardName;n.donation.subscriptionTypeId=n.donation.contributeMonthly?"Monthly":"None"}function a(){return parseInt(angular.isUndefined(n.donation.amount)?0:n.donation.amount,10)}function k(){f.getGeoData2().then(function(t){n.order.geo=t},function(){})}function w(){var t=[],i=a();return v(),angular.forEach(n.payOptions,function(r){y(i,r);r.name=r.levels[n.level].title.replace("{0}",r.levels[n.level].percentage===0?"":"");t.push(r)}),t}function d(){n.amountToCoverOptions();k()}function y(t,i){var r=(t+i.levels[n.level].amount)*i.levels[n.level].chargePercentage*2,u,f;r===0&&(r=.6);i.chargeFeeAmount=(r===0?0:r/2)+i.levels[n.level].chargeAmount;u=t*i.levels[n.level].percentage*2;f=u===0?0:u/2;i.feeAmount=(i.levels[n.level].chargeFee?i.chargeFeeAmount:i.levels[n.level].chargeAmount)+f+i.levels[n.level].amount;i.beneficiaryAmount=t-(i.levels[n.level].chargeFee?i.chargeFeeAmount:0);i.iGotThisAmount=(i.levels[n.level].chargeFee?0:i.chargeFeeAmount)+i.levels[n.level].amount}function g(t){var i;switch(t.error_description){case"App fee can not be greater than 20% of the amount":i="Your donation to Funding Miracles cannot exceed more than 20% of the your total donation.";toastr.error(i);n.title="Thank you! But, ";n.message=i;n.alertType="warning";n.showAlert=!0;break;default:i=t.error_description;toastr.error(i);n.title="Ooops! ";n.message=i;n.alertType="warning";n.showAlert=!0}}n.fund=c;n.order={cardNumber:h.credit_card_number===undefined?"":h.credit_card_number};n.showValidationMessages=!1;n.buttonNo=1;n.isSaving=!1;n.isUpdating=!1;n.hideAmountText=!1;n.coverFees=!0;n.payOptions=f.payOptions;n.yearOptions=f.yearOptions();n.monthOptions=f.monthOptions;n.selectedCardMonth=n.monthOptions[0];n.selectedCardYear=n.yearOptions[0];n.isDonorReadonly=!1;n.hideAmountText=!1;n.donation={isPrivate:!1,amount:l};n.dropdownItems=w();var b=!1;n.onFeeSelect=function(){n.selectedFee=this.selectedFee;n.isCustomAmount=this.selectedFee.levels[n.level].customizableAmount===!0?!0:!1};n.$watch("selectedFee.levels[level].customAmount",function(t){angular.isUndefined(t)?angular.isDefined(n.selectedFee)&&(n.selectedFee.levels[n.level].amount=0):n.selectedFee.levels[n.level].amount=t});n.amountToCoverOptions=function(){var t=n.level,u=w(),e=a(),i=r("number")(e*f.defaultChargeFee*2,0),o=i===0?0:i/2;n.coverFees=this.coverFees;angular.forEach(u,function(i){n.coverFees?(i.levels[t].percentage=f.defaultChargeFee,i.levels[t].chargeFee=!1,n.iGotThis=!0):(i.levels[t].percentage=0,i.levels[t].chargePercentage=f.defaultChargeFee,i.levels[t].chargeFee=!0,n.iGotThis=!1)})};d();n.anonymize=function(){n.donation.isPrivateDonorName?(n.donation.donorName="Anonymous",n.isDonorReadonly=!0):(n.donation.donorName="",n.isDonorReadonly=!1)};n.close=function(n){t.dismiss(n)};n.hideAmount=function(){n.hideAmountText=n.donation.isPrivateAmount};n.modalPaymentBreakdown=function(){var t=i.open({templateUrl:"/app/fund/donate/fdDonateBreakdownMdl.html",controller:donationBreakdownModal,backdrop:"static",resolve:{donation:function(){return p(),n.donation},totalAmount:function(){return n.totalAmount()}}});t.result.then(function(){},function(){})};n.modalPaymentUsage=function(){var n=i.open({templateUrl:"/app/fund/donate/fdDonatePaymentUsageMdl.min.html",controller:paymentUsageModal,resolve:{items:function(){return"ok"}}});n.result.then(function(){},function(){})};n.modalProcessingFee=function(){var n=i.open({templateUrl:"/app/fund/donate/fdDonateProcessingFeeMdl.html",controller:processingFeeModal,resolve:{items:function(){return"ok"}}});n.result.then(function(){},function(){})};n.resetAmount=function(){v();y(a(),n.selectedFee);n.amountToCoverOptions()};n.totalAmount=function(){var t=a();return v(),angular.isUndefined(n.selectedFee)&&(n.selectedFee=n.payOptions[2]),y(t,n.selectedFee),t+n.selectedFee.iGotThisAmount};n.saveDonation=function(){if(n.isSaving=!0,this.fundDonationForm.$valid){var t=n.order.billingAddressAddress.address1+" "+n.order.billingAddressAddress.zipCode;n.order.cardExpirationMonth=this.fundDonationForm.cardExpirationMonth.$modelValue.value;n.order.cardExpirationYear=this.fundDonationForm.cardExpirationYear.$modelValue.value;f.getGeoData3(t).then(function(t){n.order.billingAddressAddress.state=t.stateCode;n.order.billingAddressAddress.city=t.city;n.order.billingAddressAddress.zipCode=t.zip;n.saveInfo()},function(t){toastr.error("D'oh! "+t.error_message);n.isSaving=!1})}else n.showValidationMessages=!0,n.isSaving=!1};n.saveInfo=function(){n.customer={userName:n.donation.email,firstName:n.donation.isPrivateDonorName?"Anonymous":n.order.cardName,email:n.donation.email};e.getByUserName(n.donation.email).then(function(t){var i=angular.isArray(t)?t[0]:t;angular.isUndefined(i)?(toastr.error("There was a problem retrieving user information.  Please try again"),n.isSaving=!1):(n.customer.identification=i.identification,n.savePayment())},function(t){t.status===404?o.registerAnonymous(n.customer).then(function(t){n.customer.identification=t.identification;n.savePayment()},function(t){toastr.error("There was a problem saving user info.  Please try again");$log.error(t);n.isSaving=!1}):(toastr.error("There was a problem saving donation info. Please try again"),$log.error(t),n.isSaving=!1)})};n.savePayment=function(){p();n.order.paymentMethodSystemName="Payments.WePay";n.order.orderItemList=[{itemId:n.fund.identification,price:n.donation.amount}];n.order.statusId="Completed";n.order.PaymentStatusId="Paid";n.order.aspNetUser={email:n.donation.email,identification:n.customer.identification};n.order.customerId=n.customer.identification;n.order.donationList=[n.donation];s.save(n.order).then(function(t){n.isSaving=!1;n.saveThankYou(t)},function(t){g(t.data);n.isSaving=!1})};n.saveThankYou=function(n){t.close(n)}}],fdWidgetsDonateThankYouMdl=["$scope","$uibModalInstance","$filter","appUrl","fdSvc","fund","order",function(n,t,i,r,u,f,e){"use strict";function o(){var t=r.base+n.fund.defaultImage;n.socialData={fund:f,facebookData:{method:"feed",link:f.url,picture:t,name:f.item.title,caption:"www.fundingmiracles.com",description:f.item.description},twitterData:{hashtags:"",via:"fundingmiracles",related:"//www.fundingmiracles.com",text:f.item.title,url:f.url}}}n.fund=f;n.order=e;o();n.close=function(n){t.dismiss(n)};n.thankYou=function(){t.close()};n.getTotalDonation=function(){return angular.isUndefined(n.fund)?0:u.getTotalDonation(n.fund.donationList,!0)};n.getProgressPercentage=function(){if(angular.isUndefined(n.fund))return 0;var t=this.getTotalDonation()/n.fund.goalAmount*100;return{width:i("number")(t,0)+"%"}}}];fundoloApp.directive("fdWidgetsDonationsDrctv",[function(){"use strict";var n={};return n.restrict="E",n.replace=!0,n.templateUrl="/app/fund/widgets/fd-widgets-donations-drctv.min.html",n.link=function(n,t,i){i.$observe("fundId",function(t){angular.element.isNumeric(t)&&t>0&&n.initDonations(t)});n.$watch("donations",function(t){angular.isDefined(t)&&n.initDonations()},!0)},n.controller=["$scope","fdSvc","mdScrollScrollSvc",function(n,t,i){function r(){var i,r,t;for(n.items=[],i=(n.currentPage-1)*n.itemsPerPage,r=i+n.itemsPerPage,t=i;t<r;t++)angular.isDefined(n.itemList[t])&&(n.itemList[t].user.forceDefault=n.itemList[t].offlineDonation,n.items.push(n.itemList[t]))}n.isLoading=!0;n.included=!1;n.maxSize=3;n.totalItems=0;n.currentPage=1;n.itemsPerPage=10;n.getFundDonations=function(i){n.isLoading=!0;(angular.isUndefined(i)||i===0)&&(i=1);n.included?(r(),n.isLoading=!1):t.donations(n.fundId,i,n.itemsPerPage).then(function(t){n.itemList=t.data;n.initDonationPagination(t.count);n.isLoading=!1},function(t){toastr.error(t.error_description);n.isLoading=!1})};n.initDonations=function(){angular.isUndefined(n.donations)?n.getFundDonations(1):(n.included=!0,n.initDonationsPaginate())};n.initDonationsPaginate=function(){n.itemList=n.donations;n.totalItems=n.itemList.length;r();n.isLoading=!1};n.initDonationPagination=function(t){n.totalItems=t};n.onSelectPage=function(){n.getFundDonations(n.currentPage);i.scrollTo(n.scrollId,20)}}],n.scope={donations:"=",scrollId:"@"},n}]);fundoloApp.directive("fdWidgetsSupportersDrctv",["cssInjector","fdDashboardSvc",function(n,t){"use strict";var i={};return i.restrict="E",i.transclude=!0,i.replace=!0,i.templateUrl="/app/fund/widgets/fd-widgets-supporters-drctv.min.html",i.link=function(n,i,r){function u(){var i,r,t;for(n.items=[],i=(n.currentPage-1)*n.itemsPerPage,r=i+n.itemsPerPage,t=i;t<r;t++)angular.isDefined(n.itemList[t])&&n.items.push(n.itemList[t]);n.itemRows=[];n.itemRows.length=Math.ceil(n.items.length/n.numberColumns)}r.$observe("fundId",function(t){angular.element.isNumeric(t)&&t>0&&n.initSupporters(t)});n.items=[];n.itemList=[];n.showWarning=!1;n.isLoading=!0;n.maxSize=7;n.totalItems=0;n.currentPage=1;n.itemsPerPage=20;n.numberColumns=4;n.itemRows=[];n.itemRows.length=Math.ceil(n.items.length/n.numberColumns);n.itemColumns=[];n.itemColumns.length=n.numberColumns;n.hide=function(t){return t===n.items.length||t>n.items.length};n.initSupporters=function(t){n.fundId=t;n.getFundSupporters(1)};n.initPagination=function(t){n.totalItems=t};n.getFundSupporters=function(i){n.isLoading=!0;(angular.isUndefined(i)||i===0)&&(i=1);t.supporters(n.fundId,i,n.itemsPerPage).then(function(t){n.isLoading=!1;n.itemList=t.data;n.initPagination(t.count);n.supportersLength=t.count;u()},function(){toastr.error("Problem getting supporters","There was a problem accessing your fundraiser.  Please try again");n.isLoading=!1})};n.onSelectPage=function(){u()}},i.controller=["$scope",function(n){n.supportersLength=0}],i}]);fundoloApp.controller("fdDonateThankYouCtrl",["$scope","$stateParams","$window","fdSvc",function(n,t,i,r){r.basic(t.fundId).then(function(t){n.fund=angular.isArray(t)?t[0]:t;i.App.mallDub.setDomainColor(n.fund.pageColor,n.fund.pageSkin,n.fund.pageLayout);n.mainFundImage="/azure/"+n.fund.item.itemUploadList.upload.containerName+"/"+n.fund.item.itemUploadList.upload.name+"?height=150&width=230&mode=crop"},function(n){$log.error(n)})}]);fundoloApp.controller("fdDonateCtrl",["$scope","$location","$stateParams","$uibModal","$log","$filter","seAuthSvc","fdSvc","userSvc","orDataSvc","mdCoreDataSvc","wePayConst",function(n,t,i,r,u,f,e,o,s,h,c,l){"use strict";function d(t){var i;switch(t.error_description){case"App fee can not be greater than 20% of the amount":i="Your donation to Funding Miracles cannot exceed more than 20% of the your total donation.";toastr.error(i);n.title="Thank you! But, ";n.message=i;n.alertType="warning";n.showAlert=!0;break;default:i=t.error_description;toastr.error(i);n.title="Ooops! ";n.message=i;n.alertType="warning";n.showAlert=!0}}var p=Number(i.a),v,y,k;n.displayAmount=angular.element.isNumeric(p);o.basic(i.fundId).then(function(t){n.fund=angular.isArray(t)?t[0]:t;App.mallDub.setDomainColor(n.fund.pageColor,n.fund.pageSkin,n.fund.pageLayout);n.mainFundImage=o.getMainImage(n.fund.item.itemUploadList,230,150)},function(n){u.error(n)});c.getAllStates().then(function(t){n.stateOptions=t},function(n){toastr.error("Error getting states.  Please try again");u.error(n)});var a=function(){return angular.isUndefined(n.donation.amount)?0:n.donation.amount},w=function(){var t=a();n.level=t<100?0:t>=100&&t<200?1:2},b=function(t,i){var r=(t+i.levels[n.level].amount)*i.levels[n.level].chargePercentage*2,u,f;r===0&&(r=.6);i.chargeFeeAmount=(r===0?0:r/2)+i.levels[n.level].chargeAmount;u=t*i.levels[n.level].percentage*2;f=u===0?0:u/2;i.feeAmount=(i.levels[n.level].chargeFee?i.chargeFeeAmount:i.levels[n.level].chargeAmount)+f+i.levels[n.level].amount;i.beneficiaryAmount=t-(i.levels[n.level].chargeFee?i.chargeFeeAmount:0);i.iGotThisAmount=(i.levels[n.level].chargeFee?0:i.chargeFeeAmount)+i.levels[n.level].amount};n.items=function(){var t=[],i=a();return w(),angular.forEach(n.payOptions,function(r){b(i,r);var u=f("currency")(r.iGotThisAmount);r.name=r.levels[n.level].title.replace("{0}",r.levels[n.level].percentage===0?"":"");t.push(r)}),t};n.donation={isPrivate:!1};n.order={cardNumber:l.credit_card_number===undefined?"":l.credit_card_number};n.donation.amount=angular.element.isNumeric(p)?p:100;n.buttonNo=1;n.isSaving=!1;n.isUpdating=!1;n.iGotThis=!0;n.coverFees=!0;n.yearOptions=c.yearOptions();n.monthOptions=c.monthOptions;n.selectedCardMonth=n.monthOptions[0];n.selectedCardYear=n.yearOptions[0];n.payOptions=c.payOptions;n.showValidationMessages=!1;n.dropdownItems=n.items();n.isDonorReadonly=!1;n.hideAmountText=!1;v="";y=!1;n.$watch("stateOptions",function(t){angular.isDefined(t)&&angular.isArray(t)&&(n.selectedState=n.stateOptions[0])});n.anonymize=function(){n.donation.isPrivateDonorName?(n.donation.donorName="Anonymous",n.isDonorReadonly=!0):(n.donation.donorName="",n.isDonorReadonly=!1)};n.hideAmount=function(){n.hideAmountText=n.donation.isPrivateAmount};n.setDonationAmount=function(t,i){n.buttonNo=t;n.donation.amount=i;n.resetAmount()};n.amountToCoverOptions=function(){var t=n.level,r=n.items(),u=a(),i=f("number")(u*c.defaultChargeFee*2,0),e=i===0?0:i/2;n.coverFees=this.coverFees;angular.forEach(r,function(i){n.coverFees?(i.levels[t].percentage=c.defaultChargeFee,i.levels[t].chargeFee=!1,n.iGotThis=!0):(i.levels[t].percentage=0,i.levels[t].chargePercentage=c.defaultChargeFee,i.levels[t].chargeFee=!0,n.iGotThis=!1)})};n.amountToCoverOptions();n.onFeeSelect=function(){n.selectedFee=this.selectedFee;n.isCustomAmount=this.selectedFee.levels[n.level].customizableAmount===!0?!0:!1};n.$watch("selectedFee.levels[level].customAmount",function(t){angular.isUndefined(t)?angular.isDefined(n.selectedFee)&&(n.selectedFee.levels[n.level].amount=0):n.selectedFee.levels[n.level].amount=t});n.totalAmount=function(){var t=a();return w(),angular.isUndefined(n.selectedFee)&&(n.selectedFee=n.payOptions[2]),b(t,n.selectedFee),t+n.selectedFee.iGotThisAmount};n.makeAnonymous=function(){n.donation.isPrivate?(v=n.donation.donorName,n.donation.donorName="Anonymous",y=!0):(n.donation.donorName=v,v="",y=!1)};n.saveInfo=function(){this.fundDonationForm.$valid?(n.customer={userName:n.donation.email,firstName:n.donation.donorName,lastName:n.donation.donorName,email:n.donation.email},s.getByUserName(n.donation.email).then(function(t){var i=angular.isArray(t)?t[0]:t;angular.isUndefined(i)?(toastr.error("There was a problem retrieving user information.  Please try again"),n.isSaving=!1):(n.customer.identification=i.identification,n.savePayment())},function(t){t.status===404?e.registerAnonymous(n.customer).then(function(t){n.customer.identification=t.identification;n.savePayment()},function(t){toastr.error("There was a problem saving user info.  Please try again");u.error(t);n.isSaving=!1}):(toastr.error("There was a problem saving donation info. Please try again"),u.error(t),n.isSaving=!1)})):(n.isSaving=!1,n.showValidationMessages=!0)};n.savePayment=function(){n.fundDonationForm.$valid&&(k(),n.order.paymentMethodSystemName="Payments.WePay",n.order.billingAddressAddress.state=n.fundDonationForm.billingState.$modelValue.identification,n.order.cardExpirationMonth=n.fundDonationForm.cardExpirationMonth.$modelValue.value,n.order.cardExpirationYear=n.fundDonationForm.cardExpirationYear.$modelValue.value,n.order.orderItemList=[{itemId:n.fund.identification,price:n.donation.amount}],n.order.statusId="Completed",n.order.PaymentStatusId="Paid",n.order.aspNetUser={email:n.donation.email,identification:n.customer.identification},n.order.customerId=n.customer.identification,n.order.donationList=[n.donation],h.save(n.order).then(function(){n.isSaving=!1;n.saveThankYou()},function(t){d(t.data);n.isSaving=!1}))};k=function(){n.donation.beneficiaryAmount=n.selectedFee.beneficiaryAmount;n.donation.systemAmount=n.selectedFee.levels[n.level].amount;n.donation.processingFee=n.selectedFee.chargeFeeAmount;n.donation.donorUserId=angular.isDefined(n.customer)?n.customer.identification:0;n.donation.feeTypeId="Level0";n.donation.fundId=n.fund.identification;n.donation.offlineDonation=!1;n.donation.isPrivate=y;n.donation.statusId="Active";n.donation.thankYouNoteSent=!1;n.donation.costsCovered=n.coverFees;n.donation.beneficiary="Beneficiary"};n.saveThankYou=function(){toastr.success("You are awesome!  Thank you for your generosity");t.path("/"+n.fund.item.permalink)};n.updateAmount=function(){n.isUpdating=!1};n.editAmount=function(){n.isUpdating=!0};n.modalPaymentUsage=function(){var n=r.open({templateUrl:"/app/fund/donate/fdDonatePaymentUsageMdl.min.html",controller:paymentUsageModal,resolve:{items:function(){return"ok"}}});n.result.then(function(){},function(){})};n.modalProcessingFee=function(){var n=r.open({templateUrl:"/app/fund/donate/fdDonateProcessingFeeMdl.html",controller:processingFeeModal,resolve:{items:function(){return"ok"}}});n.result.then(function(){},function(){})};n.modalPaymentBreakdown=function(){var t=r.open({templateUrl:"/app/fund/donate/fdDonateBreakdownMdl.html",controller:donationBreakdownModal,backdrop:"true",resolve:{donation:function(){return k(),n.donation},totalAmount:function(){return n.totalAmount()}}});t.result.then(function(){},function(){})};n.resetAmount=function(){w();b(a(),n.selectedFee);n.amountToCoverOptions()};n.saveDonation=function(){n.isSaving=!0;this.fundDonationForm.$valid?n.saveInfo():(toastr.error("Oops.  You have some missing or invalid data!"),n.showValidationMessages=!0,n.isSaving=!1)}}]);var paymentUsageModal=["$scope","$uibModalInstance","items",function(n,t,i){n.items=i;n.ok=function(){t.close()};n.cancel=function(){t.dismiss("cancel")}}],processingFeeModal=["$scope","$uibModalInstance","items",function(n,t,i){n.items=i;n.ok=function(){t.close()};n.cancel=function(){t.dismiss("cancel")}}],donationBreakdownModal=["$scope","$uibModalInstance","donation","totalAmount",function(n,t,i,r){n.donation=i;n.totalAmount=r;n.ok=function(){t.close()};n.cancel=function(){t.dismiss("cancel")}}];fundoloApp.controller("fdCtrl",["$uibModal","$scope","$log","$stateParams","$state","$filter","$window","fdSvc","seAuthSvc","appUrl","cssInjector","Facebook","fdDashboardSvc","mdCoreDataSvc","$analytics",function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y){"use strict";function g(){v.getGeoData2().then(function(n){t.geo=n},function(){})}function nt(){t.fund.item.itemUploadList=f("orderBy")(t.fund.item.itemUploadList,"sortOrder");var n=0;angular.forEach(t.fund.item.itemUploadList,function(i){var r=i.upload.location,u=i.upload.location;if(i.upload.typeId=="web.Image"&&(r=i.upload.location+"?height=560&width=550&mode=crop&scale=both",u=i.upload.location+"?height=180&width=180&mode=crop&scale=both"),t.slides.push({imgUrl:r,thumbUrl:u,title:"",description:"",active:i.isDefault}),i.isDefault||n===0)switch(i.upload.typeId){case"web.Video.Vimeo":case"web.Video.YouTube":t.fund.defaultImage=i.upload.name;t.fund.defaultImageThumb=i.upload.name;break;default:t.fund.defaultImage="/azure/"+i.upload.containerName+"/"+i.upload.name+"?height=200&width=310&mode=crop&scale=both";t.fund.defaultImageThumb="/azure/"+i.upload.containerName+"/"+i.upload.name+"?height=75&width=75&mode=crop&scale=both"}i.imgUrl=r;i.thumbUrl=u;n++})}function tt(){if(t.isThisFundMine)switch(t.fund.item.statusId){case"Preliminary":t.showAlert=!0;t.showBlock=!0;t.title="Activate Now";t.message="Your fundraiser has not yet been activated and will not be seen by anyone except you.  ";t.message+='To publicize and begin accepting donations click "Activate Now" below.';t.alertType="info";t.buttonTitle="Activate Now!";t.buttonFunction=t.activate;break;case"Private":case"Hidden":t.showAlert=!0;t.showBlock=!0;t.title="Change status";t.message='Your fundraiser is marked with the status of "'+t.fund.item.statusId+'" ';t.message+='and only be seen by a limited number of people.  To change the status click "Change Status" below.';t.alertType="info";t.buttonTitle="Change Status";t.buttonFunction=function(){t.modalEditSettings(4)};break;case"Expired":t.showAlert=!0;t.showBlock=!0;t.title="Accept Donations";t.message='Your fundraiser is marked with the status of "Completed" ';t.message+='and can no longer accept donations.  To change the status click "Change Status" below';t.alertType="danger";t.buttonTitle="Change Status";t.buttonFunction=function(){t.modalEditSettings(4)}}return}function it(n){o.donations(n,1,0).then(function(n){angular.forEach(n.data,function(n){t.fund.settings.donationHideAmount&&(n.isPrivateAmount=!0);t.fund.settings.donationHideDonorName&&(n.isPrivateDonorName=!0)});t.fund.donationList=n.data},function(){toastr.error("We couldn't get the donations! Please refresh and try again")})}function rt(){s.isLoggedIn()?(t.isLoggedIn=!0,o.isMyFund(t.fund.identification,s.getBearerToken()).then(function(){t.isThisFundMine=!0;t.fund.item.userId=s.user.identification;e.App.mallDub.initNavBarScroll("#edit-bar","#edit-bar-nav",!1);t.situate()},function(){b()})):b()}function b(){switch(t.fund.item.statusId){case"Active":case"Private":e.App.mallDub.initNavBarScroll("#donate-bar","#donate-bar-nav",!0);t.situate();break;case"Expired":t.isDonateable=!1;t.situate();break;default:u.go("home.404")}}function ut(){t.fund&&t.fund.originator.gatewayList.length>0&&(t.gatewayExists=!0)}function ft(n){switch(n.error_code){case"4000":case"4001":t.title="Fund not available";t.message="D'oh! This fundraiser is currently on vacation.  If you'd like some assistance please contact this fundraiser's organizer";t.alertType="danger";t.showAlert=!0}}function k(n){var t=moment(),i=moment(n),r=i.diff(t)>0?" left":" ago",u=i.diff(t)>0?"":"ended ";return u+moment(n).fromNow(!0)+r}function et(n){var i=h.base+t.fund.defaultImage,r=n.item.softDescription;t.socialData={fund:n,facebookData:{method:"feed",link:n.url,picture:i,name:n.item.title,caption:"www.fundingmiracles.com",description:r},twitterData:{hashtags:"",via:"fundingmiracles",related:"//www.fundingmiracles.com",text:n.item.title,url:n.url}};t.$parent.pageTitle=n.item.title;t.$parent.pageDescription=n.item.softDescription;t.$parent.og.title=n.item.title;t.$parent.og.url=n.url;t.$parent.og.description=n.item.softDescription;t.$parent.og.image=i;t.$parent.og.card="summary"}function p(n,r){t.isSaving=!0;a.save(t.fund).then(function(u){t.isSaving=!1;t.fund.identification=u.identification;v.reCache(u.item.permalink).then(function(n){i.info(n)},function(n){i.error(n)});angular.isFunction(n)&&n(r)},function(n){toastr.error("There was an error saving this fund.  Please try again");i.error(n);t.isSaving=!1})}function w(n){e.App.mallDub.setDomainColor(t.fund.pageColor,t.fund.pageSkin,t.fund.pageLayout);toastr.success(n)}var d=function(){e.App.mallDub.initBootstrapListener("xs",function(){angular.element("#donate-bar-nav").css({width:"100%"})},function(){t.fund.pageLayout==="Boxed"&&angular.element("#donate-bar-nav").css({width:"inherit"})})};c.add("/assets2/plugins/master-slider/quick-start/masterslider/style/masterslider.css",!0);c.add("/assets2/plugins/master-slider/quick-start/masterslider/skins/default/style.css",!0);t.geo={};t.tabSupportActive=!1;t.isDonateable=!0;t.isLoggedIn=!1;t.isThisFundMine=!1;t.slides=[];t.isLoading=!0;t.baseUrl=h.base;t.errorThrown=!1;t.myInterval=5e3;t.showAlert=!1;t.gatewayExists=!1;t.fund={item:{title:"Waiting for the fund..."}};t.init=function(){o.byPermalink(r.permalink).then(function(n){t.fund=angular.isArray(n)?n[0]:n;t.setup()},function(n){t.errorThrown=!0;t.fund={item:{title:"Fund currently not available"}};i.error(n);n.data.error_code==="4000"||n.data.error_code==="4001"?ft(n.data):toastr.error("There was a problem getting this fund.  Please refresh page and try again")});g()};t.init();t.setup=function(){rt()};t.changeColor=function(n){t.fund.pageColor=n;p(w,"Nice Color! We went and changed it for you back here.")};t.changeSkin=function(n){t.fund.pageSkin=n;var i="We've changed the style to dark";n==="Light"&&(i="We've changed the style to light");p(w,i)};t.changeLayout=function(n){t.fund.pageLayout=n;var i="We've changed the style to wide";n==="Boxed"&&(i="We've changed the layout to boxed");p(w,i)};t.donate=function(n){t.fund.settings.usePaymentModal||(angular.isDefined(n)?u.go("fundDonate",{fundId:t.fund.identification,a:n}):u.go("fundDonate",{fundId:t.fund.identification}))};t.getTotalDonation=function(){return angular.isUndefined(t.fund)?0:o.getTotalDonation(t.fund.donationList,!0)};t.getProgressPercentage=function(){if(angular.isUndefined(t.fund))return 0;var n=this.getTotalDonation()/t.fund.goalAmount*100;return{width:f("number")(n,0)+"%"}};t.postFacebook=function(){t.isLoggedIn=s.isLoggedIn();l.ui(t.socialData.facebookData,function(){toastr.success("Thank you for sharing my fundraiser!")})};t.situate=function(){t.imageUrl=h.fundPrint+"/printfund.aspx?f="+t.fund.item.permalink;d();t.fund.url=h.base+"/"+t.fund.item.permalink;tt();nt();t.isLoading=!1;t.daysFromNow=k(t.fund.item.endDate);t.fundExpired=o.checkExpiration(t.fund.item.endDate);et(t.fund);e.App.mallDub.setDomainColor(t.fund.pageColor,t.fund.pageSkin,t.fund.pageLayout);ut();it(t.fund.identification);t.fundId=t.fund.identification;y.pageTrack("/"+t.fund.identification);y.eventTrack("pageView",{category:"fundraiser",label:t.fund.item.title});angular.element(document).scrollTop()};t.subscribe=function(){t.isSubscribing=!0;this.fundSubscribeForm.$valid?a.subscribe(t.fund.identification,t.subscribeEmail,t.geo).then(function(){t.isSubscribing=!1;t.subscribeEmail="";toastr.success("Awesome! You have successfully subscribed to this fundraiser!")},function(n){switch(n.status){case 409:toastr.error("Oops! You are already subscribed to this campaign");break;case 400:toastr.error("The originator cannot subscribe to this campaign");break;default:toastr.error("Oh no!  We couldn't get your subscription started.  Please refresh and try again")}t.isSubscribing=!1;t.showValidationMessages=!0}):(t.showValidationMessages=!0,t.isSubscribing=!1,toastr.warning("The email provided is either missing or incorrect.  Please try again"))};t.activate=function(){t.fund.item.statusId="Active";a.save(t.fund).then(function(){t.showAlert=!1;toastr.success("Congratulations.  Your fundraiser is now activated")},function(){toastr.error("There was an error activating this fundraiser.  Please try again")})};t.setTabActive=function(n){switch(n){case"supporter":t.tabSupportActive=!0}};t.modalEditTitle=function(){var i=n.open({templateUrl:"/app/fund/fdCtrlEditTitleMdl.min.html",controller:fdCtrlEditTitleMdl,size:"sm",resolve:{fund:function(){return t.fund}}});i.result.then(function(n){t.fund.item.title=n;toastr.success("The title has been changed successfully")},function(){})};t.modalEditGoal=function(){var i=n.open({templateUrl:"/app/fund/fdCtrlEditGoalMdl.min.html",controller:fdCtrlEditGoalMdl,size:"sm",resolve:{fund:function(){return t.fund}}});i.result.then(function(n){t.fund.goalAmount=n;toastr.success("The goal amount has been changed successfully")},function(){})};t.modalEditPermalink=function(){if(s.isLoggedIn()){var i=n.open({templateUrl:"/app/fund/fdCtrlEditPermalinkMdl.min.html",controller:fdCtrlEditPermalinkMdl,size:"sm-med",resolve:{fund:function(){return t.fund}}});i.result.then(function(n){t.fund.item.permalink=n;t.fund.url=h.base+"/"+t.fund.item.permalink;u.go("home.permalink",{permalink:n});toastr.success("The permalink has been changed successfully")},function(){})}};t.modalEditDescription=function(){if(s.isLoggedIn()){var i=n.open({templateUrl:"/app/fund/fdCtrlEditDescriptionMdl.min.html",controller:fdCtrlEditDescriptionMdl,size:"med",resolve:{fund:function(){return t.fund}}});i.result.then(function(n){t.fund.item.description=n;toastr.success("The description has been changed successfully")},function(){})}};t.modalEditShortSummary=function(){if(s.isLoggedIn()){var i=n.open({templateUrl:"/app/fund/fdCtrlEditShortSummaryMdl.min.html",controller:fdCtrlEditShortSummaryMdl,size:"med",resolve:{fund:function(){return t.fund}}});i.result.then(function(n){t.fund.item.shortSummary=n;toastr.success("The short summary has been changed successfully")},function(){})}};t.modalEditCategory=function(){if(s.isLoggedIn()){var i=n.open({templateUrl:"/app/fund/fdCtrlEditCategoryMdl.min.html",controller:fdCtrlEditCategoryMdl,size:"med",resolve:{fund:function(){return t.fund}}});i.result.then(function(n){t.fund.categoryId=n.identification;t.fund.categoryName=n.friendlyName;toastr.success("The category has been changed successfully")},function(){})}};t.modalEditUpload=function(){if(s.isLoggedIn()){var i=n.open({templateUrl:"/app/fund/fdCtrlEditUploadMdl.min.html",controller:fdCtrlEditUploadMdl,size:"med",resolve:{fund:function(){return t.fund}}});i.result.then(function(n){t.fund.item.itemUploadList=n},function(n){switch(n){}})}};t.modalEditDate=function(){if(s.isLoggedIn()){var i=n.open({templateUrl:"/app/fund/fdCtrlEditDateMdl.min.html",controller:fdCtrlEditDateMdl,size:"sm-med",resolve:{fund:function(){return t.fund}}});i.result.then(function(n){t.daysFromNow=k(n);t.fund.item.endDate=n;toastr.success("The campaigns end date has been changed successfully")},function(){})}};t.modalEditSettings=function(i){if(s.isLoggedIn()){var f=n.open({templateUrl:"/app/fund/fdCtrlEditSettingsMdl.min.html",controller:fdCtrlEditSettingsMdl,size:"med",resolve:{fund:function(){return t.fund},activeTab:function(){return i}}});f.result.then(function(){u.transitionTo(u.current,r,{reload:!0,inherit:!1,notify:!0})},function(){u.transitionTo(u.current,r,{reload:!0,inherit:!1,notify:!0})})}}}]);var fdCtrlEditTitleMdl=["$scope","$uibModalInstance","$filter","appUrl","fdDashboardSvc","seAuthSvc","fund",function(n,t,i,r,u,f,e){"use strict";var o=e.item.title;n.title=e.item.title;n.isSaving=!1;n.showValidationMessages=!1,function(){f.isLoggedIn()||t.dismiss("User not logged in")}();n.close=function(n){t.dismiss(n)};n.save=function(){n.isSaving=!0;this.fundEditTitleForm.$valid?(e.item.title=n.title,u.save(e).then(function(){n.isSaving=!1;t.close(n.title)},function(){e.item.title=o;n.isSaving=!1;n.showValidationMessages=!0;toastr.error("There was an error saving this fund.  Please try again")})):(n.showValidationMessages=!0,n.isSaving=!1)}}],fdCtrlEditGoalMdl=["$scope","$uibModalInstance","$filter","appUrl","fdDashboardSvc","seAuthSvc","fund",function(n,t,i,r,u,f,e){"use strict";function s(){f.isLoggedIn()||t.dismiss("User not logged in")}var o=e.goalAmount;n.goalAmount=e.goalAmount;n.isSaving=!1;n.showValidationMessages=!1;s();n.close=function(n){t.dismiss(n)};n.save=function(){n.isSaving=!0;this.fundEditAmountForm.$valid?(e.goalAmount=n.goalAmount,u.save(e).then(function(){n.isSaving=!1;t.close(n.goalAmount)},function(){e.goalAmount=o;n.isSaving=!1;n.showValidationMessages=!0;toastr.error("There was a problem saving the amount.  Please try again")})):(n.showValidationMessages=!0,n.isSaving=!1)}}],fdCtrlEditPermalinkMdl=["$scope","$uibModalInstance","$filter","appUrl","fdDashboardSvc","seAuthSvc","fund",function(n,t,i,r,u,f,e){"use strict";function s(){f.isLoggedIn()||t.dismiss("User not logged in")}var o=e.item.permalink;n.permalink=e.item.permalink;n.isSaving=!1;n.showValidationMessages=!1;s();n.close=function(n){t.dismiss(n)};n.save=function(){n.isSaving=!0;this.fundEditPermalinkForm.$valid?(e.item.permalink=n.permalink,u.save(e).then(function(){n.isSaving=!1;t.close(e.item.permalink)},function(){e.item.permalink=o;n.isSaving=!1;n.showValidationMessages=!0;toastr.error("There was an error saving this fund.  Please try again")})):(n.showValidationMessages=!0,n.isSaving=!1)}}],fdCtrlEditDescriptionMdl=["$scope","$uibModalInstance","$filter","$timeout","$window","appUrl","fdDashboardSvc","seAuthSvc","fund",function(n,t,i,r,u,f,e,o,s){"use strict";function c(){if(o.isLoggedIn()){r(function(){u.CKEDITOR.replace("funddescription");n.showTextEditor=!0},1e3);return}t.dismiss("User not logged in")}var h=s.item.description;n.description=s.item.description;n.isSaving=!1;n.showValidationMessages=!1;n.showTextEditor=!1;c();n.close=function(n){t.dismiss(n)};n.save=function(){n.isSaving=!0;this.fundEditDescriptionForm.$valid?(n.description=CKEDITOR.instances.funddescription.getData(),s.item.description=n.description,e.save(s).then(function(){n.isSaving=!1;t.close(n.description)},function(){s.item.description=h;n.isSaving=!1;n.showValidationMessages=!0;toastr.error("There was an error saving this fund.  Please try again")})):(n.showValidationMessages=!0,n.isSaving=!1)}}],fdCtrlEditShortSummaryMdl=["$scope","$uibModalInstance","$filter","appUrl","fdDashboardSvc","seAuthSvc","fund",function(n,t,i,r,u,f,e){"use strict";function s(){f.isLoggedIn()||t.dismiss("User not logged in")}var o=e.item.shortSummary;n.shortSummary=e.item.shortSummary;n.isSaving=!1;n.showValidationMessages=!1;s();n.close=function(n){t.dismiss(n)};n.save=function(){if(n.isSaving=!0,this.fundEditShortSummaryForm.$valid)e.item.shortSummary=n.shortSummary,u.save(e).then(function(){n.isSaving=!1;t.close(n.shortSummary)},function(){e.item.shortSummary=o;n.isSaving=!1;n.showValidationMessages=!0;toastr.error("There was an error saving this fund.  Please try again")});else{var i=this.fundEditShortSummaryForm.shortSummary.$viewValue.length;i>140&&toastr.error("You are only allowed to add 140 characters to the short summary.  You are currently at "+i);n.showValidationMessages=!0;n.isSaving=!1}}}],fdCtrlEditCategoryMdl=["$scope","$uibModalInstance","$filter","appUrl","fdDashboardSvc","seAuthSvc","mdCoreDataSvc","fund",function(n,t,i,r,u,f,e,o){"use strict";function h(t){if(angular.isDefined(t)){var i=$.grep(n.fundCategoryOptions,function(n){return n.identification===t});return i[0].identification}return null}function c(t){if(angular.isDefined(t)){var i=$.grep(n.fundCategoryOptions,function(n){return n.identification===t});return i[0]}return null}function l(){e.getAllFundCategories().then(function(t){n.fundCategoryOptions=t;n.categoryId=h(o.categoryId)},function(n){$log.error(n)})}var s=o.categoryId;n.categoryId=o.categoryId;n.isSaving=!1;n.showValidationMessages=!1,function(){if(f.isLoggedIn()){l();return}t.dismiss("User not logged in")}();n.close=function(n){t.dismiss(n)};n.save=function(){n.isSaving=!0;this.fundEditCategoryForm.$valid?(o.categoryId=n.categoryId,u.save(o).then(function(){n.isSaving=!1;t.close(c(n.categoryId))},function(){o.categoryId=s;n.isSaving=!1;n.showValidationMessages=!0;toastr.error("There was an error saving this fund.  Please try again")})):(n.showValidationMessages=!0,n.isSaving=!1)}}],fdCtrlEditUploadMdl=["$scope","$uibModalInstance","$filter","Upload","$timeout","appUrl","fdDashboardSvc","seAuthSvc","fund",function(n,t,i,r,u,f,e,o,s){"use strict";function a(t){t!=null&&n.fileReaderSupported&&t.type.indexOf("image")>-1&&u(function(){var n=new FileReader;n.readAsDataURL(t);n.onload=function(n){u(function(){t.dataUrl=n.target.result})}})}function v(t){var i=n.formUpload?{}:{};r.upload({url:f.api+"/api/uploader",method:"POST",fields:i,file:t}).progress(function(n){angular.isUndefined(t.actionVerb)&&(t.actionVerb="Uploading");var i=Math.min(100,parseInt(100*n.loaded/n.total));t.progress=i>80?80:i}).success(function(i){t.progress=85;t.actionVerb="Saving";t.result=i;var r=p(t.result,!0,!1,t);n.save(r,!0)}).error(function(i){i.status>0&&(n.errorMsg=response.status+": "+response.data);i.exceptionMessage?i.exceptionMessage==="Maximum request length exceeded."?toastr.error("File too large.  Please use a smaller one"):toastr.error(i.exceptionMessage):toastr.error("There was a problem updating.  Please refresh and try again");t.progress=0;t.actionVerb="#FAIL";t.fileUploadFailure=!0})}function y(n,t,i,r,u){for(var s,e=[],o=i||0,f=0;f<n.length;f++)s=r?n[f].upload:n[f],e.push(c(s,t?o:n[f].sortOrder,u)),o++;return e}function p(t,i,r,u){var s=[],l=0,e,f,o;for(angular.forEach(n.uploadList,function(n){n.sortOrder>=l&&(l=n.sortOrder+1)}),e=h(),f=0;f<t.length;f++)o=r?t[f].upload:t[f],o.typeId="web.Image",s.push(c(o,i?e:t[f].sortOrder,u)),e++;return s[0]}function c(n,t,i){var u=n.location,f=n.location,r;return n.typeId=="web.Image"&&(u=n.location+"?height=560&width=550&mode=crop&scale=both",f=n.location+"?height=180&width=180&mode=crop&scale=both"),n.itemUploadList=null,r={isDefault:!1,sortOrder:t,uploadId:n.identification||0,itemId:s.identification,upload:n,imgUrl:u,thumbUrl:f,fileUploadFailure:!1},angular.isDefined(i)&&(r.file=i),r}function w(n,t,i){var r=n.upload.location,u=n.upload.location;return n.upload.typeId=="web.Image"&&(r=n.upload.location+"?height=560&width=550&mode=crop&scale=both",u=n.upload.location+"?height=180&width=180&mode=crop&scale=both"),n.imgUrl=r,n.thumbUrl=u,angular.isDefined(i)&&(n.file=i),n}var l=s.item.itemUploadList,h;n.uploadList=s.item.itemUploadList;n.isSaving=!1;n.showValidationMessages=!1;n.newUploads=[];n.fileReaderSupported=window.FileReader!=null&&(window.FileAPI==null||FileAPI.html5!=!1),function(){o.isLoggedIn()||t.dismiss("User not logged in")}();n.$watch("newUploads",function(t){if(n.formUpload=!1,t!=null)for(var i=0;i<t.length;i++)n.errorMsg=null,a(t[i]),v(t[i])});n.close=function(n){t.dismiss(n)};n.save=function(t,i){n.isSaving=!0;i&&(t.file.progress=90);angular.isDefined(s.identification)&&s.identification>0?e.saveFundUpload(s.identification,t).then(function(r){i&&(t.file.progress=100,t.file.actionVerb="");var u=w(r,r.sortOrder);n.isSaving=!1;toastr.success("Image(s) saved successfully");s.item.itemUploadList.push(u)},function(){toastr.error("We could not upload your file.  Please refresh and try again");s.item.itemUploadList=l;n.isSaving=!1;i&&(t.file.progress=0)}):(n.showValidationMessages=!0,n.isSaving=!1)};n.sortableOptions={update:function(){},stop:function(){for(var n=0;n<s.item.itemUploadList.length;n++)s.item.itemUploadList[n].sortOrder=n;e.updateFundUploads(s.identification,s.item.itemUploadList).then(function(){toastr.success("Success!")},function(){toastr.error("There was a problem updating.  Please refresh and try again")})}};n.remove=function(t){var r=t.upload.identification;t.isRemoving=!0;e.deleteFundUploads(s.identification,r).then(function(){n.uploadList=i("orderBy")(y(n.uploadList.filter(function(n){return n.uploadId!==r}),!1,null,!0),"sortOrder");s.item.itemUploadList=n.uploadList;toastr.success("Upload removed successfully")},function(){t.isRemoving=!1;toastr.error("We're having trouble removing this image.  Try refreshing your page and trying again")})};n.addVideoUrl=function(){n.isSaving=!0;this.fundEditUploadVideoForm.$valid?n.save({isDefault:!1,sortOrder:h(),itemId:s.identification,upload:{contentType:"video/mpeg",locationHttp:n.videoUrl,description:n.videoUrl,location:n.videoUrl,name:n.videoUrl,originalFileName:n.videoUrl,isPrivate:!1,CategoryId:"Multimedia",typeId:"web.Video"},imgUrl:n.videoUrl,thumbUrl:n.videoUrl}):(n.showValidationMessages=!0,n.isSaving=!1)};n.getThumbnail=function(n){var t=n.thumbUrl;switch(n.upload.typeId){case"web.Video.Vimeo":case"web.Video.YouTube":t=n.upload.name}return t};n.getUploadType=function(n){var t="Image";switch(n.upload.typeId){case"web.Video":case"web.Video.Video":case"web.Video.YouTube":t="Video"}return t};n.getUploadRowIcon=function(n){return{"fa-image":n.upload.typeId==="web.Image","fa-youtube":n.upload.typeId==="web.Video.YouTube","fa-vimeo-square":n.upload.typeId==="web.Video.Vimeo"}};h=function(){var t=0;return angular.forEach(n.uploadList,function(n){n.sortOrder>=t&&(t=n.sortOrder+1)}),t||0}}],fdCtrlEditDateMdl=["$scope","$uibModalInstance","$filter","$timeout","appUrl","fdDashboardSvc","seAuthSvc","fund",function(n,t,i,r,u,f,e,o){"use strict";var s=o.item.endDate;n.endDate=o.item.endDate;n.isSaving=!1;n.showValidationMessages=!1,function(){e.isLoggedIn()||t.dismiss("User not logged in")}();n.close=function(n){t.dismiss(n)};n.save=function(){n.isSaving=!0;this.fundEditDateForm.$valid?(o.item.endDate=i("date")(n.endDate,"M/dd/yyyy"),f.save(o).then(function(){n.isSaving=!1;t.close(n.endDate)},function(){o.item.endDate=s;n.isSaving=!1;n.showValidationMessages=!0;toastr.error("There was an error saving this fund.  Please try again")})):(n.showValidationMessages=!0,n.isSaving=!1)},function(){n.dt=new Date;n.minDate=n.minDate?null:new Date}();n.showWeeks=!1;n.toggleWeeks=function(){n.showWeeks=!n.showWeeks};n.clear=function(){n.dt=null};n.disabled=function(n,t){return t==="day"&&(n.getDay()===0||n.getDay()===6)};n.open=function(){r(function(){n.opened=!0})};n.dateOptions={"year-format":"'yy'","starting-day":1}}],fdCtrlEditSettingsMdl=["$scope","$uibModalInstance","fund","activeTab",function(n,t,i,r){"use strict";n.fund=i;n.activeTab=r;n.close=function(n){t.dismiss(n)}}];fundoloApp.controller("fdSearchCtrl",["$scope","$location","$log","$stateParams","$state","$filter","fdSvc","mdCoreDataSvc","mdScrollScrollSvc",function(n,t,i,r,u,f,e,o,s){"use strict";n.searchText=r.searchText;n.items=[];n.totalItems=0;n.isLoading=!1;n.sortCriteria="default";n.sortTitle="Popularity";n.searchSelected="";n.resultType="grid";n.category=angular.isUndefined(r.category)?["All"]:[r.category];n.maxSize=7;n.totalItems=0;n.currentPage=1;n.itemsPerPage=9;n.numberColumns=3;n.itemRows=[];n.itemRows.length=Math.ceil(n.items.length/n.numberColumns);n.itemColumns=[];n.itemColumns.length=n.numberColumns;n.onSelectPage=function(){n.search(n.currentPage);s.scrollTo("topofPage",20)};n.checkDefault=function(){var t=!1;(angular.forEach(n.categories,function(n){angular.isDefined(n.selected)&&n.selected===!0&&(t=!0)}),t)||angular.forEach(n.categories,function(n){if(n.identification==="All"){n.selected=!0;return}})};n.checkInput=function(t){(t.length===0||angular.isUndefined(t))&&n.search(1,"All")};n.getCategories=function(){o.getAllFundCategories().then(function(t){angular.forEach(t,function(n){n.selected=!1});n.categories=t},function(n){i.error(n);toastr.error("Can't find the categories!  Let's try again")})};n.hide=function(t){return t===n.items.length||t>n.items.length};n.init=function(t){n.isLoading=!1;n.items=n.funds;n.totalItems=t;n.itemRows.length=Math.ceil(n.items.length/n.numberColumns)};n.onCategorySelect=function(t){var i=t.split(",");n.search(1,i[0])};n.reset=function(){angular.forEach(n.categories,function(n){n.selected=!1});n.searchText=undefined;n.category=["All"];n.searchSelected="";n.search(1)};n.search=function(t,r){return n.isLoading=!0,angular.isUndefined(r)&&angular.isUndefined(n.searchText)?(n.searchText="All",r=n.searchText):angular.isUndefined(r)?r=n.searchText:n.searchText=r,(angular.isUndefined(t)||t===0)&&(t=1),e.search(n.category,r,t,n.itemsPerPage,n.sortCriteria).then(function(t){n.funds=t.data;n.init(t.count);return n.funds.map(function(n){var t=n.item.title+", For ";return t+(angular.isDefined(n.beneficiary)?n.beneficiary.fullName:n.originator.fullName)})},function(t){toastr.error(t.error_description);i.info(t);n.isLoading=!1})};n.setCategory=function(t){var i=f("findById")(n.categories,t);i.selected=!i.selected;n.checkDefault();n.category.length=0;angular.forEach(n.categories,function(t){angular.isDefined(t.selected)&&t.selected&&n.category.push(t.identification)});n.category.length===0&&n.category.push("All");n.search(1)};n.show=function(t){n.itemsPerPage=t;n.search(1)};n.sort=function(t,i){n.sortCriteria=t;n.sortTitle=i;n.search(1)};n.getCategories();n.search(1)}]).filter("findById",function(){return function(n,t){var i=0,r=n.length;for(i;i<r;i++)if(n[i].identification===t)return n[i];return undefined}});fundoloApp.factory("permalinkData",["$resource","$q","appUrl",function(n,t,i){var u=n(i.api+"/api/permalinks/:permalink",{permalink:"@permlaink"},{}),r={};return r.exists=function(n){var i=t.defer();return angular.isUndefined(n)||n.length<1?i.reject(!1):u.get({permalink:n},function(n){i.resolve(n.exists)},function(){i.reject(!1)}),i.promise},r}]);fundoloApp.factory("seAuthSvc",["$http","$cookieStore","$resource","$q","$log","$interval","$window","appUrl",function(n,t,i,r,u,f,e,o){"use strict";function tt(n){var i=n.split("&"),t={};return i.forEach(function(n){n=n.split("=");t[n[0]]=decodeURIComponent(n[1]||"")}),JSON.parse(JSON.stringify(t))}function it(){var n=sessionStorage.user||localStorage.user;return angular.isUndefined(n)?null:JSON.parse(n)}function b(n){return JSON.stringify(n)}function v(n){angular.extend(y,n)}function c(){var n=s.user.token||a;return angular.isUndefined(n)?"":n.token_type+" "+n.access_token}var s={},g={access_token:"bearer ",expires_in:"",token_type:"",userName:""},a,nt=routingConfig.accessLevels,l=routingConfig.userRoles,y=it()||{userName:"",role:l.public,isAuthenticated:!1},w=function(n){return angular.isUndefined(n.data)?null:angular.isDefined(n.data.modelState)?d(n):n},k=function(){v({userName:"",role:l.public,token:g});localStorage.removeItem("user");sessionStorage.removeItem("user")},d=function(n){var t=n.data,i={error:t.message,error_description:""};return angular.isUndefined(t.modelState[""])||(i.error_description+=" "+t.modelState[""]),angular.isUndefined(t.modelState["model.ConfirmEmail"])||(i.error_description=t.modelState["model.ConfirmEmail"]),angular.isUndefined(t.modelState["model.UserName"])||(i.error_description+=" "+t.modelState["model.UserName"]),angular.isUndefined(t.modelState["model.ConfirmPassword"])||(i.error_description+=" "+t.modelState["model.ConfirmPassword"]),angular.isUndefined(t.modelState["model.Password"])||(i.error_description+=" "+t.modelState["model.Password"]),angular.isUndefined(t.modelState["model.Email"])||(i.error_description+=" "+t.modelState["model.Email"]),angular.isUndefined(t.modelState["model.FirstName"])||(i.error_description+=" "+t.modelState["model.FirstName"]),angular.isUndefined(t.modelState["model.LastName"])||(i.error_description+=" "+t.modelState["model.LastName"]),angular.isUndefined(t.modelState["model.StatusId"])||(i.error_description+=" "+t.modelState["model.StatusId"]),i},h=i(o.api+"/api/auth/:action",{action:"@action"},{register:{method:"POST",params:{action:"register"}},registerAnonymous:{method:"POST",params:{action:"registerAnonymous"}},externalLogin:{method:"POST",params:{action:"externalLogin"}},externalLogins:{method:"GET",params:{action:"externalLogins"},isArray:!0},singleExternalLogin:{method:"GET",params:{action:"singleExternalLogin"},isArray:!0},manageInfo:{method:"GET",params:{action:"manageInfo"},headers:{authorization:c}},addExternalLogin:{method:"POST",params:{action:"addExternalLogin"},headers:{authorization:c}},changePassword:{method:"POST",params:{action:"changePassword"},headers:{authorization:c}},logout:{method:"POST",params:{action:"logout"},headers:{authorization:c}},registerExternal:{method:"POST",params:{action:"registerExternal"},headers:{authorization:c}},removeLogin:{method:"POST",params:{action:"removeLogin"}},setPassword:{method:"POST",params:{action:"setPassword"},headers:{authorization:c}},userInfo:{method:"GET",params:{action:"userInfo"},headers:{authorization:c}},postClaim:{method:"POST",params:{action:"claim"},headers:{authorization:c}},resetPassword:{method:"POST",params:{action:"resetPassword"}}}),rt=i(o.api+"/token",{},{token:{method:"POST",headers:{"content-type":"application/x-www-form-urlencoded; charset=UTF-8"}}}),p;return s.addExternalLogin=function(n){var t=r.defer(),i=a||n;return angular.isUndefined(i)?t.reject({error:"Add external login",error_description:"The access token is missing or invalid"}):h.addExternalLogin({externalAccessToken:i.access_token},function(n){t.resolve(n)},function(n){t.reject({error:"Add external login",error_description:"Unable to add external login.",data:n})}),t.promise},s.handleAccessTokenRedirect=function(n,t){var u=r.defer(),i=tt(t);return angular.isDefined(i.error)?u.reject(i):(a=i,u.resolve(i)),u.promise},s.getBearerToken=c,s.removeLogin=function(n){var t=r.defer();return angular.isUndefined(n.loginProvider)||angular.isUndefined(n.providerKey)?t.reject({error:"Remove login provider",error_description:"Login provider and/or provider key are missing or invalid."}):h.removeLogin(n,function(n){t.resolve(n)},function(n){t.reject({error:"Remove login provider",error_description:"There was an error removing login provider",obj:n})}),t.promise},s.externalLogins=function(n,t){var i=r.defer();return angular.isUndefined(n)&&(n=o.base+"/"),angular.isUndefined(t)&&(t=!0),h.externalLogins({returnUrl:n,generateState:t},function(n){i.resolve(n)},function(n){i.reject({error:"ExternalLogin",error_description:"Unable to retrieve external logins.  Please try again.",obj:n})}),i.promise},s.singleExternalLogin=function(n,t,i){var u=r.defer();return angular.isUndefined(t)&&(t=o.base+"/"),angular.isUndefined(i)&&(i=!0),angular.isUndefined(n)?u.reject({error:"Provider",error_description:"Invalid or missing provider."}):h.singleExternalLogin({provider:n,returnUrl:t,generateState:i},function(n){u.resolve(n)},function(t){u.reject({error:"SingleExternalLogin",error_description:"Unable to retrieve external login ["+n+"]  Please try again.",obj:t})}),u.promise},s.login=function(n,t){var i=r.defer(),f;return angular.isUndefined(n.userName)||angular.isUndefined(n.password)?i.reject({error:"Username/Password",error_description:"Invalid or missing username and/or password."}):(f=$.param({username:n.userName,password:n.password,grant_type:"password"}),rt.save(f,function(r){s.setUser(n,r,t);i.resolve(r)},function(n){i.reject({error:"Login",error_description:"Unable to login into system. Please try again"});u.warn(n)})),i.promise},p=function(n,t){t?localStorage.user=b(n):sessionStorage.user=b(n)},s.setUser=function(n,t,i){n.token=t;n.role=l.user;n.password="";n.persistent=i;v(n);s.getUserInfo().then(function(t){n.firstName=t.firstName;n.lastName=t.lastName;n.email=t.email;n.hasRegistered=t.hasRegistered;n.hasRegisteredExternal=t.hasRegisteredExternal;n.isAuthenticated=t.isAuthenticated;n.facebookProvider=t.facebookProvider;n.identification=t.identification;v(n);p(n,i)},function(){})},s.getUserInfo=function(){var n=r.defer();return h.userInfo({},function(t){n.resolve(t)},function(t){n.reject(t)}),n.promise},s.authorize=function(n,t){return t===undefined&&(t=y.role),n.bitMask&t.bitMask},s.isLoggedIn=function(n){return(n===undefined||n===null)&&(n=y),n.role.title==l.user.title||n.role.title==l.admin.title},s.register=function(n){var t=r.defer();return angular.isUndefined(n)?t.reject({error:"Username object",error_description:"Invalid or missing user."}):h.register(n,function(n){t.resolve(n)},function(n){t.reject(w(n))}),t.promise},s.registerAnonymous=function(n){var t=r.defer();return angular.isUndefined(n)?t.reject({error:"Username object",error_description:"Invalid or missing user."}):h.registerAnonymous(n,function(n){t.resolve(n)},function(n){t.reject(w(n))}),t.promise},s.registerExternal=function(n){var t=r.defer(),u;return angular.isUndefined(n)?t.reject({error:"Username object",error_description:"Invalid or missing user."}):(u=i(o.api+"/api/auth/:action",{action:"@action"},{registerExternal:{method:"POST",params:{action:"registerExternal"},headers:{authorization:c}}}),u.registerExternal(n,function(n){t.resolve(n)},function(n){t.reject(w(n))})),t.promise},s.manageInfo=function(n,t){var i=r.defer();return angular.isUndefined(n)&&(n=o.base+"/"),angular.isUndefined(t)&&(t=!0),h.manageInfo({returnUrl:n,generateState:t},function(n){i.resolve(n)},function(n){i.reject({error:"Manage Info",error_description:"Unable to retrieve manage info.  Please try again.",obj:n})}),i.promise},s.setUserExternal=function(n,t,i){var r=t||a;n.token=r;n.role=l.user;n.password="";n.isExternal=!0;n.externalProvider=i;a=null;v(n);p(n,!0)},s.setUserExternalToken=function(n){a=n},s.extendUser=function(n){var t=n.persistent||!1;v(n);p(n,t)},s.setPassword=function(n){var t=r.defer();return angular.isUndefined(n)||angular.isUndefined(n.confirmPassword)?t.reject({error:"Password object",error_description:"Invalid or missing password."}):h.setPassword(n,function(n){t.resolve(n)},function(n){t.reject(n)}),t.promise},s.postClaim=function(n,t){var i=r.defer();return angular.isUndefined(n)||angular.isUndefined(t)?i.reject({error:"Invalid params",error_description:"Claim type or Val is either missing or invalid"}):h.postClaim({claimType:n,val:t},function(n){i.resolve(n)},function(n){i.reject(n)}),i.promise},s.resetPassword=function(n){var t=r.defer();return angular.isUndefined(n)?t.reject({error:"Reset password username invalid",error_description:"Invalid or missing username."}):h.resetPassword(n,function(n){t.resolve(n)},function(n){t.reject(n)}),t.promise},s.changePassword=function(n){var t=r.defer();return angular.isUndefined(n)?t.reject({error:"Password object",error_description:"Invalid or missing password."}):h.changePassword(n,function(n){t.resolve(n)},function(n){angular.isUndefined(n.data.modelState)===!1&&t.reject(d(n));t.reject({error:"Password object",error_description:"Invalid or missing password."})}),t.promise},s.logout=function(){var n=r.defer();return h.logout({},function(t){k();n.resolve(t)},function(t){n.reject(t);k()}),n.promise},s.facebookLogin=function(n,t){var u=r.defer();e.$davidScope={};var i={},l=screen.width/2-200,a=screen.height/2-250,h=e.open(o.facebook.signInUrl+t,"","top="+a+",left="+l+",width=650,height=400,toolbar=0,menubar=0,location=1,status=1,scrollbars=1,resizable=1,left=0,top=0"),c=1e3,v=f(function(){c+=250;try{h.value&&(angular.extend(n,$davidScope.user),i.user=n,$davidScope.connect?(i.isExternalLogin=!0,u.resolve(i)):$davidScope.register?(i.isExternalRegister=!0,i.user.confirmEmail=n.email,i.user.token=$davidScope.says.access_token,i.user.password="fundingmiracles",i.user.disableWePay=!0,i.user.userName=n.email,i.token={access_token:$davidScope.says.access_token,expires_in:$davidScope.says.expires_in,state:$davidScope.says.state,token_type:$davidScope.says.token_type},s.setUserExternalToken(i.token),s.registerExternal(i.user).then(function(){s.login(i.user).then(function(){u.resolve(i)},function(){toastr.error("Error authenticating the external user.  Please refresh and try again");u.reject(i)})},function(n){u.reject(n)})):(i.token={access_token:$davidScope.says.access_token,expires_in:$davidScope.says.expires_in,state:$davidScope.says.state,token_type:$davidScope.says.token_type},i.user.token=i.token,s.setUser(i.user,i.token,!0),u.resolve(i)),f.cancel(v),h.close())}catch(t){u.reject(t)}},c);return u.promise},s.accessLevels=nt,s.userRoles=l,s.user=y,s}]);fundoloApp.factory("Users",["$http",function(n){return{getAll:function(t,i){n.get("/users").success(t).error(i)}}}]);fundoloApp.directive("accessLevel",["seAuthSvc",function(n){"use strict";var t={};return t.restrict="A",t.link=function(t,i,r){function e(){u&&f&&(n.authorize(f,u)?i.css("display",o):i.css("display","none"))}var o=i.css("display"),u,f;t.user=n.user;t.$watch("user",function(n){n.role&&(u=n.role);e()},!0);r.$observe("accessLevel",function(n){n&&(f=t.$eval(n));e()})},t}]).directive("activeNav",["$location",function(n){var t={};return t.restrict="A",t.link=function(t,i){var r=i.find("a")[0],u=r.href;t.location=n;t.$watch("location.absUrl()",function(n){u===n?i.addClass("active"):i.removeClass("active")})},t}]);fundoloApp.factory("userSvc",["$resource","$q","appUrl","seAuthSvc",function(n,t,i,r){var u={},f=n(i.api+"/api/userdetails/:action",{},{get:{method:"GET",headers:{authorization:r.getBearerToken}},update:{method:"PUT",params:{action:"update"},headers:{authorization:r.getBearerToken}},updateBasics:{method:"PUT",params:{action:"updateBasics"},headers:{authorization:r.getBearerToken}},updateStatus:{method:"PUT",params:{action:"updatestatus"},headers:{authorization:r.getBearerToken}},donations:{method:"GET",params:{action:"donations"},headers:{authorization:r.getBearerToken},isArray:!0},getByUserName:{method:"GET"}}),e;return u.user=r.user,u.get=function(){var n=t.defer();return f.get({},function(t){n.resolve(t)},function(t){n.reject(t)}),n.promise},u.getByUserName=function(n){var i=t.defer();return angular.isUndefined(n)||n<1?i.reject(e):f.getByUserName({userName:n},function(n){i.resolve(n)},function(n){i.reject(n)}),i.promise},u.save=function(n){var i=t.defer();return angular.isUndefined(n)?i.reject():angular.isUndefined(n.identification)||n.identification.length<1?(angular.isUndefined(n.userEmailList)?n.userEmailList=[{email:{identification:n.name}}]:n.userEmailList[0].email.identification=n.name,u.create(n).then(function(n){i.resolve(n)},function(n){i.reject(n)})):u.update(n).then(function(n){i.resolve(n)},function(n){i.reject(n)}),i.promise},u.create=function(n){var i=t.defer();return angular.isUndefined(n)?i.reject():f.save(n,function(n){i.resolve(n)},function(n){i.reject(n)}),i.promise},u.update=function(n){var i=t.defer();return angular.isUndefined(n)||n.identification<1?i.reject():f.update(n,function(n){i.resolve(n)},function(n){i.reject(n)}),i.promise},u.updateBasics=function(n){var i=t.defer();return angular.isUndefined(n)||n.identification<1?i.reject({error:"User",error_description:"Oops this user was either launched into space or abducted by aliens."}):f.updateBasics(n,function(n){i.resolve(n)},function(n){i.reject(n)}),i.promise},u.updateStatus=function(n){var i=t.defer();return angular.isUndefined(n)?i.reject():f.updateStatus({status:n},function(n){i.resolve(n)},function(n){i.reject(n)}),i.promise},u.getDonations=function(){var n=t.defer();return f.donations({},function(t){n.resolve(t)},function(t){n.reject(t)}),n.promise},e={name:"",firstName:"",lastName:"",keepUpdated:!1,statusId:"Pending",itemList:null,userAddressList:[{isDefault:!0,address:{address1:"",address2:"",city:"",state:"",zip:"",longitude:0,latitude:0,county:"",country:""}}],userPhoneList:[{isDefault:!0,phone:{typeId:"Mobile",number:""}}],userEmailList:[{isDefault:!0,email:{identification:""}}],bidList:null},u}]);fundoloApp.factory("orDataSvc",["$resource","$q","appUrl",function(n,t,i){"use strict";var r={},u=n(i.api+"/api/orderdetails/:action/:id",{id:"@id",action:"@action"},{update:{method:"PUT",params:{action:"update"}}});return r.save=function(n){var i=t.defer();return angular.isUndefined(n)?i.reject():angular.isUndefined(n.identification)||n.identification<0?r.create(n).then(function(n){i.resolve(n)},function(n){i.reject(n)}):r.update(n).then(function(n){i.resolve(n)},function(n){i.reject(n)}),i.promise},r.create=function(n){var i=t.defer();return u.save(n,function(n){i.resolve(n)},function(n){i.reject(n)}),i.promise},r.update=function(n){var i=t.defer();return u.update(n,function(n){i.resolve(n)},function(n){i.reject(n)}),i.promise},r}]);fundoloApp.factory("wiFeatureSummarySvc",function(){"use strict";var n={};return n.featureSummaries=[{title:"You Create",summary:"Online fundraising made easy using our Campaign Creator. Within a few minutes, create then publish your fundraiser and share with your friends and family...",iconClass:"fa fa-edit"},{title:"They Donate",summary:"Share on Facebook, Twitter or by Email. The more you share the more responses you will get and the quicker you will get to your fund goal. Need help? Contact us for additional tips...",iconClass:"fa fa-heart"},{title:"We Change Lives",summary:"Miracles was created to help provide fast and easy funding services for any cause. When you create, and others donate, we all contribute to changing the lives of those in need...",iconClass:"fa fa-smile-o"}],n});fundoloApp.directive("wiFeatureSummaryDrctv",["wiFeatureSummarySvc",function(n){"use strict";var t={};return t.restrict="E",t.templateUrl="/app/widgets/wi-feature-summary-drctv.min.html",t.transclude=!0,t.replace=!0,t.scope={},t.link=function(t){t.featureSummaries=n.featureSummaries},t}]);fundoloApp.controller("emFundWidgetCtrl",["$scope","$stateParams","$log","$location","fdSvc","appUrl","$window",function(n,t,i,r,u,f,e){function o(t){u.donations(t,1,0).then(function(t){angular.forEach(t.data,function(t){n.fund.settings.donationHideAmount&&(t.isPrivateAmount=!0);n.fund.settings.donationHideDonorName&&(t.isPrivateDonorName=!0)});n.fund.donationList=t.data;n.fund.totalDonation=s(n.fund);n.fund.progressPercentage=h(n.fund)},function(){toastr.error("We couldn't get the donations! Please refresh and try again")})}n.isLoading=!0;u.byPermalink(t.permalink).then(function(t){n.fund=angular.isArray(t)?t[0]:t;o(n.fund.identification);n.mainFundImage=u.getMainImage(n.fund.item.itemUploadList,240,200);n.fundLink=f.base+"/"+n.fund.item.permalink;n.fundExpired=u.checkExpiration(n.fund.item.endDate);n.isLoading=!1;e.App.mallDub.setDomainColor(n.fund.pageColor,n.fund.pageSkin,n.fund.pageLayout)},function(){});n.donate=function(){e.top.location.href=n.fundLink};var s=function(n){return angular.isUndefined(n)?0:u.getTotalDonation(n.donationList)},h=function(n){return u.getProgressPercentageWidth(n)}}]);fundoloApp.controller("emFundCardCtrl",["$scope","$stateParams","$log","$filter","$window","fdSvc","appUrl",function(n,t,i,r,u,f,e){"use strict";function o(t){f.donations(t,1,0).then(function(t){angular.forEach(t.data,function(t){n.fund.settings.donationHideAmount&&(t.isPrivateAmount=!0);n.fund.settings.donationHideDonorName&&(t.isPrivateDonorName=!0)});n.fund.donationList=t.data;n.fund.totalDonation=s(n.fund);n.fund.progressPercentage=h(n.fund)},function(){toastr.error("We couldn't get the donations! Please refresh and try again")})}n.isLoading=!0;f.byPermalink(t.permalink).then(function(t){n.fund=angular.isArray(t)?t[0]:t;o(n.fund.identification);n.fundUrl=e.base+"/"+n.fund.item.permalink;n.mainFundImage=f.getMainImage(n.fund.item.itemUploadList,240,200);n.fundLink=e.base+"/"+n.fund.item.permalink+"?fm_src=fundCard";n.fundExpired=f.checkExpiration(n.fund.item.endDate);n.isLoading=!1;u.App.mallDub.setDomainColor(n.fund.pageColor,n.fund.pageSkin,n.fund.pageLayout)},function(){});n.donate=function(){u.top.location.href=n.fundLink};var s=function(n){return angular.isUndefined(n)?0:f.getTotalDonation(n.donationList)},h=function(n){return f.getProgressPercentageWidth(n)}}]);fundoloApp.controller("emFundButtonCtrl",["$scope","$stateParams","$window","fdSvc","appUrl",function(n,t,i,r,u){"use strict";n.isLoading=!0;r.byPermalink(t.permalink).then(function(t){n.fund=angular.isArray(t)?t[0]:t;n.fundLink=u.base+"/"+n.fund.item.permalink;n.isLoading=!1;i.App.mallDub.setDomainColor(n.fund.pageColor,n.fund.pageSkin,n.fund.pageLayout)},function(){});n.donate=function(){i.top.location.href=n.fundLink}}]);fundoloApp.directive("mdAlertDrctv",[function(){var n={};return n.restrict="E",n.transclude=!0,n.replace=!0,n.templateUrl="/app/common/md-alert-drctv.min.html",n.scope={title:"@",message:"@",alertType:"@",fade:"@",showAlert:"@",showBlock:"@",buttonTitle:"@",buttonFunction:"&"},n}]);fundoloApp.controller("dtPickerCtrl",["$scope","$timeout",function(n,t){n.today=function(){n.dt=new Date};n.today();n.showWeeks=!1;n.toggleWeeks=function(){n.showWeeks=!n.showWeeks};n.clear=function(){n.dt=null};n.disabled=function(n,t){return t==="day"&&(n.getDay()===0||n.getDay()===6)};n.toggleMin=function(){n.minDate=n.minDate?null:new Date};n.toggleMin();n.open=function(){t(function(){n.opened=!0})};n.dateOptions={"year-format":"'yy'","starting-day":1}}]);fundoloApp.directive("selectOnClick",[function(){var n={};return n.restrict="A",n.link=function(n,t){t.bind("click",function(){this.select()})},n}]).directive("imageonload",[function(){var n={};return n.restrict="A",n.link=function(n,t){t.on("load",n.callBack())},n.scope={callBack:"&callBack"},n}]).directive("mdPrint",[function(){"use strict";function i(t){var i=t.cloneNode(!0);n.innerHTML="";n.appendChild(i);window.print()}var t={},n;return t.restrict="A",n=document.getElementById("printSection"),n||(n=document.createElement("div"),n.id="printSection",document.body.appendChild(n)),t.link=function(t,r,u){r.on("click",function(){var n=document.getElementById(u.printElementId);n&&i(n)});window.onafterprint=function(){n.innerHTML=""}},t}]);fundoloApp.directive("vaPasswordCheckDrctv",[function(){return{require:"ngModel",link:function(n,t,i,r){var u="#"+i.vaPasswordCheckDrctv;t.add(u).on("keyup",function(){n.$apply(function(){var n=t.val()===$(u).val();r.$setValidity("pwmatch",n)})})}}}]);fundoloApp.factory("mdCoreDataSvc",["$resource","$q","$window","seAuthSvc","appUrl",function(n,t,i,r,u){var f={},e,o;return f.defaultChargeFee=.029,f.defaultChargeAmount=.3,e=n(u.api+"/api/miracle/:action/:id",{id:"@id",action:"@action"},{states:{method:"GET",params:{action:"states"},isArray:!0},fundTypes:{method:"GET",params:{action:"fundtypes"},isArray:!0},sendQuestion:{method:"POST",params:{action:"sendquestion"},isArray:!0},fundCategories:{method:"GET",params:{action:"fundCategories"},isArray:!0}}),o=n(u.api+"/api/marasco/:action",{action:"@action"},{recache:{method:"POST",params:{action:"recache"}},qrcode:{method:"POST",params:{action:"qrcode"}},ipapi:{method:"GET",params:{action:"ipapi"}}}),f.monthOptions=[{name:"Jan",value:"1"},{name:"Feb",value:"2"},{name:"Mar",value:"3"},{name:"Apr",value:"4"},{name:"May",value:"5"},{name:"Jun",value:"6"},{name:"Jul",value:"7"},{name:"Aug",value:"8"},{name:"Sep",value:"9"},{name:"Oct",value:"10"},{name:"Nov",value:"11"},{name:"Dec",value:"12"}],f.yearOptions=function(){for(var t=[],i=new Date,r=i.getFullYear(),u=i.getFullYear()+15,n=r;n<u;n++)t.push({name:n,value:n});return t},f.payOptions=[{isDefault:!1,levels:[{title:"0$ Miracles is cool but I just want to give to the fund",percentage:0,chargeFee:!0,chargePercentage:f.defaultChargeFee,chargeAmount:f.defaultChargeAmount,amount:0},{title:"0$ Miracles is cool but I just want to give to the fund",percentage:0,chargeFee:!0,chargePercentage:f.defaultChargeFee,chargeAmount:f.defaultChargeAmount,amount:0},{title:"0$ Miracles is cool but I just want to give to the fund",percentage:0,chargeFee:!0,chargePercentage:f.defaultChargeFee,chargeAmount:f.defaultChargeAmount,amount:0}]},{isDefault:!1,levels:[{title:"+$2 ({0}I just want to contribute something to Miracles)",percentage:0,chargeFee:!0,chargePercentage:f.defaultChargeFee,chargeAmount:f.defaultChargeAmount,amount:2},{title:"+$5 ({0}I just want to contribute something to Miracles)",percentage:0,chargeFee:!0,chargePercentage:f.defaultChargeFee,chargeAmount:f.defaultChargeAmount,amount:5},{title:"+$10 ({0}I just want to contribute something to Miracles)",percentage:0,chargeFee:!0,chargePercentage:f.defaultChargeFee,chargeAmount:f.defaultChargeAmount,amount:10}]},{isDefault:!0,levels:[{title:"+$3 ({0}Because I wanna help everybody!  Most people choose this)",percentage:0,chargeFee:!0,chargePercentage:f.defaultChargeFee,chargeAmount:f.defaultChargeAmount,amount:3},{title:"+$10 ({0}Miracles is doing something special. Most people choose this)",percentage:0,chargeFee:!0,chargePercentage:f.defaultChargeFee,chargeAmount:f.defaultChargeAmount,amount:10},{title:"+$15 ({0}Miracles is doing something special. Most people choose this)",percentage:0,chargeFee:!0,chargePercentage:f.defaultChargeFee,chargeAmount:f.defaultChargeAmount,amount:15}]},{isDefault:!1,levels:[{title:"+$10 ({0}Because Miracles is pretty awesome)",percentage:0,chargeFee:!0,chargePercentage:f.defaultChargeFee,chargeAmount:f.defaultChargeAmount,amount:10},{title:"+$15 ({0}Because Miracles is pretty awesome)",percentage:0,chargeFee:!0,chargePercentage:f.defaultChargeFee,chargeAmount:f.defaultChargeAmount,amount:15},{title:"+$20 ({0}Because Miracles is pretty awesome)",percentage:0,chargeFee:!0,chargePercentage:f.defaultChargeFee,chargeAmount:f.defaultChargeAmount,amount:20}]},{isDefault:!1,levels:[{title:"+$15  ({0}Because I Love, Love, Love Miracles)",percentage:0,chargeFee:!0,chargePercentage:f.defaultChargeFee,chargeAmount:f.defaultChargeAmount,amount:15},{title:"+$20 ({0}I Love, Love, Love Miracles and how they're making a difference)",percentage:0,chargeFee:!0,chargePercentage:f.defaultChargeFee,chargeAmount:f.defaultChargeAmount,amount:20},{title:"+$25 ({0}I Love, Love, Love Miracles and how they're making a difference)",percentage:0,chargeFee:!0,chargePercentage:f.defaultChargeFee,chargeAmount:f.defaultChargeAmount,amount:25}]},{isDefault:!1,levels:[{title:"I have another amount in mind",percentage:0,chargeFee:!0,chargePercentage:f.defaultChargeFee,chargeAmount:f.defaultChargeAmount,amount:0,customizableAmount:!0},{title:"I have another amount in mind",percentage:0,chargeFee:!0,chargePercentage:f.defaultChargeFee,chargeAmount:f.defaultChargeAmount,amount:0,customizableAmount:!0},{title:"I have another amount in mind",percentage:0,chargeFee:!0,chargePercentage:f.defaultChargeFee,chargeAmount:f.defaultChargeAmount,amount:0,customizableAmount:!0}]}],f.getAllStates=function(){var n=t.defer();return e.states({},function(t){n.resolve(t)},function(t){n.reject(t)}),n.promise},f.getAllFundTypes=function(){var n=t.defer();return e.fundTypes({},function(t){n.resolve(t)},function(t){n.reject(t)}),n.promise},f.getAllFundCategories=function(){var n=t.defer();return e.fundCategories({},function(t){n.resolve(t)},function(t){n.reject(t)}),n.promise},f.reCache=function(n){var i=t.defer();return o.recache({url:u.base+"/"+n},function(n){i.resolve(n)},function(n){i.reject(n)}),i.promise},f.qrcode=function(n){var i=t.defer();return o.qrcode({value:u.base+"/"+n,altTag:""},function(n){i.resolve(n)},function(n){i.reject(n)}),i.promise},f.isIe=function(){var i=-1,n,t;return navigator.appName=="Microsoft Internet Explorer"?(n=navigator.userAgent,t=new RegExp("MSIE ([0-9]{1,}[.0-9]{0,})"),t.exec(n)!=null&&(i=parseFloat(RegExp.$1))):navigator.appName=="Netscape"&&(n=navigator.userAgent,t=new RegExp("Trident/.*rv:([0-9]{1,}[.0-9]{0,})"),t.exec(n)!=null&&(i=parseFloat(RegExp.$1))),i},f.printPage=function(n){var t=window.open("","_blank","width=800,height=1010");t.document.open();t.document.write('<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN"><html><head><style>@page{margin-left: 0px;margin-right: 10px;margin-top: 0px;margin-bottom: 0px;}<\/style><\/head><body>'+n+"<\/html>");t.print()},f.printSection=function(n,t,i){return n.printArea({mode:"popup",removeMargins:!0,popTitle:i,retainAttr:["id","ng-src","src"]}),!1},f.sendQuestion=function(n){var i=t.defer();return e.sendQuestion(n,function(n){i.resolve(n)},function(){i.reject({error:"SendQuestion",error_description:"Chipmunks have raided our email servers and we are attempting to quarantine.  Please try again!"})}),i.promise},f.getGeoData=function(){var n=t.defer();return $.getJSON("http://smart-ip.net/geoip-json?callback=?",function(t){t.originalDevice=navigator.userAgent;n.resolve(t)}).fail(function(){n.reject({error:"Error getting Geo from smart-ip",error_description:"Unable to get data from smart-ip"})}),n.promise},f.getGeoData2=function(){var n=t.defer();return o.ipapi({},function(t){t.host=t.query;t.originalDevice=navigator.userAgent;t.latitude=t.lat;t.longitude=t.lon;t.ipAddress=t.host;t.alias=t.as;t.organization=t.org;n.resolve(t)},function(t){n.reject(t)}),n.promise},f.getGeoData4=function(){var n=t.defer();return $.getJSON("http://ip-api.com/json",function(t){t.host=t.query;t.originalDevice=navigator.userAgent;t.latitude=t.lat;t.longitude=t.lon;t.ipAddress=t.host;t.alias=t.as;t.organization=t.org;n.resolve(t)}).fail(function(){n.reject({error:"Error getting Geo from ip-api",error_description:"Unable to get data from ip-api"})}),n.promise},f.getGeoData3=function(n){var i=t.defer(),r=encodeURIComponent(n);return $.getJSON("https://maps.googleapis.com/maps/api/geocode/json?address="+r,function(n){if(n.status!=="OK"){i.reject({error:"Error retrieving records",error_description:"No records were returned from call"});return}switch(n.results.length){case 0:i.reject({error:"No records returned",error_description:"No records were returned from call",error_message:"The address provided was incomplete or invalid.  Please check and try again."});break;case 1:if(n.results[0].types.length!==1||n.results[0].types.indexOf("street_address")===-1){i.reject({error:"Invalid data returned",error_description:"No records were returned from call",error_stack:n,error_message:"The address provided returned mixed results.  Please check and try again."});return}var t={latitude:n.results[0].geometry.location.lat,longitude:n.results[0].geometry.location.lng,formattedAddress:n.results[0].formatted_address};angular.forEach(n.results[0].address_components,function(n){n.types.indexOf("neighborhood")===0&&(t.neighborhood=n.long_name);n.types.indexOf("locality")===0&&(t.city=n.long_name);n.types.indexOf("administrative_area_level_2")===0&&(t.county=n.long_name);n.types.indexOf("administrative_area_level_1")===0&&(t.state=n.long_name,t.stateCode=n.short_name);n.types.indexOf("country")===0&&(t.country=n.long_name,t.countryCode=n.short_name);n.types.indexOf("postal_code")===0&&(t.zip=n.long_name);n.types.indexOf("postal_code_suffix")===0&&(t.zipSuffix=n.long_name)});i.resolve(t);break;default:i.reject({error:"More than 1 record was returned",error_description:"The query matched more than one item",error_message:"The address provided some mixed results.  Please check and try again."})}}).fail(function(){i.reject({error:"Error getting Geo from google Api",error_description:"Unable to get data from google",error_message:"Please refresh the page and try again"})}),i.promise},f}]);fundoloApp.directive("mdPressThumbnailDrctv",["mdPressDataSvc",function(n){var t={};return t.restrict="E",t.templateUrl="/app/common/md-press-thumbnail-drctv.min.html",t.transclude=!0,t.replace=!0,t.link=function(t,i,r){t.$watch(r.pressthumbnail,function(){setTimeout(function(){$(i[0].firstElementChild).flexslider({animation:"slide",easing:"swing",animationLoop:!0,itemWidth:1,itemMargin:1,minItems:2,maxItems:9,controlNav:!1,directionNav:!1,move:2})},1)});t.presses=n.presses},t}]);fundoloApp.directive("mdCarousel",[function(){var n={};return n.restrict="E",n.templateUrl="/app/common/md-carousel-drctv.min.html",n.transclude=!0,n.replace=!0,n.controller=["$scope","$filter","fdSvc",function(n,t,i){n.hideHeadline=function(){return angular.isUndefined(this.slideHeadline)||this.slideHeadline.length<1};n.hideCaption2=function(){return angular.isUndefined(this.hideCaption)?!1:this.hideCaption};n.getTotalDonation=function(){return angular.isUndefined(n.fund)?0:i.getTotalDonation(n.fund.donationList,!0)};n.getProgressPercentage=function(){if(angular.isUndefined(n.fund))return 0;var i=this.getTotalDonation()/n.fund.goalAmount*100;return{width:t("number")(i,0)+"%"}}}],n.scope={slideHeadline:"@",slides:"=",myInterval:"=",fund:"=",spanClass:"@",hideCaption:"@",showProgress:"@"},n}]);fundoloApp.directive("vaWholeNumberDrctv",[function(){var n={};return n.link=function(n,t){t.on("blur",function(){var i=Math.abs(parseInt(t.val(),10));t.val(i);n.$apply()})},n}]);fundoloApp.directive("mdSocialMessageDrctv",[function(){var n={};return n.restrict="E",n.templateUrl="/app/common/md-social-message-drctv.min.html",n.transclude=!0,n.link=function(n){n.$watch("textMessage",function(){if(angular.isUndefined(n.textMessage)){n.count=0;return}var t=n.textMessage.length;n.count=t>=140?140:t})},n.scope={textMessage:"="},n}]);fundoloApp.directive("btSwatchDrctv",[function(){var n={};return n.restrict="E",n.transclude=!0,n.replace=!0,n.templateUrl="/app/common/bt-swatch-drctv.min.html",n.link=function(n){n.$watch("color",function(){angular.isUndefined(n.color)||n.color==="default"?n.form.inputColor.$setValidity("requiredColor",!1):n.form.inputColor.$setValidity("requiredColor",!0)})},n.controller=["$scope",function(n){n.changeColor=function(n){n!==this.color&&(this.color=n)};n.getClass=function(n){return n===this.color?"fa fa-check icon-white icon-only":""}}],n.scope={color:"=",form:"="},n}]);fundoloApp.directive("atPlugin",[function(){var n={};return n.restrict="E",n.transclude=!0,n.replace=!0,n.templateUrl="/app/common/at-plugin.html",n.link=function(n,t){setTimeout(function(){addthis.init();addthis.toolbox($(t).get())},1e3)},n.scope={url:"@",title:"@",description:"@",currentPagePath:"@",enable32:"="},n}]);fundoloApp.directive("mdSpinnerBarDrctv",[function(){var n={};return n.restrict="E",n.transclude=!0,n.replace=!0,n.templateUrl="/app/common/md-spinner-bar-drctv.min.html",n.link=function(n){n.$watch("spinnerType",function(t){t===undefined&&(n.spinnerType="squareLarge")});n.$watch("spinnerSize",function(t){t===undefined&&(n.spinnerSize="med")})},n.scope={spinnerType:"@",spinnerSize:"@"},n}]);fundoloApp.factory("mdPressDataSvc",[function(){var n={};return n.sortOrder="id",n.presses=[{id:"1",imgUrl:"/assets/img/clients/hp_grey.png",imgColorUrl:"/assets/img/clients/hp.png"},{id:"2",imgUrl:"/assets/img/clients/igneus_grey.png",imgColorUrl:"/assets/img/clients/igneus.png"},{id:"3",imgUrl:"/assets/img/clients/vadafone_grey.png",imgColorUrl:"/assets/img/clients/vadafone.png"},{id:"4",imgUrl:"/assets/img/clients/walmart_grey.png",imgColorUrl:"/assets/img/clients/walmart.png"},{id:"5",imgUrl:"/assets/img/clients/shell_grey.png",imgColorUrl:"/assets/img/clients/shell.png"},{id:"6",imgUrl:"/assets/img/clients/natural_grey.png",imgColorUrl:"/assets/img/clients/natural.png"},{id:"7",imgUrl:"/assets/img/clients/aztec_grey.png",imgColorUrl:"/assets/img/clients/aztec.png"},{id:"8",imgUrl:"/assets/img/clients/gamescast_grey.png",imgColorUrl:"/assets/img/clients/gamescast.png"},{id:"9",imgUrl:"/assets/img/clients/cisco_grey.png",imgColorUrl:"/assets/img/clients/cisco.png"},{id:"10",imgUrl:"/assets/img/clients/everyday_grey.png",imgColorUrl:"/assets/img/clients/everyday.png"},{id:"11",imgUrl:"/assets/img/clients/cocacola_grey.png",imgColorUrl:"/assets/img/clients/cocacola.png"},{id:"12",imgUrl:"/assets/img/clients/spinworkx_grey.png",imgColorUrl:"/assets/img/clients/spinworkx.png"},{id:"13",imgUrl:"/assets/img/clients/shell_grey.png",imgColorUrl:"/assets/img/clients/shell.png"},{id:"14",imgUrl:"/assets/img/clients/natural_grey.png",imgColorUrl:"/assets/img/clients/natural.png"},{id:"15",imgUrl:"/assets/img/clients/gamescast_grey.png",imgColorUrl:"/assets/img/clients/gamescast.png"},{id:"16",imgUrl:"/assets/img/clients/everyday_grey.png",imgColorUrl:"/assets/img/clients/everyday.png"},{id:"17",imgUrl:"/assets/img/clients/spinworkx_grey.png",imgColorUrl:"/assets/img/clients/spinworkx.png"}],n}]);fundoloApp.filter("doubleDigit",function(){return function(n,t){if(t=t||0,angular.isDefined(n)){for(var i=""+n;i.length<t;)i="0"+i;return i}return n}}).filter("startFrom",function(){return function(n,t){return t=+t,n.slice(t)}}).filter("colorTen",function(){return function(n,t){var i;return(t=t||"",angular.isDefined(n)&&angular.isNumber(n))?(i=n.toString().substr(n.toString().length-1),t+["zero","one","two","three","four","five","six","seven","eight","nine"][parseInt(i)]):"one"}}).filter("blockColor",function(){return function(n,t){if(t=t||"",angular.isDefined(n)&&angular.isNumber(n)){var r=0,u=n.toString().substr(n.toString().length-1),i=parseInt(u);return r=i>4?i-5:i,t+["pending","success","info","error","default"][r]}return""}}).filter("momentFrom",function(){return function(n){return angular.isDefined(n)?moment(utcToLocalTimeUnFormatted(n)).fromNow():n}}).filter("momentTo",function(){return function(n,t){if(angular.isDefined(n)){var i=moment(utcToLocalTimeUnFormatted(n));return angular.isDefined(t)?i.format(t):i.format("LL")}return n}});fundoloApp.directive("mdAvatarDrctv",["$window",function(n){"use strict";var t={};return t.replace=!0,t.transclude=!0,t.restrict="E",t.template="<img/>",t.link=function(t,i,r){t.$watch("user",function(t){var f=n.App.mallDub.randomIntFromInterval(0,30),u="/img/avatar/"+f+".jpg",i;if(angular.isDefined(t)){if(t.forceDefault===!0){r.$set("src",u);return}i="/img/logo/180.png";angular.isDefined(t.identification)&&(i=angular.isDefined(t.facebookProvider&&angular.isDefined(t.facebookProvider.providerKey))?"https://graph.facebook.com/"+t.facebookProvider.providerKey+"/picture":t.avatarUploadTempLocation);r.$set("src",i)}else r.$set("src",u)},!0);r.$observe("classes",function(n,t){n!==t&&r.$set("class",n)})},t.scope={user:"="},t}]);fundoloApp.service("mdScrollScrollSvc",function(){this.scrollTo=function(n,t){function c(){return self.pageYOffset?self.pageYOffset:document.documentElement&&document.documentElement.scrollTop?document.documentElement.scrollTop:document.body.scrollTop?document.body.scrollTop:0}function l(n){for(var i=document.getElementById(n),r=i.offsetTop,t=i;t.offsetParent&&t.offsetParent!=document.body;)t=t.offsetParent,r+=t.offsetTop;return r}var r=c(),i=l(n),o=i>r?i-r:r-i,s,h;if(o<100){scrollTo(0,i);return}t===undefined&&(t=Math.round(o/100),t>=20&&(t=20));var f=Math.round(o/25),u=i>r?r+f:r-f,e=0;if(i>r){for(s=r;s<i;s+=f)setTimeout("window.scrollTo(0, "+u+")",e*t),u+=f,u>i&&(u=i),e++;return}for(h=r;h>i;h-=f)setTimeout("window.scrollTo(0, "+u+")",e*t),u-=f,u<i&&(u=i),e++}});
//# sourceMappingURL=Fundolo.min.js.map